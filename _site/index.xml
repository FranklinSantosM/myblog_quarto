<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Franklin Santos</title>
<link>https://franklinsantosm.com/</link>
<atom:link href="https://franklinsantosm.com/index.xml" rel="self" type="application/rss+xml"/>
<description>Data Scientis</description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Sun, 29 Sep 2024 04:00:00 GMT</lastBuildDate>
<item>
  <title>Análisis predictivo usando tidymodels</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>En este post, exploraremos cómo utilizar <code>tidymodels</code> para construir y evaluar modelos predictivos que estimen el peso de calabazas gigantes. Además, agregaremos visualizaciones clave para analizar la correlación entre variables predictoras, el desempeño del modelo en validación cruzada, y la precisión de las predicciones.</p>
<section id="carga-y-preparación-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="carga-y-preparación-de-datos">Carga y Preparación de Datos</h3>
<p>Primero, cargamos los datos y seleccionamos las variables de interés, asegurándonos de que estén limpias y en un formato adecuado para el modelado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cargar librerías</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidymodels)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cargar y preparar datos</span></span>
<span id="cb2-2">pumpkins_raw <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-19/pumpkins.csv"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 28065 Columns: 14
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (14): id, place, weight_lbs, grower_name, city, state_prov, country, gpc...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">pumpkins <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb4-2">  pumpkins_raw <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(year, weight_lbs, ott, place), parse_number)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(type <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"P"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(weight_lbs, year, place, ott, gpc_site, country)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `across(c(year, weight_lbs, ott, place), parse_number)`.
Caused by warning:
! 2327 parsing failures.
row col expected actual
 13  -- a number    EXH
 36  -- a number    EXH
 58  -- a number    EXH
 60  -- a number    EXH
 61  -- a number    EXH
... ... ........ ......
See problems(...) for more details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">pumpkins</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15,965 × 6
   weight_lbs  year place   ott gpc_site                                 country
        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                                    &lt;chr&gt;  
 1      2032   2013     1   475 Uesugi Farms Weigh-off                   United…
 2      1985   2013     2   453 Safeway World Championship Pumpkin Weig… United…
 3      1894   2013     3   445 Safeway World Championship Pumpkin Weig… United…
 4      1874.  2013     4   436 Elk Grove Giant Pumpkin Festival         United…
 5      1813   2013     5   430 The Great Howard Dill Giant Pumpkin Cla… Canada 
 6      1791   2013     6   431 Elk Grove Giant Pumpkin Festival         United…
 7      1784   2013     7   445 Uesugi Farms Weigh-off                   United…
 8      1784.  2013     8   434 Stillwater Harvestfest                   United…
 9      1780.  2013     9   422 Stillwater Harvestfest                   United…
10      1766.  2013    10   425 Durham Fair Weigh-Off                    United…
# ℹ 15,955 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dividir datos en conjunto de entrenamiento y prueba</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb8-3">data_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initial_split</span>(pumpkins, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prop =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>)</span>
<span id="cb8-4">pumpkin_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(data_split)</span>
<span id="cb8-5">pumpkin_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">testing</span>(data_split)</span></code></pre></div>
</div>
</section>
<section id="análisis-exploratorio" class="level3">
<h3 class="anchored" data-anchor-id="análisis-exploratorio">Análisis Exploratorio</h3>
<p>La relación principal aquí es entre el volumen/tamaño de la calabaza y el peso.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">pumpkins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ott <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, ott <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(ott, weight_lbs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> place)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"over-the-top inches"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight (lbs)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_c</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Las calabazas grandes y pesadas se colocaban más cerca de ganar en los concursos, ¡naturalmente!</p>
</blockquote>
<p>¿Se ha producido algún cambio en esta relación con el paso del tiempo?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">pumpkins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ott <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, ott <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(ott, weight_lbs)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray60"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(year)),</span>
<span id="cb10-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> lm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">formula =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> splines<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bs</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb10-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span></span>
<span id="cb10-8">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"over-the-top inches"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight (lbs)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis_d</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Creo que es difícil de decir.</p>
</blockquote>
<p>¿Qué países producían calabazas más o menos grandes?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">pumpkins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb12-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_lump</span>(country, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb12-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(country, weight_lbs)</span>
<span id="cb12-5">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(country, weight_lbs, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> country)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outlier.colour =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.15</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"weight (lbs)"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="construir-y-ajustar-un-conjunto-de-flujo-de-trabajo" class="level3">
<h3 class="anchored" data-anchor-id="construir-y-ajustar-un-conjunto-de-flujo-de-trabajo">Construir y ajustar un conjunto de flujo de trabajo</h3>
<p>Empecemos nuestro modelado estableciendo nuestro «presupuesto de datos». Estratificaremos por nuestro resultado <code>weight_lbs</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb13-2">pumpkin_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> pumpkins <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(ott <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, ott <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initial_split</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strata =</span> weight_lbs)</span>
<span id="cb13-5"></span>
<span id="cb13-6">pumpkin_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(pumpkin_split)</span>
<span id="cb13-7">pumpkin_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">testing</span>(pumpkin_split)</span>
<span id="cb13-8"></span>
<span id="cb13-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">234</span>)</span>
<span id="cb13-10">pumpkin_folds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vfold_cv</span>(pumpkin_train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strata =</span> weight_lbs)</span>
<span id="cb13-11">pumpkin_folds</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#  10-fold cross-validation using stratification 
# A tibble: 10 × 2
   splits             id    
   &lt;list&gt;             &lt;chr&gt; 
 1 &lt;split [8954/996]&gt; Fold01
 2 &lt;split [8954/996]&gt; Fold02
 3 &lt;split [8954/996]&gt; Fold03
 4 &lt;split [8954/996]&gt; Fold04
 5 &lt;split [8954/996]&gt; Fold05
 6 &lt;split [8954/996]&gt; Fold06
 7 &lt;split [8955/995]&gt; Fold07
 8 &lt;split [8956/994]&gt; Fold08
 9 &lt;split [8957/993]&gt; Fold09
10 &lt;split [8958/992]&gt; Fold10</code></pre>
</div>
</div>
<p>A continuación, vamos a crear tres recetas de preprocesamiento de datos: una que sólo agrupa los niveles de los factores utilizados con poca frecuencia, otra que también crea variables indicadoras y, por último, otra que también crea términos spline para las pulgadas de más.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">base_rec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe</span>(weight_lbs <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ott <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> country <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> gpc_site,</span>
<span id="cb15-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> pumpkin_train</span>
<span id="cb15-4">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_other</span>(country, gpc_site, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">threshold =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.02</span>)</span>
<span id="cb15-6"></span>
<span id="cb15-7">ind_rec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb15-8">  base_rec <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_dummy</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_nominal_predictors</span>())</span>
<span id="cb15-10"></span>
<span id="cb15-11">spline_rec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb15-12">  ind_rec <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_bs</span>(ott)</span></code></pre></div>
</div>
<p>A continuación, vamos a crear tres especificaciones de modelo: un modelo de random forest, un modelo MARS y un modelo lineal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">rf_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rand_forest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">trees =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_mode</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"regression"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_engine</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ranger"</span>)</span>
<span id="cb16-5"></span>
<span id="cb16-6">mars_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb16-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mars</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_mode</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"regression"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb16-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_engine</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"earth"</span>)</span>
<span id="cb16-10"></span>
<span id="cb16-11">lm_spec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">linear_reg</span>()</span></code></pre></div>
</div>
<p>Ahora es el momento de juntar el preprocesamiento y los modelos en un <code>workflow_set()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">pumpkin_set <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow_set</span>(</span>
<span id="cb17-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(base_rec, ind_rec, spline_rec),</span>
<span id="cb17-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(rf_spec, mars_spec, lm_spec),</span>
<span id="cb17-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cross =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span></span>
<span id="cb17-6">  )</span>
<span id="cb17-7"></span>
<span id="cb17-8">pumpkin_set</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A workflow set/tibble: 3 × 4
  wflow_id             info             option    result    
  &lt;chr&gt;                &lt;list&gt;           &lt;list&gt;    &lt;list&gt;    
1 recipe_1_rand_forest &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
2 recipe_2_mars        &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;
3 recipe_3_linear_reg  &lt;tibble [1 × 4]&gt; &lt;opts[0]&gt; &lt;list [0]&gt;</code></pre>
</div>
</div>
<p>Utilizamos <code>cross = FALSE</code> porque no queremos todas las combinaciones de estos componentes, sólo tres opciones para probar. Vamos a ajustar estos posibles candidatos a nuestras remuestreos para ver cuál de ellos funciona mejor.</p>
</section>
<section id="entrenamiento-y-selección-del-mejor-modelo" class="level3">
<h3 class="anchored" data-anchor-id="entrenamiento-y-selección-del-mejor-modelo">Entrenamiento y Selección del Mejor Modelo</h3>
<p>Usamos <code>workflow_map</code> para evaluar los modelos en cada pliegue de validación cruzada y extraemos el mejor modelo según la raíz del error cuadrático medio (RMSE).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#doParallel::registerDoParallel()</span></span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span>)</span>
<span id="cb19-3"></span>
<span id="cb19-4">pumpkin_rs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb19-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow_map</span>(</span>
<span id="cb19-6">    pumpkin_set,</span>
<span id="cb19-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fit_resamples"</span>,</span>
<span id="cb19-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resamples =</span> pumpkin_folds</span>
<span id="cb19-9">  )</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>→ A | warning: some 'x' values beyond boundary knots may cause ill-conditioned bases</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>There were issues with some computations   A: x2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">pumpkin_rs</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A workflow set/tibble: 3 × 4
  wflow_id             info             option    result   
  &lt;chr&gt;                &lt;list&gt;           &lt;list&gt;    &lt;list&gt;   
1 recipe_1_rand_forest &lt;tibble [1 × 4]&gt; &lt;opts[1]&gt; &lt;rsmp[+]&gt;
2 recipe_2_mars        &lt;tibble [1 × 4]&gt; &lt;opts[1]&gt; &lt;rsmp[+]&gt;
3 recipe_3_linear_reg  &lt;tibble [1 × 4]&gt; &lt;opts[1]&gt; &lt;rsmp[+]&gt;</code></pre>
</div>
</div>
</section>
<section id="evaluar-el-conjunto-de-flujos-de-trabajo" class="level3">
<h3 class="anchored" data-anchor-id="evaluar-el-conjunto-de-flujos-de-trabajo">Evaluar el conjunto de flujos de trabajo</h3>
<p>How did our three candidates do?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">autoplot</span>(pumpkin_rs)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No hay mucha diferencia entre las tres opciones, y si acaso, nuestro modelo lineal con ingeniería de rasgos spline quizás lo hizo mejor. ¡Esto es bueno porque es un modelo más simple!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(pumpkin_rs)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 9
  wflow_id         .config preproc model .metric .estimator   mean     n std_err
  &lt;chr&gt;            &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
1 recipe_1_rand_f… Prepro… recipe  rand… rmse    standard   86.1      10 1.10e+0
2 recipe_1_rand_f… Prepro… recipe  rand… rsq     standard    0.969    10 9.97e-4
3 recipe_2_mars    Prepro… recipe  mars  rmse    standard   83.8      10 1.92e+0
4 recipe_2_mars    Prepro… recipe  mars  rsq     standard    0.969    10 1.67e-3
5 recipe_3_linear… Prepro… recipe  line… rmse    standard   82.4      10 2.27e+0
6 recipe_3_linear… Prepro… recipe  line… rsq     standard    0.970    10 1.97e-3</code></pre>
</div>
</div>
<p>Podemos extraer el flujo de trabajo que queremos utilizar y ajustarlo a nuestros datos de entrenamiento.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">final_fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb29-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract_workflow</span>(pumpkin_rs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"recipe_3_linear_reg"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb29-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fit</span>(pumpkin_train)</span></code></pre></div>
</div>
<p>Podemos utilizar un objeto como este para predecir, por ejemplo en los datos de prueba como <code>predict(final_fit, pumpkin_test)</code>, o podemos examinar los parámetros del modelo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tidy</span>(final_fit) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb30-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(estimate))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 5
   term                                   estimate std.error statistic   p.value
   &lt;chr&gt;                                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 (Intercept)                            -9731.     675.      -14.4   1.30e- 46
 2 ott_bs_3                                2585.      25.6     101.    0        
 3 ott_bs_2                                 450.      11.9      37.9   2.75e-293
 4 ott_bs_1                                -345.      36.3      -9.50  2.49e- 21
 5 gpc_site_Ohio.Valley.Giant.Pumpkin.Gr…    21.1      7.80      2.70  6.89e-  3
 6 country_United.States                     11.9      5.66      2.11  3.53e-  2
 7 gpc_site_Stillwater.Harvestfest           11.6      7.87      1.48  1.40e-  1
 8 country_Germany                          -11.5      6.68     -1.71  8.64e-  2
 9 country_other                            -10.7      6.33     -1.69  9.13e-  2
10 country_Canada                             9.29     6.12      1.52  1.29e-  1
11 country_Italy                              8.12     7.02      1.16  2.47e-  1
12 gpc_site_Elk.Grove.Giant.Pumpkin.Fest…    -7.81     7.70     -1.01  3.10e-  1
13 year                                       4.89     0.334    14.6   5.03e- 48
14 gpc_site_Wiegemeisterschaft.Berlin.Br…     1.51     8.07      0.187 8.51e-  1
15 gpc_site_other                             1.41     5.60      0.251 8.02e-  1</code></pre>
</div>
</div>
<p>Los términos spline son, con mucho, los más importantes, pero se observan indicios de que determinados lugares y países predicen el peso (ya sea hacia arriba o hacia abajo), así como una pequeña tendencia de calabazas más pesadas con el año.</p>
</section>
<section id="conclusión" class="level3">
<h3 class="anchored" data-anchor-id="conclusión">Conclusión</h3>
<p>El análisis predictivo de peso de calabazas gigantes usando <code>tidymodels</code> permite una comparación robusta de múltiples modelos y una visualización clara del desempeño. Este flujo de trabajo facilita tanto la elección del modelo adecuado como la interpretación de los factores que afectan la variable de respuesta. ¡Explorar estos modelos en sus propios datos puede ser un ejercicio valioso para mejorar la comprensión de las herramientas de <code>tidymodels</code>!</p>
<p>Fuente: Julia Silge</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2024,
  author = {Santos, Franklin},
  title = {Análisis Predictivo Usando Tidymodels},
  date = {2024-09-29},
  url = {https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2024" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2024. <span>“Análisis Predictivo Usando
Tidymodels.”</span> September 29, 2024. <a href="https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/">https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/</a>.
</div></div></section></div> ]]></description>
  <category>AI</category>
  <category>Machine Learning</category>
  <category>Model</category>
  <guid>https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/</guid>
  <pubDate>Sun, 29 Sep 2024 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/ml_punpkin_weith_prediction/fs.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Back-transformations with emmeans() in R</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/back-transformation/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>En el análisis de datos, especialmente en disciplinas como la estadística y el machine learning, es común aplicar transformaciones a los datos para mejorar la calidad de los análisis. Estas transformaciones ayudan a cumplir con supuestos estadísticos como la normalidad o la homogeneidad de varianzas, y a menudo permiten obtener modelos más robustos y precisos. Sin embargo, una vez que hemos realizado el análisis, surge la necesidad de interpretar los resultados en la escala original de los datos. Aquí es donde entran en juego las <strong>transformaciones inversas</strong>.</p>
<p>Las transformaciones inversas son las operaciones matemáticas que revertimos para devolver los datos transformados a su forma original. Esto es crucial cuando queremos comunicar los hallazgos de manera que tengan sentido práctico y comprensible. Por ejemplo, si aplicamos una transformación logarítmica para estabilizar la varianza de un conjunto de datos, la transformación inversa —en este caso, la exponenciación— nos permite expresar los resultados en la misma escala en la que los datos fueron originalmente recolectados.</p>
<p>Algunas de las transformaciones más comunes incluyen la logarítmica, la raíz cuadrada y la Box-Cox, cada una con su correspondiente transformación inversa. Estas técnicas son especialmente útiles en áreas como la biología, la economía y la ingeniería, donde los datos a menudo no cumplen con las distribuciones ideales para un análisis directo.</p>
</section>
<section id="tipos-de-transformación" class="level2">
<h2 class="anchored" data-anchor-id="tipos-de-transformación">Tipos de transformación</h2>
<p>A continuación, te presento algunas de las transformaciones más comunes y sus inversas:</p>
<section id="transformación-logarítmica-log" class="level3">
<h3 class="anchored" data-anchor-id="transformación-logarítmica-log">1. <strong>Transformación Logarítmica (log)</strong></h3>
<ul>
<li><strong>Transformación</strong>: Se utiliza para reducir la asimetría positiva o estabilizar la varianza cuando los datos tienen valores grandes.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y'%20=%20%5Clog(y)">, generalmente en base natural (<img src="https://latex.codecogs.com/png.latex?%5Clog_e">) o base 10.</li>
</ul></li>
<li><strong>Inversa</strong>: La operación inversa es la exponenciación.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y%20=%20e%5E%7By'%7D"> o <img src="https://latex.codecogs.com/png.latex?y%20=%2010%5E%7By'%7D">, dependiendo de la base logarítmica utilizada.</li>
</ul></li>
</ul>
</section>
<section id="transformación-de-raíz-cuadrada" class="level3">
<h3 class="anchored" data-anchor-id="transformación-de-raíz-cuadrada">2. <strong>Transformación de Raíz Cuadrada</strong></h3>
<ul>
<li><strong>Transformación</strong>: Es útil cuando los datos tienen una distribución con una leve asimetría positiva o cuando se busca estabilizar la varianza.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y'%20=%20%5Csqrt%7By%7D"></li>
</ul></li>
<li><strong>Inversa</strong>: La inversa de esta transformación es elevar al cuadrado.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y%20=%20(y')%5E2"></li>
</ul></li>
</ul>
</section>
<section id="transformación-inversa-1y" class="level3">
<h3 class="anchored" data-anchor-id="transformación-inversa-1y">3. <strong>Transformación Inversa (1/y)</strong></h3>
<ul>
<li><strong>Transformación</strong>: Se utiliza cuando los datos tienen una tendencia lineal negativa o para ajustar relaciones hiperbólicas.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y'%20=%20%5Cfrac%7B1%7D%7By%7D"></li>
</ul></li>
<li><strong>Inversa</strong>: La transformación inversa es la operación recíproca.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y%20=%20%5Cfrac%7B1%7D%7By'%7D"></li>
</ul></li>
</ul>
</section>
<section id="transformación-de-potencia-box-cox" class="level3">
<h3 class="anchored" data-anchor-id="transformación-de-potencia-box-cox">4. <strong>Transformación de Potencia (Box-Cox)</strong></h3>
<ul>
<li><strong>Transformación</strong>: Box-Cox es una familia de transformaciones que busca estabilizar la varianza y normalizar los datos. Se controla con un parámetro <img src="https://latex.codecogs.com/png.latex?%5Clambda">.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y'%20=%20%5Cfrac%7By%5E%5Clambda%20-%201%7D%7B%5Clambda%7D"> (si <img src="https://latex.codecogs.com/png.latex?%5Clambda%20%5Cneq%200">), o <img src="https://latex.codecogs.com/png.latex?y'%20=%20%5Clog(y)"> (si <img src="https://latex.codecogs.com/png.latex?%5Clambda%20=%200">).</li>
</ul></li>
<li><strong>Inversa</strong>: La inversa depende del valor de <img src="https://latex.codecogs.com/png.latex?%5Clambda">.
<ul>
<li>Si <img src="https://latex.codecogs.com/png.latex?%5Clambda%20=%200">: <img src="https://latex.codecogs.com/png.latex?y%20=%20e%5E%7By'%7D"></li>
<li>Si <img src="https://latex.codecogs.com/png.latex?%5Clambda%20%5Cneq%200">: <img src="https://latex.codecogs.com/png.latex?y%20=%20(y'%20%5Ccdot%20%5Clambda%20+%201)%5E%7B1/%5Clambda%7D"></li>
</ul></li>
</ul>
</section>
<section id="transformación-logística" class="level3">
<h3 class="anchored" data-anchor-id="transformación-logística">5. <strong>Transformación Logística</strong></h3>
<ul>
<li><strong>Transformación</strong>: Se utiliza en modelos de regresión logística, donde se transforma una probabilidad <img src="https://latex.codecogs.com/png.latex?p"> en el logit (logaritmo de las probabilidades).
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y'%20=%20%5Clog%20%5Cleft(%20%5Cfrac%7Bp%7D%7B1-p%7D%20%5Cright)"></li>
</ul></li>
<li><strong>Inversa</strong>: La inversa se conoce como la función logística o sigmoide.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?p%20=%20%5Cfrac%7B1%7D%7B1%20+%20e%5E%7B-y'%7D%7D"></li>
</ul></li>
</ul>
</section>
<section id="transformación-de-arcoseno-arcsin" class="level3">
<h3 class="anchored" data-anchor-id="transformación-de-arcoseno-arcsin">6. <strong>Transformación de Arcoseno (arcsin)</strong></h3>
<ul>
<li><strong>Transformación</strong>: Es usada comúnmente en proporciones o datos de frecuencia que están entre 0 y 1, para normalizarlos.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y'%20=%20%5Carcsin(%5Csqrt%7By%7D)"></li>
</ul></li>
<li><strong>Inversa</strong>: La inversa es la función seno al cuadrado.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y%20=%20(%5Csin(y'))%5E2"></li>
</ul></li>
</ul>
</section>
<section id="transformación-log-log" class="level3">
<h3 class="anchored" data-anchor-id="transformación-log-log">7. <strong>Transformación Log-Log</strong></h3>
<ul>
<li><strong>Transformación</strong>: Se utiliza cuando tanto la variable dependiente como la independiente están en una escala logarítmica.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y'%20=%20%5Clog(y)"> y <img src="https://latex.codecogs.com/png.latex?x'%20=%20%5Clog(x)"></li>
</ul></li>
<li><strong>Inversa</strong>: La exponenciación de ambas variables devuelve a su escala original.
<ul>
<li>Fórmula: <img src="https://latex.codecogs.com/png.latex?y%20=%20e%5E%7By'%7D">, <img src="https://latex.codecogs.com/png.latex?x%20=%20e%5E%7Bx'%7D"></li>
</ul></li>
</ul>
</section>
</section>
<section id="back-transformations-con-emmeans" class="level2">
<h2 class="anchored" data-anchor-id="back-transformations-con-emmeans">Back-transformations con emmeans()</h2>
<p>En el paquete <code>emmeans</code> de R, las <strong>back-transformations</strong> (transformaciones inversas) se utilizan para devolver las estimaciones de medias marginales de los efectos al espacio original de los datos después de que se haya aplicado una transformación en el modelo. Esto es útil cuando se ha ajustado un modelo con una transformación, como una transformación logarítmica o de raíz cuadrada, y deseas interpretar los resultados en la escala original de los datos.</p>
<section id="cómo-funciona" class="level3">
<h3 class="anchored" data-anchor-id="cómo-funciona">¿Cómo funciona?</h3>
<p>Cuando aplicas una transformación a los datos (por ejemplo, logaritmo), el modelo ajustado trabaja en la escala transformada, y por lo tanto, las estimaciones de medias marginales predichas estarán en esa misma escala. Sin embargo, <code>emmeans()</code> permite aplicar automáticamente la transformación inversa, devolviendo las medias estimadas a su escala original para una interpretación más fácil.</p>
<p>El paquete <code>emmeans</code> detecta automáticamente si la transformación se usó en el modelo y aplica la transformación inversa al calcular los <strong>Estimated Marginal Means</strong> (EMMs). Esto se puede controlar utilizando el argumento <code>type = "response"</code> para realizar la transformación inversa al solicitar los EMMs.</p>
</section>
<section id="ejemplo-de-uso-de-emmeans-con-back-transformations" class="level3">
<h3 class="anchored" data-anchor-id="ejemplo-de-uso-de-emmeans-con-back-transformations">Ejemplo de uso de <code>emmeans()</code> con back-transformations</h3>
<p>Supongamos que tienes un modelo lineal generalizado (GLM) con una transformación logarítmica aplicada a la variable de respuesta. A continuación te muestro cómo podrías aplicar una back-transformation usando <code>emmeans()</code>:</p>
<section id="paso-1-ajustar-el-modelo" class="level4">
<h4 class="anchored" data-anchor-id="paso-1-ajustar-el-modelo">Paso 1: Ajustar el modelo</h4>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ejemplo de un GLM con transformación logarítmica</span></span>
<span id="cb1-2">modelo <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glm</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tratamiento, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gaussian</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">link =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> datos)</span></code></pre></div>
<p>En este caso, <code>y</code> es la variable de respuesta transformada mediante un enlace logarítmico.</p>
</section>
<section id="paso-2-obtener-los-emms-con-la-transformación-inversa" class="level4">
<h4 class="anchored" data-anchor-id="paso-2-obtener-los-emms-con-la-transformación-inversa">Paso 2: Obtener los EMMs con la transformación inversa</h4>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(emmeans)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtener las medias marginales estimadas (EMMs) y aplicar back-transformation</span></span>
<span id="cb2-4">em_means <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">emmeans</span>(modelo, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tratamiento, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>)</span></code></pre></div>
<ul>
<li>El argumento <code>type = "response"</code> le indica a <code>emmeans()</code> que aplique la transformación inversa (en este caso, exponenciación, ya que se usó una transformación logarítmica).</li>
<li>Si no se especifica <code>type = "response"</code>, <code>emmeans()</code> devolvería las estimaciones en la escala transformada (logarítmica en este caso).</li>
</ul>
</section>
<section id="paso-3-interpretar-los-resultados" class="level4">
<h4 class="anchored" data-anchor-id="paso-3-interpretar-los-resultados">Paso 3: Interpretar los resultados</h4>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mostrar los resultados back-transformados</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(em_means)</span></code></pre></div>
<p>Esto te mostrará las estimaciones en la escala original de los datos, lo cual es más fácil de interpretar en términos del contexto del problema. Además, los intervalos de confianza también serán transformados inversamente.</p>
</section>
</section>
<section id="ejemplo-con-transformación-de-raíz-cuadrada" class="level3">
<h3 class="anchored" data-anchor-id="ejemplo-con-transformación-de-raíz-cuadrada">Ejemplo con Transformación de Raíz Cuadrada</h3>
<p>Si usas una transformación de raíz cuadrada en lugar de logarítmica, la back-transformation consistirá en elevar al cuadrado los resultados.</p>
<section id="paso-1-ajustar-el-modelo-1" class="level4">
<h4 class="anchored" data-anchor-id="paso-1-ajustar-el-modelo-1">Paso 1: Ajustar el modelo</h4>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">modelo_sqrt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tratamiento, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> datos)</span></code></pre></div>
</section>
<section id="paso-2-obtener-las-medias-marginales-estimadas-con-la-transformación-inversa" class="level4">
<h4 class="anchored" data-anchor-id="paso-2-obtener-las-medias-marginales-estimadas-con-la-transformación-inversa">Paso 2: Obtener las medias marginales estimadas con la transformación inversa</h4>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtener las medias marginales estimadas con back-transformation (cuadrado)</span></span>
<span id="cb5-2">em_means_sqrt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">emmeans</span>(modelo_sqrt, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> tratamiento, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>)</span></code></pre></div>
<p>En este caso, <code>emmeans()</code> elevará las medias estimadas al cuadrado para devolverlas a la escala original.</p>
</section>
<section id="paso-3-ver-los-resultados" class="level4">
<h4 class="anchored" data-anchor-id="paso-3-ver-los-resultados">Paso 3: Ver los resultados</h4>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(em_means_sqrt)</span></code></pre></div>
<p>Cuando usas el paquete <code>emmeans()</code> en R, puedes realizar back-transformations fácilmente con el argumento <code>type = "response"</code>. Este enfoque es útil cuando has ajustado un modelo con una transformación en la variable de respuesta y deseas interpretar las medias estimadas en la escala original de los datos.</p>
</section>
</section>
</section>
<section id="ejercicio-practico" class="level2">
<h2 class="anchored" data-anchor-id="ejercicio-practico">Ejercicio practico</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(emmeans)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'emmeans' was built under R version 4.4.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome to emmeans.
Caution: You lose important information if you filter this package's results.
See '? untidy'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">fileName <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://www.casaonofri.it/_datasets/insects.csv"</span></span>
<span id="cb10-2">dataset <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(fileName)</span>
<span id="cb10-3">dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Insecticide <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Insecticide)</span>
<span id="cb10-4">dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Count)</span>
<span id="cb10-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dataset)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Insecticide Rep Count
1          T1   1   448
2          T1   2   906
3          T1   3   484
4          T1   4   477
5          T1   5   634
6          T2   1   211</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">log</span>(Count) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Insecticide, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dataset)</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">emmeans</span>(model, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Insecticide, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Insecticide response     SE df lower.CL upper.CL
 T1             568.6 101.01 12    386.1    837.3
 T2             335.1  59.54 12    227.6    493.5
 T3              51.9   9.22 12     35.2     76.4

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
</div>
<p>Desafortunadamente, no todas las transformaciones son autodetectadas; por ejemplo, consideremos el conjunto de datos ‘Hours_to_failure.csv’, donde tenemos el tiempo hasta el fallo (en horas) de un dispositivo, afectado por la temperatura de funcionamiento. Si consideramos la temperatura como un factor, podemos ajustar un modelo ANOVA; una comprobación con la función <code>boxcox()</code> del paquete <code>MASS</code> sugiere que este conjunto de datos podría requerir una transformación estabilizadora en el valor inverso.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(MASS)</span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(emmeans)</span>
<span id="cb14-3">fileName <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://www.casaonofri.it/_datasets/Hours_to_failure.csv"</span></span>
<span id="cb14-4">dataset <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read.csv</span>(fileName)</span>
<span id="cb14-5">dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Temp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Temp)</span>
<span id="cb14-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dataset)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Temp Hours_to_failure
1 1520             1953
2 1520             2135
3 1520             2471
4 1520             4727
5 1520             6134
6 1520             6314</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(Hours_to_failure <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dataset)</span>
<span id="cb16-2">tp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">boxcox</span>(model)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(model)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como vemos a continuación, la transformación inversa no se detecta automáticamente.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">model2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">I</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>Hours_to_failure) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dataset)</span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">emmeans</span>(model2, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Temp response       SE df lower.CL upper.CL
 1520 0.000320 9.52e-05 20 0.000121 0.000518
 1620 0.000579 9.52e-05 20 0.000381 0.000778
 1660 0.001043 9.52e-05 20 0.000844 0.001241
 1708 0.001565 9.52e-05 20 0.001366 0.001763

Confidence level used: 0.95 
Intervals are back-transformed from the identity scale </code></pre>
</div>
</div>
<p>En esta situación, hay que utilizar un enfoque alternativo. La transformación puede realizarse antes de ajustar el modelo; a continuación, tenemos que actualizar la «rejilla de referencia» del modelo, especificando qué tipo de transformación hemos realizado (<code>tran = "inverse"</code>). Por último, podemos pasar la rejilla actualizada a la función <code>emmeans()</code>. Y… ¡la transformación inversa está servida!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>invHours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Hours_to_failure</span>
<span id="cb20-2">model3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(invHours <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dataset)</span>
<span id="cb20-3">updGrid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ref_grid</span>(model3), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tran =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inverse"</span>)</span>
<span id="cb20-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">emmeans</span>(updGrid, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Temp response    SE df lower.CL upper.CL
 1520     3128 931.6 20     1930     8258
 1620     1726 283.6 20     1285     2626
 1660      959  87.6 20      806     1185
 1708      639  38.9 20      567      732

Confidence level used: 0.95 
Intervals are back-transformed from the inverse scale </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(model3)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>A veces, necesito un extra de flexibilidad. Por ejemplo, si nos fijamos en el gráfico ‘boxcox’ anterior, vemos que la transformación inversa, aunque aceptable (el valor <img src="https://latex.codecogs.com/png.latex?-1"> está dentro de los límites de confianza para (<img src="https://latex.codecogs.com/png.latex?%5Clambda">) no es la mejor. De hecho, el valor de máxima verosimilitud es -0,62:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">tp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(tp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.6262626</code></pre>
</div>
</div>
<p>Por lo tanto, podríamos utilizar la siguiente transformación, que está dentro de la familia ‘boxcox’:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AW%20=%20%5Cfrac%7BY%5E%7B-0,62%7D%20-%201%7D%7B-0,62%7D%0A"></p>
<p>Este tipo de transformación no es manejable con el código anterior y necesitamos utilizar la función <code>make.tran()</code>, especificando el valor de <img src="https://latex.codecogs.com/png.latex?%5Clambda"> (<code>alpha = -0.62</code>) y el valor del parámetro desplazamiento (<code>beta = 1</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>bcHours <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> (dataset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Hours_to_failure<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.62</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.62</span>)</span>
<span id="cb25-2">model4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(bcHours <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dataset)</span>
<span id="cb25-3">updGrid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ref_grid</span>(model4), </span>
<span id="cb25-4">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tran =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make.tran</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"boxcox"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.62</span>,</span>
<span id="cb25-5">                                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">beta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb25-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">emmeans</span>(updGrid, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>Temp, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Temp response    SE df lower.CL upper.CL
 1520     3265 708.8 20     2191     5556
 1620     1763 260.9 20     1329     2483
 1660      976 100.0 20      798     1227
 1708      642  50.7 20      549      764

Confidence level used: 0.95 
Intervals are back-transformed from the Box-Cox (lambda = -0.62) of (y - 1) scale </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(model4)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/back-transformation/index_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La función <code>make.tran()</code> puede utilizarse para especificar otras funciones de transformación, como la transformación angular que se utiliza a menudo para porcentajes y proporciones. Puede obtener una lista completa buscando en help (<code>?make.tran</code>) desde dentro de R.</p>
</section>
<section id="conclusión" class="level2">
<h2 class="anchored" data-anchor-id="conclusión">Conclusión</h2>
<p>Las transformaciones estabilizadoras, a pesar de su antigüedad, pueden seguir siendo útiles para ajustar modelos heteroscedásticos; ¡no las infravalore sólo porque ya no estén de moda!</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2024,
  author = {Santos, Franklin},
  title = {Back-Transformations with Emmeans() in {R}},
  date = {2024-08-06},
  url = {https://franklinsantosm.com/posts/back-transformation},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2024" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2024. <span>“Back-Transformations with Emmeans() in
R.”</span> August 6, 2024. <a href="https://franklinsantosm.com/posts/back-transformation">https://franklinsantosm.com/posts/back-transformation</a>.
</div></div></section></div> ]]></description>
  <category>R</category>
  <category>Normalidad</category>
  <category>Transformation</category>
  <guid>https://franklinsantosm.com/posts/back-transformation/</guid>
  <pubDate>Tue, 06 Aug 2024 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/back-transformation/fs.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Potato Diversity Analysis:A Step-by-Step Guide</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/conglomerados/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this article, we will delve into a comprehensive approach to analyzing the genetic diversity of potato using various statistical and multivariate analysis methods in R. The analysis encompasses techniques such as <strong>k-means clustering</strong>, <strong>hierarchical clustering</strong>, <strong>DBSCAN</strong>, and <strong>Principal Component Analysis (PCA)</strong>, supported by clear visualizations to facilitate the interpretation of results. This guide aims to provide a robust framework for researchers and practitioners working in the field of plant genetics and diversity analysis.</p>
</section>
<section id="data-loading-and-preparation" class="level2">
<h2 class="anchored" data-anchor-id="data-loading-and-preparation">Data Loading and Preparation</h2>
<p>The first step in any analysis is to load and prepare the data. Here, we use R to read the data from an Excel file, select relevant columns, and scale the data. Scaling ensures that each variable contributes equally to the analysis, which is particularly important in clustering and PCA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the dataset from an Excel file</span></span>
<span id="cb1-5">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_excel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/franklin/Documents/R/myblog/posts/conglomerados/DATOS_R_JUAN JOSE.xlsx"</span>)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 54
   `N°` codigo_colecta nombre_comun  Departamento Provincia Municipio Localidad
  &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;    
1     1 JCH 001        JACHA         POTOSI       Bustillos Chayanta  Jacha    
2     2 JCH 002        TANI TANI     POTOSI       Bustillos Chayanta  Jacha    
3     3 JCH 003        TUNANTE       POTOSI       Bustillos Chayanta  Jacha    
4     4 JCH 004        QOLLU  PEPINO POTOSI       Bustillos Chayanta  Jacha    
5     5 JCH 005        QHOLLU YURAQ  POTOSI       Bustillos Chayanta  Jacha    
6     6 JCH 006        QHOLLU PUCA   POTOSI       Bustillos Chayanta  Jacha    
# ℹ 47 more variables: Latitud &lt;dbl&gt;, Longitud &lt;dbl&gt;, Altitud &lt;dbl&gt;,
#   CAMPAÑA &lt;dbl&gt;, REGENERACION &lt;chr&gt;, BLOQ &lt;dbl&gt;, SURC &lt;dbl&gt;, RDTO &lt;dbl&gt;,
#   NTUBER &lt;dbl&gt;, N_caja &lt;dbl&gt;, Ev_Almacen &lt;chr&gt;, HPL &lt;dbl&gt;, CTL &lt;dbl&gt;,
#   FAL &lt;dbl&gt;, TDS &lt;dbl&gt;, NFL &lt;dbl&gt;, NIF &lt;dbl&gt;, NIP &lt;dbl&gt;, GFL &lt;dbl&gt;,
#   FCL &lt;dbl&gt;, CPF &lt;dbl&gt;, INT &lt;dbl&gt;, CSF &lt;dbl&gt;, DCS &lt;dbl&gt;, CPL &lt;dbl&gt;,
#   CLZ &lt;dbl&gt;, PAN &lt;dbl&gt;, PPT &lt;dbl&gt;, CBY &lt;dbl&gt;, FBY &lt;dbl&gt;, FGR &lt;dbl&gt;,
#   FRA &lt;dbl&gt;, POJ &lt;dbl&gt;, CPPL &lt;dbl&gt;, INTC &lt;dbl&gt;, CSP &lt;dbl&gt;, DSCPL &lt;dbl&gt;, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Column selection for the analysis (excluding TDS due to lack of variation)</span></span>
<span id="cb3-2">db <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">19</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">47</span>)</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data preparation: remove non-numeric columns and scale the data</span></span>
<span id="cb3-6">sdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> db <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"codigo_colecta"</span>)</span>
<span id="cb3-9"></span>
<span id="cb3-10">sdf <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale</span>(sdf)</span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(sdf)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              RDTO     NTUBER         HPL        CTL        FAL        NFL
JCH 001 -1.0364935  2.3631177 -2.33535670  1.5974622  0.2021708 -0.2949048
JCH 002 -1.0332533  1.3262372 -2.33535670  2.3526261 -3.0325614  1.3193108
JCH 003 -0.8518015  0.2422258 -1.21610741 -0.6680296 -1.4151953 -0.2949048
JCH 004 -0.4208535 -1.4309223 -0.09685811  0.0871343  0.2021708  2.9335265
JCH 005 -1.2114649 -1.1010057 -0.09685811 -0.6680296 -1.4151953 -1.9091204
JCH 006 -0.5277805 -0.2526490 -0.09685811  0.0871343  0.2021708 -0.2949048
               NIF        NIP        GFL        FCL        CPF         INT
JCH 001  2.0689872  1.3677450  2.6330006  0.3720828  0.3365174  0.08133921
JCH 002  0.3475899  1.3677450  2.6330006 -2.7236462  0.3365174 -1.12712898
JCH 003 -1.3738075 -0.7241003 -0.3761429  0.3720828 -0.4081168 -1.12712898
JCH 004  2.0689872 -0.7241003 -0.3761429  0.3720828  0.3365174  1.28980739
JCH 005 -1.3738075 -0.7241003 -0.3761429  0.3720828  0.3365174  0.08133921
JCH 006 -1.3738075  1.3677450 -0.3761429  0.3720828  0.3365174 -1.12712898
               CSF        DCS        CPL        CLZ        PAN         PPT
JCH 001 -0.2849313 -0.3623917 -0.5231525 -0.4795775 -0.4143268  0.09001093
JCH 002 -0.8140895 -1.2189538  1.4919534  0.9454527 -0.4143268  0.09001093
JCH 003 -0.2849313  1.3507325 -1.5307055 -1.1920925 -0.4143268 -1.31415965
JCH 004 -0.2849313 -0.3623917  1.4919534  0.9454527 -0.4143268  1.02612466
JCH 005 -0.2849313 -0.3623917  0.9881770 -0.4795775  2.9002873 -0.84610279
JCH 006 -0.2849313 -0.3623917 -0.5231525 -0.4795775  2.9002873  1.02612466
               CBY        FBY       FGR        FRA       POJ       CPPL
JCH 001  0.6475703 -0.2236502  0.364163 -0.6069687 -0.558308 -0.2817993
JCH 002  0.6475703 -0.2236502  0.364163 -0.6069687 -0.558308 -1.3284824
JCH 003  0.6475703 -0.2236502  0.364163 -0.6069687 -2.086309  0.4159894
JCH 004  0.6475703 -0.2236502 -1.568130 -0.2798975 -0.558308 -0.9795880
JCH 005 -1.2362705 -0.2236502  1.137080  0.7013162 -0.558308 -0.9795880
JCH 006 -0.7653103 -0.2236502  1.137080  0.7013162 -2.086309  0.7648838
              INTC        CSP      DSCPL        CPP       CSPL       DCSP
JCH 001 -0.9149821  0.4009646  0.1217388  0.8023403 -0.4827367 -0.4143496
JCH 002 -0.9149821 -0.2506029  0.1217388  0.8023403 -0.4827367 -0.4143496
JCH 003  1.4940847 -1.8795218 -2.0801452  0.8023403 -0.4827367 -0.4143496
JCH 004  0.2895513  0.4009646  0.1217388  2.4070210 -0.4827367 -0.4143496
JCH 005  0.2895513  0.4009646 -1.5296742 -0.8023403 -0.4827367 -0.4143496
JCH 006  0.2895513 -0.5763867  1.7731517  0.8023403 -0.4827367 -0.4143496</code></pre>
</div>
</div>
</section>
<section id="clustering-k-means-method" class="level2">
<h2 class="anchored" data-anchor-id="clustering-k-means-method">Clustering: K-means Method</h2>
<p><strong>K-means clustering</strong> is a partitioning method that divides data into a predetermined number of clusters, minimizing the within-cluster variance. The following steps include determining the optimal number of clusters and performing the clustering analysis.</p>
<section id="determining-the-optimal-number-of-clusters" class="level3">
<h3 class="anchored" data-anchor-id="determining-the-optimal-number-of-clusters">Determining the Optimal Number of Clusters</h3>
<p>Determining the optimal number of clusters is crucial for meaningful clustering. We employ several methods, including the <strong>within-cluster sum of squares (WSS)</strong>, <strong>silhouette analysis</strong>, and <strong>Gap Statistic</strong> to identify the most appropriate number of clusters for the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(factoextra)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute distance matrix and visualize</span></span>
<span id="cb5-4">distance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_dist</span>(sdf)</span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_dist</span>(distance, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gradient =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">low =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00AFBB"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mid =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">high =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FC4E07"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Elbow method for WSS</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_nbclust</span>(sdf, kmeans, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wss"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Silhouette method</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_nbclust</span>(sdf, kmeans, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"silhouette"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-2-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Gap Statistic</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(cluster)</span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb8-4">gap_stat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clusGap</span>(sdf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN =</span> kmeans, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nstart =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">K.max =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">B =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb8-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(gap_stat, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"firstmax"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Clustering Gap statistic ["clusGap"] from call:
clusGap(x = sdf, FUNcluster = kmeans, K.max = 10, B = 50, nstart = 25)
B=50 simulated reference sets, k = 1..10; spaceH0="scaledPCA"
 --&gt; Number of clusters (method 'firstmax'): 1
          logW   E.logW       gap     SE.sim
 [1,] 5.279958 5.652502 0.3725440 0.01149949
 [2,] 5.228562 5.598937 0.3703751 0.01042953
 [3,] 5.183834 5.560603 0.3767692 0.01100671
 [4,] 5.148115 5.529050 0.3809349 0.01071279
 [5,] 5.116327 5.501342 0.3850155 0.01052125
 [6,] 5.088564 5.476447 0.3878835 0.01032929
 [7,] 5.063318 5.453360 0.3900420 0.01027040
 [8,] 5.039872 5.431245 0.3913732 0.01002459
 [9,] 5.015518 5.410428 0.3949102 0.01009456
[10,] 4.996567 5.390239 0.3936718 0.01019443</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_gap_stat</span>(gap_stat)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-2-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The <strong>WSS</strong> method, often referred to as the “elbow method,” helps to identify the point where the marginal gain in explanatory power diminishes significantly, indicating the optimal number of clusters. The <strong>silhouette method</strong> provides a measure of how similar an object is to its own cluster compared to other clusters. The <strong>Gap Statistic</strong> compares the total within intra-cluster variation for different numbers of clusters with their expected values under null reference distribution of the data.</p>
</section>
<section id="applying-the-k-means-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="applying-the-k-means-algorithm">Applying the K-means Algorithm</h3>
<p>After identifying the optimal number of clusters, we apply the k-means algorithm and visualize the clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">123</span>)</span>
<span id="cb11-2">kmeans_resultados <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kmeans</span>(sdf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">centers =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace 4 with the optimal number of clusters</span></span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualization of clusters</span></span>
<span id="cb11-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_cluster</span>(kmeans_resultados, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sdf)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The results from k-means clustering provide insight into how the samples are grouped based on their genetic characteristics. Each cluster represents a group of samples that share similar traits, and the visualizations help in understanding the distribution of these clusters within the dataset.</p>
</section>
</section>
<section id="hierarchical-clustering" class="level2">
<h2 class="anchored" data-anchor-id="hierarchical-clustering">Hierarchical Clustering</h2>
<p><strong>Hierarchical clustering</strong> is another clustering technique that creates a hierarchy of clusters, which can be visualized as a tree or dendrogram. This method is particularly useful for visualizing the relationships between clusters and understanding the structure of the data.</p>
<section id="generating-the-dendrogram" class="level3">
<h3 class="anchored" data-anchor-id="generating-the-dendrogram">Generating the Dendrogram</h3>
<p>We begin by calculating the distance matrix using the Euclidean distance and applying the hierarchical clustering algorithm using Ward’s method, which minimizes the variance within clusters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dendextend)</span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compute distance matrix</span></span>
<span id="cb12-4">distancias <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dist</span>(sdf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"euclidean"</span>)</span>
<span id="cb12-5"></span>
<span id="cb12-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform hierarchical clustering</span></span>
<span id="cb12-7">res.hc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hclust</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d =</span> distancias, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward.D2"</span>)</span>
<span id="cb12-8"></span>
<span id="cb12-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot dendrogram</span></span>
<span id="cb12-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(res.hc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hang =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cut the dendrogram to form clusters</span></span>
<span id="cb13-2">grupos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cutree</span>(res.hc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Replace 4 with the desired number of clusters</span></span></code></pre></div>
</div>
<p>The dendrogram allows us to visualize how the clusters are formed and how individual data points or groups of points merge as the level of clustering increases. By cutting the dendrogram at a particular height, we can extract a specific number of clusters that represent the underlying structure of the data.</p>
</section>
<section id="assessment-and-visualization" class="level3">
<h3 class="anchored" data-anchor-id="assessment-and-visualization">Assessment and Visualization</h3>
<p>Different methods of hierarchical clustering can be compared to evaluate which method best captures the structure of the data. We then visualize the dendrogram with colored clusters for better interpretability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Comparison of different linkage methods</span></span>
<span id="cb14-2">m <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"average"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"single"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward"</span>)</span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(m) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"average"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"single"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"complete"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ward"</span>)</span>
<span id="cb14-4"></span>
<span id="cb14-5">ac <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb14-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">agnes</span>(sdf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> x)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ac</span>
<span id="cb14-7">}</span>
<span id="cb14-8"></span>
<span id="cb14-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dbl</span>(m, ac)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  average    single  complete      ward 
0.5463403 0.4630005 0.6197599 0.7498075 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize dendrogram with colored clusters</span></span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_dend</span>(res.hc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb16-3">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, </span>
<span id="cb16-4">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k_colors =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jco"</span>, </span>
<span id="cb16-5">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rect_border =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jco"</span>, </span>
<span id="cb16-6">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rect_fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The `&lt;scale&gt;` argument of `guides()` cannot be `FALSE`. Use "none" instead as
of ggplot2 3.3.4.
ℹ The deprecated feature was likely used in the factoextra package.
  Please report the issue at &lt;https://github.com/kassambara/factoextra/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Circular</span></span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_dend</span>(res.hc, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb18-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rect =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb18-4">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k_colors =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jco"</span>,</span>
<span id="cb18-5">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rect_border =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"jco"</span>,</span>
<span id="cb18-6">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rect_fill =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb18-7">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"circular"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here, we assess different linkage methods such as average, single, complete, and Ward’s method. The agglomerative coefficient (AC) is computed for each method, with higher values indicating a better fit. The final dendrogram is color-coded to represent the different clusters, providing a clear visual summary of the hierarchical structure.</p>
</section>
</section>
<section id="density-based-clustering-dbscan" class="level2">
<h2 class="anchored" data-anchor-id="density-based-clustering-dbscan">Density-Based Clustering: DBSCAN</h2>
<p><strong>DBSCAN (Density-Based Spatial Clustering of Applications with Noise)</strong> is a powerful clustering technique that identifies clusters based on density, allowing for the detection of outliers. Unlike k-means, DBSCAN does not require the number of clusters to be specified a priori, making it particularly useful for datasets with irregular cluster shapes.</p>
<section id="finding-the-optimal-epsilon-and-applying-dbscan" class="level3">
<h3 class="anchored" data-anchor-id="finding-the-optimal-epsilon-and-applying-dbscan">Finding the Optimal Epsilon and Applying DBSCAN</h3>
<p>The epsilon parameter controls the neighborhood radius for density estimation. We begin by identifying an appropriate epsilon value through a k-NN distance plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dbscan)</span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Identify optimal epsilon using k-NN distance plot</span></span>
<span id="cb19-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kNNdistplot</span>(sdf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">k =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb19-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adjust according to the plot</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Apply DBSCAN algorithm</span></span>
<span id="cb20-2">dbscan_resultados <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbscan</span>(sdf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">eps =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minPts =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualize DBSCAN results</span></span>
<span id="cb20-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_cluster</span>(dbscan_resultados, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sdf)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The k-NN distance plot helps to identify a natural choice for epsilon by observing where the plot exhibits the most pronounced change in slope. The DBSCAN algorithm is then applied, and the results are visualized. Clusters are identified based on dense regions of points, with outliers being points that do not belong to any cluster.</p>
</section>
</section>
<section id="principal-component-analysis-pca" class="level2">
<h2 class="anchored" data-anchor-id="principal-component-analysis-pca">Principal Component Analysis (PCA)</h2>
<p><strong>Principal Component Analysis (PCA)</strong> is a dimensionality reduction technique that transforms the data into a set of orthogonal components, explaining the maximum variance with the fewest components. PCA is especially useful for visualizing high-dimensional data in two or three dimensions.</p>
<section id="performing-pca-and-visualizing-results" class="level3">
<h3 class="anchored" data-anchor-id="performing-pca-and-visualizing-results">Performing PCA and Visualizing Results</h3>
<p>We perform PCA on the scaled data and visualize the results, focusing on the variance explained by each component and the relationship between variables and samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform PCA</span></span>
<span id="cb21-2">acp_resultados <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prcomp</span>(sdf, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale. =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Summary of PCA results</span></span>
<span id="cb21-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(acp_resultados)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          PC1    PC2     PC3     PC4     PC5     PC6     PC7
Standard deviation     1.8711 1.7506 1.57675 1.44454 1.32993 1.26967 1.25193
Proportion of Variance 0.1167 0.1022 0.08287 0.06956 0.05896 0.05374 0.05224
Cumulative Proportion  0.1167 0.2189 0.30173 0.37129 0.43024 0.48398 0.53622
                           PC8     PC9    PC10    PC11    PC12    PC13    PC14
Standard deviation     1.14515 1.09504 1.04044 1.01979 0.97386 0.93209 0.92048
Proportion of Variance 0.04371 0.03997 0.03608 0.03467 0.03161 0.02896 0.02824
Cumulative Proportion  0.57994 0.61991 0.65599 0.69066 0.72227 0.75123 0.77947
                          PC15    PC16    PC17    PC18    PC19    PC20    PC21
Standard deviation     0.87393 0.81854 0.81299 0.77542 0.75455 0.68666 0.65538
Proportion of Variance 0.02546 0.02233 0.02203 0.02004 0.01898 0.01572 0.01432
Cumulative Proportion  0.80493 0.82726 0.84930 0.86934 0.88832 0.90403 0.91835
                         PC22    PC23    PC24    PC25    PC26   PC27    PC28
Standard deviation     0.6318 0.61667 0.58666 0.54725 0.53177 0.4837 0.48009
Proportion of Variance 0.0133 0.01268 0.01147 0.00998 0.00943 0.0078 0.00768
Cumulative Proportion  0.9316 0.94433 0.95580 0.96579 0.97521 0.9830 0.99069
                          PC29    PC30
Standard deviation     0.43358 0.30199
Proportion of Variance 0.00627 0.00304
Cumulative Proportion  0.99696 1.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scree plot showing explained variance by each component</span></span>
<span id="cb23-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_eig</span>(acp_resultados)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot of individuals in the space of the first two principal components</span></span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_pca_ind</span>(acp_resultados, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom.ind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"point"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pointshape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pointsize =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill.ind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.ind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot of variables in the space of the first two principal components</span></span>
<span id="cb25-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_pca_var</span>(acp_resultados, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"contrib"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gradient.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yellow"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Biplot showing both individuals and variables</span></span>
<span id="cb26-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_pca_biplot</span>(acp_resultados, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The scree plot shows the proportion of variance explained by each principal component, aiding in the selection of the number of components to retain. The PCA biplots allow us to interpret the contribution of variables to the principal components and observe the distribution of samples along these components. This visualization is key to understanding the underlying structure of the data and the relationships between different genetic traits.</p>
</section>
</section>
<section id="multiple-factor-analysis-mfa" class="level2">
<h2 class="anchored" data-anchor-id="multiple-factor-analysis-mfa">Multiple Factor Analysis (MFA)</h2>
<p>For datasets containing both quantitative and qualitative variables, <strong>Multiple Factor Analysis (MFA)</strong> is applied. MFA is an extension of PCA that can handle mixed data types and is particularly useful in genetics studies where both types of data are often present.</p>
<section id="performing-mfa-and-interpreting-results" class="level3">
<h3 class="anchored" data-anchor-id="performing-mfa-and-interpreting-results">Performing MFA and Interpreting Results</h3>
<p>We perform MFA on the mixed dataset and visualize the results, focusing on the contributions of quantitative variables and the distribution of individuals across groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert character variables to factors</span></span>
<span id="cb27-2">df2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb27-3"></span>
<span id="cb27-4"> db <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">column_to_rownames</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"codigo_colecta"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate_if</span>(is.character, as.factor)</span>
<span id="cb27-7"></span>
<span id="cb27-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(FactoMineR)</span>
<span id="cb27-9"></span>
<span id="cb27-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Perform MFA</span></span>
<span id="cb27-11">res.famd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FAMD</span>(df2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">graph =</span> F)</span>
<span id="cb27-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(res.famd)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>*The results are available in the following objects:

  name          description                             
1 "$eig"        "eigenvalues and inertia"               
2 "$var"        "Results for the variables"             
3 "$ind"        "results for the individuals"           
4 "$quali.var"  "Results for the qualitative variables" 
5 "$quanti.var" "Results for the quantitative variables"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Scree plot showing the percentage of variance explained by each component</span></span>
<span id="cb29-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_screeplot</span>(res.famd)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot showing the contribution of quantitative variables</span></span>
<span id="cb30-2">quanti.var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_famd_var</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quanti.var"</span>)</span>
<span id="cb30-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_famd_var</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quanti.var"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualization of individuals by group with confidence ellipses</span></span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_mfa_ind</span>(res.famd, </span>
<span id="cb31-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">habillage =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Departamento"</span>,</span>
<span id="cb31-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00AFBB"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E7B800"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FC4E07"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkgreen"</span>),</span>
<span id="cb31-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">addEllipses =</span> F, </span>
<span id="cb31-6">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ellipse.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>, </span>
<span id="cb31-7">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb31-8">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span></span>
<span id="cb31-9">             )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/conglomerados/index_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The MFA analysis allows us to decompose the data into factors that explain the most variation, considering both types of variables. The scree plot helps determine how many factors to retain, while the visualizations provide insights into the contributions of individual variables and the grouping of samples based on both qualitative and quantitative characteristics.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>This workflow provides a comprehensive and detailed framework for conducting genetic diversity analysis in potato using various clustering and multivariate analysis techniques in R. By employing different methods, researchers can gain a deeper understanding of the genetic structure within their dataset, identify meaningful patterns of variation, and ultimately make informed decisions in breeding programs and conservation efforts. The choice of method depends on the specific nature of the data and the research objectives, whether it is to identify distinct genetic clusters, reduce data dimensionality, or both.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2024,
  author = {Santos, Franklin},
  title = {Potato {Diversity} {Analysis:A} {Step-by-Step} {Guide}},
  date = {2024-07-28},
  url = {https://franklinsantosm.com/posts/conglomerados},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2024" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2024. <span>“Potato Diversity Analysis:A Step-by-Step
Guide.”</span> July 28, 2024. <a href="https://franklinsantosm.com/posts/conglomerados">https://franklinsantosm.com/posts/conglomerados</a>.
</div></div></section></div> ]]></description>
  <category>Diversity</category>
  <category>multivariate</category>
  <category>Plant Breeding</category>
  <guid>https://franklinsantosm.com/posts/conglomerados/</guid>
  <pubDate>Sun, 28 Jul 2024 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/conglomerados/fs.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Diseño Completamente al Azar</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/dca/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="diseño-completamente-aleatorizado-dca" class="level2">
<h2 class="anchored" data-anchor-id="diseño-completamente-aleatorizado-dca">1. Diseño completamente aleatorizado (DCA)</h2>
<p>El diseño más sencillo desde el punto de vista de la asignación de unidades experimentales a los tratamientos.</p>
<section id="supuestos" class="level4">
<h4 class="anchored" data-anchor-id="supuestos"><strong>Supuestos:</strong></h4>
<ol type="1">
<li>Distribución normal de residuos</li>
<li>Homogeneidad de varianzas</li>
<li>Observaciones independientes</li>
</ol>
</section>
<section id="ventajas" class="level3">
<h3 class="anchored" data-anchor-id="ventajas"><strong>Ventajas:</strong></h3>
<ul>
<li>Simplicidad</li>
<li>Evita hacer suposiciones estadísticas dudosas.</li>
<li>Pocas violaciones de los supuestos.</li>
<li>El análisis estadístico es sencillo.</li>
</ul>
</section>
<section id="desventaja" class="level3">
<h3 class="anchored" data-anchor-id="desventaja"><strong>Desventaja:</strong></h3>
<ul>
<li>Falta de precisión o incapacidad para estimar con precisión los efectos del tratamiento.</li>
</ul>
</section>
</section>
<section id="paquetes" class="level2">
<h2 class="anchored" data-anchor-id="paquetes">Paquetes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (install &amp;) load packages</span></span>
<span id="cb1-2">pacman<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">p_load</span>(</span>
<span id="cb1-3">  conflicted,</span>
<span id="cb1-4">  desplot,</span>
<span id="cb1-5">  emmeans,</span>
<span id="cb1-6">  ggtext,</span>
<span id="cb1-7">  multcomp,</span>
<span id="cb1-8">  multcompView,</span>
<span id="cb1-9">  tidyverse,</span>
<span id="cb1-10">  lme4)</span>
<span id="cb1-11"></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># handle function conflicts</span></span>
<span id="cb1-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conflicts_prefer</span>(dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>filter) </span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[conflicted] Will prefer dplyr::filter over any other package.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">conflicts_prefer</span>(dplyr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>select)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>[conflicted] Will prefer dplyr::select over any other package.</code></pre>
</div>
</div>
</section>
<section id="base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="base-de-datos">Base de datos</h2>
<p>Este ejemplo procede del “Ejemplo 4.3” del material didáctico “Métodos cuantitativos en biociencias (3402-420)” del <a href="https://www.uni-hohenheim.de/organisation?tx_base_lsfcontentadmin%5BlsfPerson%5D=6257">Prof.&nbsp;Dr.&nbsp;Hans-Peter Piepho</a>. Considera los datos publicados en la p.52 de Mead, Curnow, y Hasted (2002) de un ensayo de rendimiento con melones. El ensayo tenía 4 variedades de melón (variedad). Cada variedad se probó en seis parcelas de campo. La asignación de los tratamientos (<code>variedades</code>) a las unidades experimentales (parcelas) fue completamente al azar. Así, el experimento se planteó como un diseño completamente aleatorizado (DCA).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data is available online:</span></span>
<span id="cb5-2">path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/SchmidtPaul/dsfair_quarto/master/data/Mead1993.csv"</span></span>
<span id="cb5-3"></span>
<span id="cb5-4">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(path) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use path from above</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 24 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): variety
dbl (3): yield, row, col

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(dat)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  variety yield   row   col
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 v1       25.1     4     2
2 v1       17.2     1     6
3 v1       26.4     4     1
4 v1       16.1     1     4
5 v1       22.2     1     2
6 v1       15.9     2     4</code></pre>
</div>
</div>
<section id="formato" class="level3">
<h3 class="anchored" data-anchor-id="formato">Formato</h3>
<p>Antes de nada, la variedad de columna debe codificarse como un factor, ya que R por defecto la codifica como una variable de carácter. Hay múltiples maneras de hacer esto - aquí hay dos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">variety =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(variety))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">dat <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> dat <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">across</span>(variety, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(.x)))</span></code></pre></div>
</div>
</section>
</section>
<section id="distribución-de-los-tratamientos" class="level2">
<h2 class="anchored" data-anchor-id="distribución-de-los-tratamientos">Distribución de los tratamientos</h2>
<p>Dado que se trata de un experimento que se estableció con un determinado diseño experimental (= un diseño completamente aleatorizado; DCA) - tiene sentido obtener también un plano de campo. Esto se puede hacer a través de <code>desplot()</code> de {desplot}:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desplot</span>(</span>
<span id="cb11-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat, </span>
<span id="cb11-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">flip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># row 1 on top, not on bottom</span></span>
<span id="cb11-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">form =</span> variety <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> col <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fill color per variety</span></span>
<span id="cb11-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> variety, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variety names per plot</span></span>
<span id="cb11-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variety names: font size</span></span>
<span id="cb11-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Field layout"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot title</span></span>
<span id="cb11-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.key =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hide legend </span></span>
<span id="cb11-9">  )     </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/dca/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">desplot</span>(</span>
<span id="cb12-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat, </span>
<span id="cb12-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">flip =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># row 1 on top, not on bottom</span></span>
<span id="cb12-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">form =</span> yield <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> col <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fill color per variety</span></span>
<span id="cb12-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> variety, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variety names per plot</span></span>
<span id="cb12-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cex =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variety names: font size</span></span>
<span id="cb12-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yield per plot"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plot title</span></span>
<span id="cb12-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.key =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># hide legend </span></span>
<span id="cb12-9">  )     </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/dca/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelo" class="level2">
<h2 class="anchored" data-anchor-id="modelo">Modelo</h2>
<p>Por último, podemos decidir ajustar un modelo lineal con el rendimiento como variable de respuesta y efectos (fijos) de variedad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">mod <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(yield <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> variety, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat)</span></code></pre></div>
</div>
</section>
<section id="anova" class="level2">
<h2 class="anchored" data-anchor-id="anova">ANOVA</h2>
<p>Basándonos en nuestro modelo, podemos realizar un ANOVA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">ANOVA <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(mod)</span>
<span id="cb14-2">ANOVA</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: yield
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
variety    3 1291.48  430.49  23.418 9.439e-07 ***
Residuals 20  367.65   18.38                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="comparación-de-medias" class="level2">
<h2 class="anchored" data-anchor-id="comparación-de-medias">Comparación de medias</h2>
<p>Además de un ANOVA, también se pueden comparar las medias de rendimiento ajustadas entre variedades mediante pruebas post hoc (prueba t, prueba de Tukey, etc.).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">mean_comp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mod <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">emmeans</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">specs =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> variety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># adj. mean per variety</span></span>
<span id="cb16-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cld</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adjust =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tukey"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Letters =</span> letters) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># compact letter display (CLD)</span></span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: adjust = "tukey" was changed to "sidak"
because "tukey" is only appropriate for one set of pairwise comparisons</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">mean_comp</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> variety emmean   SE df lower.CL upper.CL .group
 v3        19.5 1.75 20     14.7     24.3  a    
 v1        20.5 1.75 20     15.7     25.3  a    
 v4        29.9 1.75 20     25.1     34.7   b   
 v2        37.4 1.75 20     32.6     42.2    c  

Confidence level used: 0.95 
Conf-level adjustment: sidak method for 4 estimates 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Tenga en cuenta que si desea ver los contrastes/diferencias individuales subyacentes entre medias ajustadas, simplemente añada <code>details = TRUE</code> a la sentencia <code>cld()</code>. Además, consulte el artículo de resumen “Visualización compacta de letras”.</p>
<p>Por último, podemos crear un gráfico que muestre tanto los datos brutos como los resultados, es decir, las comparaciones de las medias ajustadas que se basan en el modelo lineal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1">my_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Los puntos negros representan los datos brutos. Los puntos rojos y las barras de error representan medias ajustadas con límites de confianza del 95% por variedad. Las medias seguidas de una letra común no son significativamente diferentes según la prueba de Tukey."</span></span>
<span id="cb20-2"></span>
<span id="cb20-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> variety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># black dots representing the raw data</span></span>
<span id="cb20-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb20-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb20-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> yield)</span>
<span id="cb20-9">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-10">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># red dots representing the adjusted means</span></span>
<span id="cb20-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb20-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mean_comp,</span>
<span id="cb20-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> emmean),</span>
<span id="cb20-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb20-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_nudge</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb20-16">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># red error bars representing the confidence limits of the adjusted means</span></span>
<span id="cb20-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_errorbar</span>(</span>
<span id="cb20-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mean_comp,</span>
<span id="cb20-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> lower.CL, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> upper.CL),</span>
<span id="cb20-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb20-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb20-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_nudge</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb20-24">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># red letters </span></span>
<span id="cb20-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb20-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> mean_comp,</span>
<span id="cb20-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> emmean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_trim</span>(.group)),</span>
<span id="cb20-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb20-30">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_nudge</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb20-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb20-32">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_discrete</span>(</span>
<span id="cb20-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variety"</span></span>
<span id="cb20-35">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb20-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yield"</span>,</span>
<span id="cb20-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb20-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>))</span>
<span id="cb20-40">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> my_caption) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb20-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox_simple</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)),</span>
<span id="cb20-44">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/dca/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Para calcular la heredabilidad y los Best Linear Unbiased Estimators (BLUE) en R, puedes seguir los pasos que se detallan a continuación. Utilizaremos el paquete <code>lme4</code> para ajustar un modelo de efectos mixtos y obtener las estimaciones necesarias.</p>
</section>
<section id="cálculo-de-la-heredabilidad" class="level2">
<h2 class="anchored" data-anchor-id="cálculo-de-la-heredabilidad">Cálculo de la Heredabilidad</h2>
<p>La heredabilidad en sentido amplio se puede estimar como la proporción de la varianza genética (entre variedades) sobre la varianza total (varianza genética + varianza residual). Para esto, ajustaremos un modelo mixto donde la variedad se considere como un efecto aleatorio.</p>
</section>
<section id="cálculo-de-blues" class="level2">
<h2 class="anchored" data-anchor-id="cálculo-de-blues">Cálculo de BLUEs</h2>
<p>Los BLUEs se obtienen cuando tratamos los efectos de la variedad como fijos en un modelo lineal. En el contexto del diseño completamente aleatorizado (DCA), los BLUEs son simplemente las medias ajustadas (predicciones) para cada variedad.</p>
</section>
<section id="ejemplo" class="level2">
<h2 class="anchored" data-anchor-id="ejemplo">Ejemplo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ajustar el modelo mixto para calcular la heredabilidad</span></span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lme4)</span>
<span id="cb21-3"></span>
<span id="cb21-4">mod_mixed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(yield <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span>variety), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat)</span>
<span id="cb21-5"></span>
<span id="cb21-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Resumen del modelo para obtener las varianzas</span></span>
<span id="cb21-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(mod_mixed)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: yield ~ (1 | variety)
   Data: dat

REML criterion at convergence: 144.9

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-1.95560 -0.58695 -0.03299  0.77728  1.48538 

Random effects:
 Groups   Name        Variance Std.Dev.
 variety  (Intercept) 68.68    8.288   
 Residual             18.38    4.288   
Number of obs: 24, groups:  variety, 4

Fixed effects:
            Estimate Std. Error t value
(Intercept)   26.820      4.235   6.333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extraer las varianzas para calcular la heredabilidad</span></span>
<span id="cb23-2">var_comp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VarCorr</span>(mod_mixed))</span>
<span id="cb23-3">var_genetic <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> var_comp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vcov[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Varianza genética (entre variedades)</span></span>
<span id="cb23-4">var_residual <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> var_comp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>vcov[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Varianza residual</span></span>
<span id="cb23-5"></span>
<span id="cb23-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcular la heredabilidad en sentido amplio (H^2)</span></span>
<span id="cb23-7">H2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> var_genetic <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (var_genetic <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> var_residual)</span>
<span id="cb23-8">H2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7888692</code></pre>
</div>
</div>
<section id="calcular-los-blues" class="level3">
<h3 class="anchored" data-anchor-id="calcular-los-blues">Calcular los BLUEs</h3>
<p>Si la variedad es un efecto fijo, los BLUEs coinciden con las medias ajustadas obtenidas en tu código anterior. Sin embargo, si quieres obtener los BLUEs explícitamente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ajustar un modelo con efectos fijos para la variedad</span></span>
<span id="cb25-2">mod_fixed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lm</span>(yield <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> variety, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat)</span>
<span id="cb25-3"></span>
<span id="cb25-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Obtener los BLUEs</span></span>
<span id="cb25-5">BLUEs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">emmeans</span>(mod_fixed, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> variety)</span>
<span id="cb25-6">BLUEs</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> variety emmean   SE df lower.CL upper.CL
 v1        20.5 1.75 20     16.8     24.1
 v2        37.4 1.75 20     33.8     41.1
 v3        19.5 1.75 20     15.8     23.1
 v4        29.9 1.75 20     26.2     33.5

Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="adición-de-heredabilidad-y-blues-al-gráfico" class="level3">
<h3 class="anchored" data-anchor-id="adición-de-heredabilidad-y-blues-al-gráfico">Adición de Heredabilidad y BLUEs al Gráfico</h3>
<p>Si deseas agregar la heredabilidad y los BLUEs al gráfico, puedes hacerlo de la siguiente manera:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcular heredabilidad y obtener BLUEs</span></span>
<span id="cb27-2">H2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(H2, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb27-3"></span>
<span id="cb27-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Calcular los BLUEs y las letras de Tukey</span></span>
<span id="cb27-5">BLUEs <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">emmeans</span>(mod_fixed, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> variety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cld</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">adjust =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Tukey"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Letters =</span> letters) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>()</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Note: adjust = "tukey" was changed to "sidak"
because "tukey" is only appropriate for one set of pairwise comparisons</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Añadir heredabilidad como un texto en el gráfico</span></span>
<span id="cb29-2">my_caption <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Los puntos negros representan los datos brutos. Los puntos rojos y las barras de error representan medias ajustadas con límites de confianza del 95% por variedad. Las medias seguidas de una letra común no son significativamente diferentes según la prueba de Tukey.</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Heredabilidad: "</span>, H2)</span>
<span id="cb29-3"></span>
<span id="cb29-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Crear el gráfico</span></span>
<span id="cb29-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> variety) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-7">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># black dots representing the raw data</span></span>
<span id="cb29-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb29-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> dat,</span>
<span id="cb29-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> yield)</span>
<span id="cb29-11">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># red dots representing the adjusted means</span></span>
<span id="cb29-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb29-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> BLUEs,</span>
<span id="cb29-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> emmean),</span>
<span id="cb29-16">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb29-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_nudge</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb29-18">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># red error bars representing the confidence limits of the adjusted means</span></span>
<span id="cb29-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_errorbar</span>(</span>
<span id="cb29-21">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> BLUEs,</span>
<span id="cb29-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> lower.CL, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> upper.CL),</span>
<span id="cb29-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb29-24">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>,</span>
<span id="cb29-25">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_nudge</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>)</span>
<span id="cb29-26">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># red letters </span></span>
<span id="cb29-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(</span>
<span id="cb29-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> BLUEs,</span>
<span id="cb29-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> emmean, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_trim</span>(.group)),</span>
<span id="cb29-31">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>,</span>
<span id="cb29-32">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">position_nudge</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>),</span>
<span id="cb29-33">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb29-34">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_discrete</span>(</span>
<span id="cb29-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Variety"</span></span>
<span id="cb29-37">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb29-39">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yield"</span>,</span>
<span id="cb29-40">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>),</span>
<span id="cb29-41">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expansion</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mult =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>))</span>
<span id="cb29-42">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> my_caption) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb29-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_textbox_simple</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">margin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">margin</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)),</span>
<span id="cb29-46">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.caption.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/dca/index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Este código te permite visualizar las medias ajustadas junto con la heredabilidad calculada y los BLUEs.</p>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2024,
  author = {Santos, Franklin},
  title = {Diseño {Completamente} Al {Azar}},
  date = {2024-06-12},
  url = {https://franklinsantosm.com/posts/dca},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2024" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2024. <span>“Diseño Completamente Al Azar.”</span>
June 12, 2024. <a href="https://franklinsantosm.com/posts/dca">https://franklinsantosm.com/posts/dca</a>.
</div></div></section></div> ]]></description>
  <category>RCD</category>
  <category>Experimental Design</category>
  <category>Plant Breeding</category>
  <guid>https://franklinsantosm.com/posts/dca/</guid>
  <pubDate>Wed, 12 Jun 2024 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/dca/fsm.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Enhancing Plant Breeding Precision with Row-Column Design</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/row_column_design/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In the realm of agricultural research, particularly plant breeding, precision is paramount. The quest to identify superior plant varieties requires experiments that can accurately attribute observed differences to genetic factors rather than environmental noise. This is where the <strong>row-column design</strong> comes into play, a sophisticated statistical methodology designed to enhance the reliability of field trials by controlling spatial variation.</p>
</section>
<section id="what-is-row-column-design" class="level2">
<h2 class="anchored" data-anchor-id="what-is-row-column-design">What is Row-Column Design?</h2>
<p>At its core, a row-column design involves arranging experimental units into a grid of rows and columns. This organization allows researchers to control two sources of spatial variation simultaneously. Each cell in the grid, or plot, hosts a specific genotype (or treatment), which is randomly assigned to ensure unbiased results.</p>
</section>
<section id="why-is-it-important" class="level2">
<h2 class="anchored" data-anchor-id="why-is-it-important">Why is it Important?</h2>
<p>Field trials often face the challenge of spatial heterogeneity—variations in soil fertility, moisture, sunlight, and other environmental conditions. These variations can introduce significant noise into the data, potentially obscuring true genetic differences. By accounting for variations along both rows and columns, the row-column design mitigates these effects, leading to more precise and reliable experimental outcomes.</p>
</section>
<section id="key-features" class="level2">
<h2 class="anchored" data-anchor-id="key-features">Key Features</h2>
<ol type="1">
<li><strong>Grid Layout</strong>: The field is divided into a systematic grid, creating rows and columns that structure the experimental units.</li>
<li><strong>Randomization</strong>: Treatments are randomly assigned to each plot within the grid, minimizing bias.</li>
<li><strong>Control of Variation</strong>:
<ul>
<li><strong>Row Effects</strong>: Horizontal variations such as soil fertility gradients or irrigation patterns.</li>
<li><strong>Column Effects</strong>: Vertical variations such as different drainage conditions or sunlight exposure.</li>
</ul></li>
</ol>
</section>
<section id="advantages-of-row-column-design" class="level2">
<h2 class="anchored" data-anchor-id="advantages-of-row-column-design">Advantages of Row-Column Design</h2>
<ul>
<li><strong>Increased Precision</strong>: By controlling for two dimensions of variability, this design reduces experimental error, enhancing the accuracy of genotype evaluations.</li>
<li><strong>Flexibility</strong>: Adaptable to fields with irregular shapes or non-uniform conditions, making it versatile for various agricultural scenarios.</li>
<li><strong>Improved Accuracy</strong>: Better control of environmental variation ensures that performance differences are more accurately attributed to genetic factors.</li>
</ul>
</section>
<section id="row-column-design-with-fieldhub-r-package" class="level2">
<h2 class="anchored" data-anchor-id="row-column-design-with-fieldhub-r-package">Row-Column Design with FielDHub R Package</h2>
<p>To facilitate the implementation and analysis of row-column designs, researchers can utilize the <strong>FieldHUB R package</strong>. FieldHUB is a powerful tool specifically developed for managing and analyzing field trial data. It provides a user-friendly interface and a suite of functions tailored to the unique needs of agricultural experiments.</p>
<ul>
<li><strong>Design Creation</strong>: FieldHUB allows researchers to easily set up row-column designs, specifying the number of rows and columns, and randomizing the assignment of treatments.</li>
<li><strong>Data Management</strong>: The package streamlines data entry and management, ensuring that all experimental data are accurately recorded and organized.</li>
<li><strong>Visualization</strong>: FieldHUB offers various visualization tools to help researchers understand spatial patterns and variations within their trials, aiding in the interpretation of results.</li>
<li><strong>Statistical Analysis</strong>: Integrated with R’s robust statistical capabilities, FieldHUB can perform complex analyses, including mixed models and ANOVA, tailored to row-column designs.</li>
</ul>
<p>By leveraging the FieldHUB R package, researchers can enhance the efficiency and accuracy of their field trials, making the row-column design more accessible and practical for large-scale agricultural research.</p>
<section id="using-the-fieldhub-function-row_column" class="level3">
<h3 class="anchored" data-anchor-id="using-the-fieldhub-function-row_column">Using the FielDHub function: <code>row_column()</code></h3>
<p>First, you need to load the <code>FielDHub</code> package by typing</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Install and load FielDHub package</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(FielDHub)</span></code></pre></div>
</div>
<p>Then, you can enter the information describing the above design like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">rcd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_column</span>(</span>
<span id="cb2-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>,</span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrows =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plotNumber =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">101</span>, </span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locationNames =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FARGO"</span>,</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seed =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1244</span></span>
<span id="cb2-9">)</span></code></pre></div>
</div>
<p>The description for the inputs that we used to generate the design,</p>
<ul>
<li><code>t = 45</code> is the number of treatments.</li>
<li><code>nrows = 5</code> is the number of rows.</li>
<li><code>r=3</code> is the number of reps</li>
<li><code>l = 1</code> is the number of locations.</li>
<li><code>plotNumber = 101</code> is the starting plot number.</li>
<li><code>locationNames = "FARGO"</code> is an optional name for each location.</li>
<li><code>seed = 1244</code> is the random seed to replicate identical randomizations.</li>
</ul>
<p>To print a summary of the information that is in the object <code>rcd</code>, we can use the generic function <code>print()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(rcd)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Resolvable Row-Column Design (Two-Step Optimization) 

Efficiency of design: 
   Level Blocks D-Efficiency A-Efficiency   A-Bound
1    Rep      3    1.0000000    1.0000000 1.0000000
2    Row     15    0.8940599    0.8767433 0.8842892
3 Column     27    0.7912130    0.7623893 0.7674419

Information on the design parameters: 
List of 7
 $ rows          : num 5
 $ columns       : num 9
 $ reps          : num 3
 $ treatments    : num 45
 $ locations     : num 1
 $ location_names: chr "FARGO"
 $ seed          : num 1244

 10 First observations of the data frame with the row_column field book: 
   ID LOCATION PLOT REP ROW COLUMN ENTRY TREATMENT
1   1    FARGO  101   1   1      1    30      G-30
6   2    FARGO  102   1   1      2    41      G-41
11  3    FARGO  103   1   1      3     5       G-5
16  4    FARGO  104   1   1      4    39      G-39
21  5    FARGO  105   1   1      5    22      G-22
26  6    FARGO  106   1   1      6    44      G-44
31  7    FARGO  107   1   1      7     9       G-9
36  8    FARGO  108   1   1      8    36      G-36
41  9    FARGO  109   1   1      9    11      G-11
2  10    FARGO  110   1   2      1     6       G-6</code></pre>
</div>
</div>
<p>The <code>row_column()</code> function returns a list consisting of all the information displayed in the output tabs in the FielDHub app: design information, plot layout, plot numbering, entries list, and field book. These are accessible by the <code>$</code> operator, i.e.&nbsp;<code>rcd$layoutRandom</code> or <code>rcd$fieldBook</code>.</p>
<p><code>rcd$fieldBook</code> is a list containing information about every plot in the field, with information about the location of the plot and the treatment in each plot. As seen in the output below, the field book has columns for <code>ID</code>, <code>LOCATION</code>, <code>PLOT</code>, <code>REP</code>, <code>ROW</code>, <code>COLUMN</code>, <code>ENTRY</code>, and <code>TREATMENT</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">field_book <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rcd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fieldBook</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(rcd<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>fieldBook, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ID LOCATION PLOT REP ROW COLUMN ENTRY TREATMENT
1   1    FARGO  101   1   1      1    30      G-30
6   2    FARGO  102   1   1      2    41      G-41
11  3    FARGO  103   1   1      3     5       G-5
16  4    FARGO  104   1   1      4    39      G-39
21  5    FARGO  105   1   1      5    22      G-22
26  6    FARGO  106   1   1      6    44      G-44
31  7    FARGO  107   1   1      7     9       G-9
36  8    FARGO  108   1   1      8    36      G-36
41  9    FARGO  109   1   1      9    11      G-11
2  10    FARGO  110   1   2      1     6       G-6</code></pre>
</div>
</div>
<p>For plotting the layout in function of the coordinates <code>ROW</code> and <code>COLUMN</code>, you can use the the generic function <code>plot()</code> as follows,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(rcd)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/row_column_design/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="analytical-techniques" class="level2">
<h2 class="anchored" data-anchor-id="analytical-techniques">Analytical Techniques</h2>
<p>The data from <code>row-column designs</code> are typically analyzed using mixed models or ANOVA, with row and column effects included as factors. Advanced statistical software like R (using packages such as <code>lme4</code>, <code>asreml</code>, <code>SpAtS</code>, and <code>statgenSTA</code>) and SAS provides robust tools for handling the complex data structures generated by these designs.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>Row-column design stands as a critical tool for plant breeders, ensuring that the evaluation of new plant genotypes is as accurate and reliable as possible. By effectively controlling spatial variation in field trials, this design not only improves the precision of experimental results but also aids in the selection and development of superior plant varieties. As agriculture continues to evolve, methodologies like the row-column design will remain essential in advancing our understanding and cultivation of crops.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2024,
  author = {Santos, Franklin},
  title = {Enhancing {Plant} {Breeding} {Precision} with {Row-Column}
    {Design}},
  date = {2024-05-26},
  url = {https://franklinsantosm.com/posts/row_column_design},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2024" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2024. <span>“Enhancing Plant Breeding Precision with
Row-Column Design.”</span> May 26, 2024. <a href="https://franklinsantosm.com/posts/row_column_design">https://franklinsantosm.com/posts/row_column_design</a>.
</div></div></section></div> ]]></description>
  <category>Row-Column</category>
  <category>Experimental Design</category>
  <category>Plant Breeding</category>
  <guid>https://franklinsantosm.com/posts/row_column_design/</guid>
  <pubDate>Sun, 26 May 2024 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/row_column_design/fs.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Un Viaje de Sueños: Camino a la Universidad Austral de Chile</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/chile/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="un-anhelo-que-cobra-vida" class="level2">
<h2 class="anchored" data-anchor-id="un-anhelo-que-cobra-vida"><strong>Un anhelo que cobra vida</strong></h2>
<p>Hace un año, mi vida transcurría entre las investigaciones del <code>Instituto Nacional de Innovación Agropecuaria y Forestal (INIAF)</code>. Sin embargo, un anhelo latía en mi interior: <strong>estudiar un posgrado en el extranjero</strong>. Este sueño se consolidó durante un viaje transformador a Corea del Sur, financiado por <a href="https://www.koica.go.kr/sites/koica_en/index.do">KOICA</a>, el Gobierno de Corea del Sur. Allí, mi determinación se afianzó y, al regresar, me dediqué a preparar meticulosamente mi postulación a la Beca <a href="https://www.agci.cl/">AGCID</a> de la Embajada de la República de Chile.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/chile/img.jpg" class="img-fluid figure-img"></p>
<figcaption>Franklin junto a Mustafa de Gambia</figcaption>
</figure>
</div>
</section>
<section id="un-sueño-hecho-realidad" class="level2">
<h2 class="anchored" data-anchor-id="un-sueño-hecho-realidad"><strong>Un sueño hecho realidad</strong></h2>
<p>Al cerrar el año 2023, llegó la noticia que cambiaría mi vida: ¡había sido seleccionado para cursar el Magíster en Ciencias Vegetales en la prestigiosa <a href="https://www.uach.cl/">Universidad Austral de Chile</a>! La emoción me invadió al dar el primer paso hacia esta nueva etapa académica.</p>
</section>
<section id="matriculación-y-agradecimiento" class="level2">
<h2 class="anchored" data-anchor-id="matriculación-y-agradecimiento"><strong>Matriculación y agradecimiento</strong></h2>
<p>Matriculado oficialmente en esta reconocida institución, siento un profundo agradecimiento por la oportunidad que se me presenta. La <strong>expectativa de sumergirme en el vasto campo de las ciencias vegetales</strong> despierta en mí una pasión insaciable por el conocimiento. La oportunidad de adquirir nuevas perspectivas y habilidades es un privilegio del que me siento profundamente agradecido.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/chile/qui.jpg" class="img-fluid figure-img"></p>
<figcaption>Facultad de Ciencias, donde tendré clases de Bioinformática aplicada a la transcriptómica</figcaption>
</figure>
</div>
</section>
<section id="un-honor-y-una-guía-invaluable" class="level2">
<h2 class="anchored" data-anchor-id="un-honor-y-una-guía-invaluable"><strong>Un honor y una guía invaluable</strong></h2>
<p>Contar con la Dra. <a href="https://www.wur.nl/en/persons/daniela-bustos-korts.htm">Daniela Bustos Korts</a> como mentora de tesis es un verdadero honor. Su <strong>trayectoria, que incluye un doctorado y postdoctorado en la <a href="https://www.wur.nl/en.htm">Universidad de Wageningen</a></strong>, sumada a su dedicación y experiencia, son una invaluable guía en mi camino académico. Estoy ansioso por aprender de ella y colaborar en este apasionante proyecto.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/chile/prof.jpg" class="img-fluid figure-img"></p>
<figcaption>Prof.&nbsp;Daniela Bustos y Franklin Santos</figcaption>
</figure>
</div>
</section>
<section id="reconocimiento-y-compromiso" class="level2">
<h2 class="anchored" data-anchor-id="reconocimiento-y-compromiso"><strong>Reconocimiento y compromiso</strong></h2>
<p>Quiero expresar mi sincero agradecimiento a la Beca AGCID Chile, cuyo apoyo ha hecho posible que continúe persiguiendo mis sueños académicos. Su respaldo es un pilar fundamental en este viaje, y estoy comprometido a aprovechar al máximo esta oportunidad.</p>
<p><img src="https://franklinsantosm.com/posts/chile/fs.jpg" class="img-fluid"></p>
</section>
<section id="un-desafío-con-entusiasmo-y-determinación" class="level2">
<h2 class="anchored" data-anchor-id="un-desafío-con-entusiasmo-y-determinación"><strong>Un desafío con entusiasmo y determinación</strong></h2>
<p>Estoy listo para abrazar este desafío con entusiasmo y determinación. ¡Aquí voy, Universidad Austral de Chile, listo para crecer, aprender y contribuir al fascinante mundo de las ciencias vegetales!</p>
</section>
<section id="agradecimiento-final-e-inspiración" class="level2">
<h2 class="anchored" data-anchor-id="agradecimiento-final-e-inspiración"><strong>Agradecimiento final e inspiración</strong></h2>
<p>Agradezco a Dios, a mi familia y amigos por su constante apoyo. Que esta pequeña historia inspire a otros profesionales a perseguir sus sueños académicos en el extranjero. Recuerden: <strong>donde hay voluntad, hay camino</strong>, y con la guía divina, los límites son solo el comienzo de nuevas posibilidades. ¡Adelante, valientes aspirantes al mundo de las ciencias!</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2024,
  author = {Santos, Franklin},
  title = {Un {Viaje} de {Sueños:} {Camino} a La {Universidad} {Austral}
    de {Chile}},
  date = {2024-04-04},
  url = {https://franklinsantosm.com/posts/chile},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2024" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2024. <span>“Un Viaje de Sueños: Camino a La
Universidad Austral de Chile.”</span> April 4, 2024. <a href="https://franklinsantosm.com/posts/chile">https://franklinsantosm.com/posts/chile</a>.
</div></div></section></div> ]]></description>
  <category>Scholarship</category>
  <category>Master Science</category>
  <category>AGCID Chile</category>
  <guid>https://franklinsantosm.com/posts/chile/</guid>
  <pubDate>Thu, 04 Apr 2024 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/chile/fs.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Exploring the Frontier: Artificial Intelligence in Molecular Plant Breeding Data Science</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/PB_AI/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In the realm of molecular plant breeding, where the intricate dance of genes and environment shapes the future of agriculture, the integration of Artificial Intelligence (AI) has emerged as a transformative force. As we stand at the intersection of biology and technology, the marriage of advanced methodologies with AI presents unprecedented opportunities to revolutionize how we understand, manipulate, and optimize plant genomes for improved traits and yield.</p>
</section>
<section id="advanced-methodologies" class="level2">
<h2 class="anchored" data-anchor-id="advanced-methodologies">Advanced Methodologies</h2>
<p>In recent years, advanced methodologies fueled by AI have catalyzed groundbreaking progress in molecular plant breeding:</p>
<ol type="1">
<li><p><strong>Genomic Selection (GS)</strong>: AI algorithms have revolutionized GS by enabling the prediction of plant traits based on genomic information. Through machine learning models trained on vast genomic datasets coupled with phenotypic data, breeders can now identify promising plant varieties much earlier in the breeding cycle, accelerating the development of high-yielding, stress-tolerant crops.</p></li>
<li><p><strong>Phenomics and High-Throughput Phenotyping</strong>: The integration of AI-powered image analysis and sensor technologies has empowered researchers to capture detailed phenotypic data on an unprecedented scale. From leaf morphology to root architecture, AI algorithms can extract valuable insights from complex phenotypic datasets, facilitating the identification of key traits for crop improvement with remarkable precision and efficiency.</p></li>
<li><p><strong>Genome Editing and CRISPR-Cas9</strong>: AI-driven algorithms play a pivotal role in guiding the design and optimization of CRISPR-Cas9 gene editing systems. Through computational modeling and machine learning techniques, researchers can predict the outcomes of gene edits with greater accuracy, enabling targeted modifications of plant genomes to enhance traits such as disease resistance, nutritional content, and environmental adaptability.</p></li>
<li><p><strong>Data Integration and Multidimensional Analysis</strong>: With the proliferation of omics technologies, molecular plant breeding generates vast amounts of heterogeneous data encompassing genomics, transcriptomics, metabolomics, and beyond. AI-driven approaches, including deep learning and network analysis, enable the integration of diverse omics datasets, unveiling intricate molecular networks and uncovering novel gene interactions underlying complex traits.</p></li>
</ol>
</section>
<section id="future-perspectives" class="level2">
<h2 class="anchored" data-anchor-id="future-perspectives">Future Perspectives</h2>
<p>Looking ahead, the future of AI in molecular plant breeding data science holds immense promise and potential:</p>
<ol type="1">
<li><p><strong>Precision Breeding and Trait Stacking</strong>: AI algorithms will continue to refine our ability to precisely manipulate plant genomes, facilitating the targeted introduction and stacking of desirable traits with unprecedented accuracy and efficiency. From drought tolerance to nutrient efficiency, AI-driven breeding strategies will enable the development of tailored crop varieties optimized for diverse environmental conditions and agricultural practices.</p></li>
<li><p><strong>Harnessing Genetic Diversity</strong>: AI-powered analytics will unlock the full potential of genetic diversity harbored within plant germplasm collections, empowering breeders to explore and exploit novel alleles and genetic variants for crop improvement. By leveraging machine learning algorithms to dissect complex genotype-phenotype relationships, researchers can uncover hidden genetic treasures that hold the key to unlocking yield gains and resilience in the face of emerging biotic and abiotic stresses.</p></li>
<li><p><strong>Sustainable Agriculture and Climate Resilience</strong>: AI-driven approaches will play a pivotal role in addressing the urgent challenges posed by climate change and global food security. By deciphering the complex interactions between genotype, phenotype, and environment, AI models can guide the development of climate-resilient crop varieties tailored to thrive in changing climatic conditions while minimizing environmental impact and resource inputs.</p></li>
</ol>
<p>In conclusion, the integration of Artificial Intelligence into molecular plant breeding data science heralds a new era of innovation and possibility. By harnessing the power of AI-driven methodologies, we are poised to unlock the full potential of plant genomes, ushering in a greener, more sustainable agricultural future for generations to come. As we embark on this transformative journey, let us embrace the boundless opportunities that AI affords us to shape a world where crops are not just plants, but living solutions to the grand challenges of our time.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2024,
  author = {Santos, Franklin},
  title = {Exploring the {Frontier:} {Artificial} {Intelligence} in
    {Molecular} {Plant} {Breeding} {Data} {Science}},
  date = {2024-01-25},
  url = {https://franklinsantosm.com/posts/PB_AI},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2024" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2024. <span>“Exploring the Frontier: Artificial
Intelligence in Molecular Plant Breeding Data Science.”</span> January
25, 2024. <a href="https://franklinsantosm.com/posts/PB_AI">https://franklinsantosm.com/posts/PB_AI</a>.
</div></div></section></div> ]]></description>
  <category>AI</category>
  <category>Plant Breeding</category>
  <category>Genomic Selection</category>
  <guid>https://franklinsantosm.com/posts/PB_AI/</guid>
  <pubDate>Thu, 25 Jan 2024 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/PB_AI/F1.png" medium="image" type="image/png" height="85" width="144"/>
</item>
<item>
  <title>Explorando el Mundo de la Estadística: Frecuentista vs. Bayesiana</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/introbayes/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>La estadística es el arte y la ciencia de extraer conocimiento a partir de datos, y dos enfoques principales han moldeado el campo a lo largo del tiempo: el frecuentista y el bayesiano. En este viaje, exploraremos las profundidades de la estadística bayesiana, comparándola con su contraparte frecuentista y destacando las características distintivas de cada enfoque.</p>
</section>
<section id="estadística-bayesiana-más-que-probabilidades-creencias-en-acción" class="level2">
<h2 class="anchored" data-anchor-id="estadística-bayesiana-más-que-probabilidades-creencias-en-acción">Estadística Bayesiana: Más que Probabilidades, Creencias en Acción</h2>
<p>La estadística bayesiana se basa en el teorema de Bayes, una herramienta poderosa que nos permite actualizar nuestras creencias a medida que nuevos datos emergen. En este enfoque, la probabilidad se interpreta como una medida subjetiva de creencia, lo que significa que incorporamos nuestro conocimiento previo (a priori) al análisis. Esta flexibilidad es clave, ya que nos permite abordar problemas con muestras pequeñas y aprovechar la información previa de manera efectiva.</p>
<p><strong>El Teorema de Bayes en Acción:</strong></p>
<p><img src="https://latex.codecogs.com/png.latex?%0AP(H%7CE)%20=%20%5Cfrac%7BP(E%7CH)%20%5Ccdot%20P(H)%7D%7BP(E)%7D%0A"> donde:</p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?P(H%E2%88%A3E)"> es la probabilidad posterior de la hipótesis <img src="https://latex.codecogs.com/png.latex?H"> dado el conjunto de evidencia <img src="https://latex.codecogs.com/png.latex?E">.</li>
<li><img src="https://latex.codecogs.com/png.latex?P(E%E2%88%A3H)"> es la verosimilitud de la evidencia <img src="https://latex.codecogs.com/png.latex?E"> bajo la hipótesis <img src="https://latex.codecogs.com/png.latex?H">.</li>
<li><img src="https://latex.codecogs.com/png.latex?P(H)"> es la probabilidad a priori de la hipótesis <img src="https://latex.codecogs.com/png.latex?H">.</li>
<li><img src="https://latex.codecogs.com/png.latex?P(E)"> es la probabilidad marginal de la evidencia <img src="https://latex.codecogs.com/png.latex?E">.</li>
</ul>
<p>Este simple pero poderoso teorema nos guía en la actualización de nuestras creencias sobre una hipótesis <img src="https://latex.codecogs.com/png.latex?H"> dado un conjunto de evidencia <img src="https://latex.codecogs.com/png.latex?E">. Ahora, comparemos esto con el enfoque frecuentista.</p>
</section>
<section id="estadística-frecuentista-frente-a-la-incertidumbre-con-la-variabilidad-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="estadística-frecuentista-frente-a-la-incertidumbre-con-la-variabilidad-de-los-datos">Estadística Frecuentista: Frente a la Incertidumbre con la Variabilidad de los Datos</h2>
<p>Los estadísticos frecuentistas se centran en la frecuencia relativa de los eventos observados a lo largo del tiempo. La incertidumbre se maneja reconociendo la variabilidad inherente de los datos. Este enfoque es robusto y ha sido la columna vertebral de la estadística tradicional durante décadas.</p>
<p><strong>Estimaciones Puntuales y Pruebas de Hipótesis:</strong></p>
<p>Los frecuentistas tienden a buscar estimaciones puntuales y realizar pruebas de hipótesis para tomar decisiones. Sin embargo, este enfoque puede volverse limitado cuando se trata de manejar la incertidumbre de manera más integral.</p>
</section>
<section id="dónde-reside-la-diferencia" class="level2">
<h2 class="anchored" data-anchor-id="dónde-reside-la-diferencia">¿Dónde Reside la Diferencia?</h2>
<section id="incorporación-de-información-previa" class="level3">
<h3 class="anchored" data-anchor-id="incorporación-de-información-previa">1. Incorporación de Información Previa</h3>
<p><strong>Bayesiana:</strong> La información a priori se considera esencial. Antes de analizar los datos, se incorpora el conocimiento existente, lo que es especialmente útil en escenarios con muestras pequeñas.</p>
<p><strong>Frecuentista:</strong> No se utiliza información a priori. La inferencia se basa únicamente en los datos observados sin tener en cuenta conocimientos previos.</p>
</section>
<section id="tamaño-de-la-muestra-y-flexibilidad" class="level3">
<h3 class="anchored" data-anchor-id="tamaño-de-la-muestra-y-flexibilidad">2. Tamaño de la Muestra y Flexibilidad</h3>
<p><strong>Bayesiana:</strong> Adaptable a tamaños de muestra variables, lo que permite realizar inferencias incluso con conjuntos de datos más pequeños.</p>
<p><strong>Frecuentista:</strong> A menudo requiere grandes muestras para producir estimaciones precisas y realizar pruebas de hipótesis robustas.</p>
</section>
<section id="enfoque-para-la-toma-de-decisiones" class="level3">
<h3 class="anchored" data-anchor-id="enfoque-para-la-toma-de-decisiones">3. Enfoque para la Toma de Decisiones</h3>
<p><strong>Bayesiana:</strong> Ofrece distribuciones de probabilidad completas, permitiendo una toma de decisiones más informada bajo diversas condiciones de incertidumbre.</p>
<p><strong>Frecuentista:</strong> Se centra en estimaciones puntuales y pruebas de hipótesis, lo que podría no proporcionar una imagen completa de la incertidumbre.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>La estadística bayesiana ofrece una perspectiva moderna y flexible para el análisis de datos, permitiendo a los investigadores incorporar información previa de manera sistemática y actualizar sus creencias a medida que se obtiene nueva evidencia. Si bien tanto los métodos frecuentistas como los bayesianos tienen sus propias fortalezas y limitaciones, la elección entre ellos a menudo depende de la naturaleza de los datos y las preguntas de investigación específicas.</p>
<p>En resumen, la estadística bayesiana nos invita a pensar en la probabilidad y la incertidumbre de una manera diferente, abriendo nuevas posibilidades para la exploración y el descubrimiento en el mundo de la estadística y la ciencia de datos.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {Explorando El {Mundo} de La {Estadística:} {Frecuentista} Vs.
    {Bayesiana}},
  date = {2023-12-25},
  url = {https://franklinsantosm.com/posts/introbayes},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“Explorando El Mundo de La Estadística:
Frecuentista Vs. Bayesiana.”</span> December 25, 2023. <a href="https://franklinsantosm.com/posts/introbayes">https://franklinsantosm.com/posts/introbayes</a>.
</div></div></section></div> ]]></description>
  <category>Bayesian</category>
  <category>Statistic</category>
  <category>Bayes</category>
  <guid>https://franklinsantosm.com/posts/introbayes/</guid>
  <pubDate>Mon, 25 Dec 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/introbayes/bayes.png" medium="image" type="image/png" height="93" width="144"/>
</item>
<item>
  <title>FAMD - Factor Analysis of Mixed Data in R</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/MDA/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Factor Analysis of Mixed Data (FAMD) is a powerful statistical technique used to analyze datasets that contain both numerical and categorical variables. It extends traditional factor analysis to handle mixed data types, providing a comprehensive understanding of the underlying structure of complex datasets. In this blog post, we will delve into the essentials of FAMD, exploring its computation, R packages, data format, R code, visualization, and interpretation.</p>
</section>
<section id="computation" class="level2">
<h2 class="anchored" data-anchor-id="computation">Computation</h2>
<p>FAMD combines multiple techniques, such as Principal Component Analysis (PCA) for numerical variables and Multiple Correspondence Analysis (MCA) for categorical variables. The integration of these methods allows FAMD to effectively capture the relationships between variables and reveal underlying patterns in mixed datasets.</p>
<section id="r-packages" class="level3">
<h3 class="anchored" data-anchor-id="r-packages">R Packages</h3>
<p>To perform FAMD in R, the <code>FactoMineR</code> and <code>factoextra</code> package are widely used and offers a dedicated function for FAMD. Ensure that you have the package installed by running:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FactoMineR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"factoextra"</span>))</span></code></pre></div>
</div>
<p>load packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(FactoMineR)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(factoextra)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
</div>
</section>
<section id="data-format" class="level3">
<h3 class="anchored" data-anchor-id="data-format">Data Format</h3>
<p>Before applying FAMD, it’s crucial to prepare your data appropriately. Ensure that your dataset contains both numerical and categorical variables. Standardize numerical variables if necessary and encode categorical variables properly.</p>
<p>We’ll use a subset of the <code>wine</code> data set available in <code>FactoMineR</code> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FactoMineR"</span>)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(wine)</span>
<span id="cb5-3">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> wine[,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">31</span>)]</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(df[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Label Soil Plante Acidity Harmony Intensity Overall.quality
2EL      Saumur Env1  2.000   2.107   3.143     2.857           3.393
1CHA     Saumur Env1  2.000   2.107   2.964     2.893           3.214
1FON Bourgueuil Env1  1.750   2.179   3.143     3.074           3.536
1VAU     Chinon Env2  2.304   3.179   2.038     2.462           2.464</code></pre>
</div>
</div>
<p>To see the structure of the data, type this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   21 obs. of  8 variables:
 $ Label          : Factor w/ 3 levels "Saumur","Bourgueuil",..: 1 1 2 3 1 2 2 1 3 1 ...
 $ Soil           : Factor w/ 4 levels "Reference","Env1",..: 2 2 2 3 1 1 1 2 2 3 ...
 $ Plante         : num  2 2 1.75 2.3 1.76 ...
 $ Acidity        : num  2.11 2.11 2.18 3.18 2.57 ...
 $ Harmony        : num  3.14 2.96 3.14 2.04 3.64 ...
 $ Intensity      : num  2.86 2.89 3.07 2.46 3.64 ...
 $ Overall.quality: num  3.39 3.21 3.54 2.46 3.74 ...
 $ Typical        : num  3.25 3.04 3.18 2.25 3.44 ...</code></pre>
</div>
</div>
<p>The data contains 21 rows (wines, <code>individuals</code>) and 8 columns (<code>variables</code>):</p>
<ul>
<li>The first two columns are factors (<code>categorical variables</code>): <code>label</code> (Saumur, Bourgueil or Chinon) and <code>soil</code> (Reference, Env1, Env2 or Env4).</li>
<li>The remaining columns are numeric (<code>continuous variables</code>).</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>The goal of this study is to analyze the characteristics of the wines.</p>
</div>
</div>
</section>
</section>
<section id="r-code" class="level2">
<h2 class="anchored" data-anchor-id="r-code">R Code</h2>
<p>The function <code>FAMD()</code> [FactoMiner package] can be used to compute FAMD. A simplified format is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FAMD</span> (base, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sup.var =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ind.sup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">graph =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
<ul>
<li><code>base</code>: a data frame with n rows (individuals) and p columns (variables).</li>
<li><code>ncp</code>: the number of dimensions kept in the results (by default 5)</li>
<li><code>sup.var</code>: a vector indicating the indexes of the supplementary variables.</li>
<li><code>ind.sup</code>: a vector indicating the indexes of the supplementary individuals.</li>
<li><code>graph</code>: a logical value. If TRUE a graph is displayed.</li>
</ul>
<p>To compute FAMD, type this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(FactoMineR)</span>
<span id="cb10-2">res.famd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FAMD</span>(df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">graph =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</div>
<p>The output of the <code>FAMD()</code> function is a list including:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(res.famd)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>*The results are available in the following objects:

  name          description                             
1 "$eig"        "eigenvalues and inertia"               
2 "$var"        "Results for the variables"             
3 "$ind"        "results for the individuals"           
4 "$quali.var"  "Results for the qualitative variables" 
5 "$quanti.var" "Results for the quantitative variables"</code></pre>
</div>
</div>
<section id="visualization-and-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="visualization-and-interpretation">Visualization and Interpretation</h3>
<p>We’ll use the following <strong><em>factoextra</em></strong> functions:</p>
<ul>
<li><code>get_eigenvalue(res.famd)</code>: Extract the eigenvalues/variances retained by each dimension (axis).</li>
<li><code>fviz_eig(res.famd)</code>: Visualize the eigenvalues/variances.</li>
<li><code>get_famd_ind(res.famd)</code>: Extract the results for individuals.</li>
<li><code>get_famd_var(res.famd)</code>: Extract the results for quantitative and qualitative variables.</li>
<li><code>fviz_famd_ind(res.famd)</code>, <code>fviz_famd_var(res.famd)</code>: Visualize the results for individuals and variables, respectively.</li>
</ul>
<p>In the next sections, we’ll illustrate each of these functions.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>To help in the interpretation of FAMD, we highly recommend to read the interpretation of principal component analysis (Chapter (???)(principal-component-analysis)) and multiple correspondence analysis (Chapter (???)(multiple-correspondence-analysis)). Many of the graphs presented here have been already described in our previous chapters.</p>
</div>
</div>
</section>
<section id="eigenvalues-variances" class="level3">
<h3 class="anchored" data-anchor-id="eigenvalues-variances">Eigenvalues / Variances</h3>
<p>The proportion of variances retained by the different dimensions (axes) can be extracted using the function <code>get_eigenvalue()</code> [factoextra package] as follow:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"factoextra"</span>)</span>
<span id="cb13-2">eig.val <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_eigenvalue</span>(res.famd)</span>
<span id="cb13-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(eig.val)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      eigenvalue variance.percent cumulative.variance.percent
Dim.1  4.8315174        43.922886                    43.92289
Dim.2  1.8568797        16.880724                    60.80361
Dim.3  1.5824794        14.386176                    75.18979
Dim.4  1.1491200        10.446546                    85.63633
Dim.5  0.6518053         5.925503                    91.56183</code></pre>
</div>
</div>
<p>The function fviz_eig() or fviz_screeplot() [factoextra package] can be used to draw the scree plot (the percentages of inertia explained by each FAMD dimensions):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_screeplot</span>(res.famd)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="graph-of-variables" class="level3">
<h3 class="anchored" data-anchor-id="graph-of-variables">Graph of Variables</h3>
<section id="all-variables" class="level4">
<h4 class="anchored" data-anchor-id="all-variables">All variables</h4>
<p>The function <code>get_mfa_var()</code> [in <strong><em>factoextra</em></strong>] is used to extract the results for variables. By default, this function returns a list containing the coordinates, the cos2 and the contribution of all variables:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_famd_var</span>(res.famd)</span>
<span id="cb16-2">var</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FAMD results for variables 
 ===================================================
  Name       Description                      
1 "$coord"   "Coordinates"                    
2 "$cos2"    "Cos2, quality of representation"
3 "$contrib" "Contributions"                  </code></pre>
</div>
</div>
<p>The different components can be accessed as follow:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Coordinates of variables</span></span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>coord)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Dim.1       Dim.2       Dim.3       Dim.4        Dim.5
Plante          0.7344160 0.060551966 0.105902048 0.004011299 0.0010340559
Acidity         0.1732738 0.491118153 0.126394029 0.115376784 0.0045862935
Harmony         0.8943968 0.023628146 0.040124469 0.003653813 0.0086624633
Intensity       0.6991811 0.134639254 0.065382234 0.023214984 0.0064730431
Overall.quality 0.9115699 0.005246728 0.009336677 0.005445276 0.0007961880
Typical         0.7808611 0.027094327 0.001549791 0.083446627 0.0005912942</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Cos2: quality of representation on the factore map</span></span>
<span id="cb20-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cos2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Dim.1        Dim.2        Dim.3        Dim.4        Dim.5
Plante          0.53936692 3.666541e-03 1.121524e-02 1.609052e-05 1.069272e-06
Acidity         0.03002381 2.411970e-01 1.597545e-02 1.331180e-02 2.103409e-05
Harmony         0.79994566 5.582893e-04 1.609973e-03 1.335035e-05 7.503827e-05
Intensity       0.48885427 1.812773e-02 4.274836e-03 5.389355e-04 4.190029e-05
Overall.quality 0.83095973 2.752815e-05 8.717353e-05 2.965103e-05 6.339153e-07
Typical         0.60974400 7.341026e-04 2.401853e-06 6.963340e-03 3.496288e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Contributions to the  dimensions</span></span>
<span id="cb22-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>contrib)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Dim.1      Dim.2      Dim.3      Dim.4      Dim.5
Plante          15.200526  3.2609526 6.69215972  0.3490757 0.15864490
Acidity          3.586323 26.4485720 7.98708850 10.0404466 0.70362936
Harmony         18.511716  1.2724651 2.53554453  0.3179662 1.32899551
Intensity       14.471254  7.2508336 4.13163258  2.0202401 0.99309457
Overall.quality 18.867156  0.2825562 0.59000304  0.4738648 0.12215119
Typical         16.161818  1.4591321 0.09793437  7.2617850 0.09071638</code></pre>
</div>
</div>
<p>The following figure shows the correlation between variables - both quantitative and qualitative variables - and the principal dimensions, as well as, the contribution of variables to the dimensions 1 and 2. The following functions [in the factoextra package] are used:</p>
<ul>
<li><code>fviz_famd_var()</code> to plot both quantitative and qualitative variables</li>
<li><code>fviz_contrib()</code> to visualize the contribution of variables to the principal dimensions</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot of variables</span></span>
<span id="cb24-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_famd_var</span>(res.famd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Contribution to the first dimension</span></span>
<span id="cb25-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_contrib</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"var"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Contribution to the second dimension</span></span>
<span id="cb26-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_contrib</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"var"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The red dashed line on the graph above indicates the expected average value, If the contributions were uniform. Read more in chapter (Chapter <span class="citation" data-cites="ref">@ref</span>(principal-component-analysis)).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>From the plots above, it can be seen that: - variables that contribute the most to the first dimension are: Overall.quality and Harmony. - variables that contribute the most to the second dimension are: Soil and Acidity.</p>
</div>
</div>
</section>
<section id="quantitative-variables" class="level4">
<h4 class="anchored" data-anchor-id="quantitative-variables">Quantitative variables</h4>
<p>To extract the results for quantitative variables, type this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">quanti.var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_famd_var</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quanti.var"</span>)</span>
<span id="cb27-2">quanti.var</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FAMD results for quantitative variables 
 ===================================================
  Name       Description                      
1 "$coord"   "Coordinates"                    
2 "$cos2"    "Cos2, quality of representation"
3 "$contrib" "Contributions"                  </code></pre>
</div>
</div>
<p>In this section, we’ll describe how to visualize quantitative variables. Additionally, we’ll show how to highlight variables according to either i) their quality of representation on the factor map or ii) their contributions to the dimensions.</p>
<p>The R code below plots quantitative variables. We use repel = TRUE, to avoid text overlapping.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_famd_var</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quanti.var"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb29-2">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Briefly, the graph of variables (correlation circle) shows the relationship between variables, the quality of the representation of variables, as well as, the correlation between variables and the dimensions. Read more at PCA (Chapter <span class="citation" data-cites="ref">@ref</span>(principal-component-analysis)), MCA (Chapter <span class="citation" data-cites="ref">@ref</span>(multiple-correspondence-analysis)) and MFA (Chapter <span class="citation" data-cites="ref">@ref</span>(multiple-factor-analysis)).</p>
<p>The most contributing quantitative variables can be highlighted on the scatter plot using the argument <code>col.var = "contrib"</code>. This produces a gradient colors, which can be customized using the argument <code>gradient.cols</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_famd_var</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quanti.var"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"contrib"</span>, </span>
<span id="cb30-2">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gradient.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00AFBB"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E7B800"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FC4E07"</span>),</span>
<span id="cb30-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Similarly, you can highlight quantitative variables using their cos2 values representing the quality of representation on the factor map. If a variable is well represented by two dimensions, the sum of the cos2 is closed to one. For some of the items, more than 2 dimensions might be required to perfectly represent the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Color by cos2 values: quality on the factor map</span></span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_famd_var</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quanti.var"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cos2"</span>,</span>
<span id="cb31-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gradient.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00AFBB"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E7B800"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FC4E07"</span>), </span>
<span id="cb31-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="graph-of-qualitative-variables" class="level4">
<h4 class="anchored" data-anchor-id="graph-of-qualitative-variables">Graph of qualitative variables</h4>
<p>Like quantitative variables, the results for qualitative variables can be extracted as follow:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1">quali.var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_famd_var</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quali.var"</span>)</span>
<span id="cb32-2">quali.var</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FAMD results for qualitative variable categories 
 ===================================================
  Name       Description                      
1 "$coord"   "Coordinates"                    
2 "$cos2"    "Cos2, quality of representation"
3 "$contrib" "Contributions"                  </code></pre>
</div>
</div>
<p>To visualize qualitative variables, type this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_famd_var</span>(res.famd, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quali.var"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"contrib"</span>, </span>
<span id="cb34-2">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gradient.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00AFBB"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E7B800"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FC4E07"</span>)</span>
<span id="cb34-3">             )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot above shows the categories of the categorical variables.</p>
</section>
<section id="graph-of-individuals" class="level4">
<h4 class="anchored" data-anchor-id="graph-of-individuals">Graph of individuals</h4>
<p>To get the results for individuals, type this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">ind <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_famd_ind</span>(res.famd)</span>
<span id="cb35-2">ind</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>FAMD results for individuals 
 ===================================================
  Name       Description                      
1 "$coord"   "Coordinates"                    
2 "$cos2"    "Cos2, quality of representation"
3 "$contrib" "Contributions"                  </code></pre>
</div>
</div>
<p>To plot individuals, use the function <code>fviz_mfa_ind()</code> [in factoextra]. By default, individuals are colored in blue. However, like variables, it’s also possible to color individuals by their cos2 and contribution values:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_famd_ind</span>(res.famd, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.ind =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cos2"</span>, </span>
<span id="cb37-2">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gradient.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00AFBB"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E7B800"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FC4E07"</span>),</span>
<span id="cb37-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the plot above, the qualitative variable categories are shown in black. Env1, Env2, Env3 are the categories of the soil. Saumur, Bourgueuil and Chinon are the categories of the wine Label. If you don’t want to show them on the plot, use the argument <code>invisible = "quali.var"</code>.</p>
</div>
</div>
<p>Individuals with similar profiles are close to each other on the factor map. For the interpretation, read more at Chapter <span class="citation" data-cites="ref">@ref</span>(multiple-correspondence-analysis) (MCA) and Chapter <span class="citation" data-cites="ref">@ref</span>(multiple-factor-analysis) (MFA).</p>
<p>Note that, it’s possible to color the individuals using any of the qualitative variables in the initial data table. To do this, the argument <code>habillage</code> is used in the <code>fviz_famd_ind()</code> function. For example, if you want to color the wines according to the supplementary qualitative variable “Label”, type this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_mfa_ind</span>(res.famd, </span>
<span id="cb38-2">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">habillage =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Label"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># color by groups </span></span>
<span id="cb38-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00AFBB"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E7B800"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FC4E07"</span>),</span>
<span id="cb38-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">addEllipses =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ellipse.type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>, </span>
<span id="cb38-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Avoid text overlapping</span></span>
<span id="cb38-6">             ) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>If you want to color individuals using multiple categorical variables at the same time, use the function fviz_ellipses() [in factoextra] as follow:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_ellipses</span>(res.famd, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Label"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Soil"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `gather_()` was deprecated in tidyr 1.2.0.
ℹ Please use `gather()` instead.
ℹ The deprecated feature was likely used in the factoextra package.
  Please report the issue at &lt;https://github.com/kassambara/factoextra/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Alternatively, you can specify categorical variable indices:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_ellipses</span>(res.famd, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"point"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/MDA/index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>Factor Analysis of Mixed Data (FAMD) is a versatile tool for analyzing datasets with a mix of numerical and categorical variables. Through the ‘FactoMineR’ package in R, users can seamlessly perform FAMD, gaining valuable insights into the underlying structure of their data. By visualizing eigenvalues, variable contributions, and individual distributions, researchers can interpret complex relationships and make informed decisions based on the extracted factors. Incorporate FAMD into your analytical toolkit to unlock the full potential of mixed data analysis.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {FAMD - {Factor} {Analysis} of {Mixed} {Data} in {R}},
  date = {2023-11-29},
  url = {https://franklinsantosm.com/posts/MDA},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“FAMD - Factor Analysis of Mixed Data in
R.”</span> November 29, 2023. <a href="https://franklinsantosm.com/posts/MDA">https://franklinsantosm.com/posts/MDA</a>.
</div></div></section></div> ]]></description>
  <category>FAMD</category>
  <category>FactoMineR</category>
  <category>factoextra</category>
  <guid>https://franklinsantosm.com/posts/MDA/</guid>
  <pubDate>Wed, 29 Nov 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/MDA/plot.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Unveiling the Power of Completely Randomized Design (CRD) in Crop Science Experiments</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/crd/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="unveiling-the-power-of-completely-randomized-design-crd-in-crop-science-experiments" class="level1">
<h1>Unveiling the Power of Completely Randomized Design (CRD) in Crop Science Experiments</h1>
<p>In the vast expanse of crop science, where precision and reliability are paramount, the choice of experimental design plays a pivotal role in unlocking the secrets of optimal crop growth. Among the arsenal of experimental methodologies, the Completely Randomized Design (CRD) emerges as a beacon of simplicity and statistical robustness. In this blog, we embark on a journey into the realm of CRD, unraveling its principles, applications, and the advantages it brings to the forefront of crop science research.</p>
<section id="understanding-crd-a-statistical-marvel" class="level2">
<h2 class="anchored" data-anchor-id="understanding-crd-a-statistical-marvel"><strong>Understanding CRD: A Statistical Marvel</strong></h2>
<p><strong>What is Completely Randomized Design (CRD)?</strong></p>
<p>CRD is a statistical method that serves as a robust tool for comparing the effects of different treatments on a single factor within crop experiments. It operates on the principle of randomness, ensuring that each experimental unit has an equal and unbiased chance of receiving any treatment. This randomization process is pivotal, eradicating potential biases and attributing observed crop responses solely to the applied treatments.</p>
<p><strong>When to Use CRD:</strong></p>
<p>CRD finds its niche in situations where experimental units are relatively homogenous, and there are no discernible patterns of variability within the experimental area. It is particularly valuable in small-scale or preliminary studies, where the primary objective is to gather initial data, identify trends, and pave the way for more intricate experimental designs.</p>
</section>
<section id="conducting-a-crd-experiment-steps-unveiled" class="level2">
<h2 class="anchored" data-anchor-id="conducting-a-crd-experiment-steps-unveiled"><strong>Conducting a CRD Experiment: Steps Unveiled</strong></h2>
<ol type="1">
<li><strong>Define the Research Question and Identify Treatments:</strong>
<ul>
<li>Begin by articulating the research question you aim to answer. Identify the treatments relevant to the research question, laying the groundwork for a focused and purposeful experiment.</li>
</ul></li>
<li><strong>Prepare the Experimental Area:</strong>
<ul>
<li>Select a uniform experimental site, ensuring consistency in soil conditions, topography, and other relevant factors. Divide the area into individual experimental units of equal size to maintain comparability.</li>
</ul></li>
<li><strong>Label the Experimental Units:</strong>
<ul>
<li>Assign unique identifiers to each experimental unit. This step facilitates tracking and systematic data recording throughout the experiment.</li>
</ul></li>
<li><strong>Randomly Assign Treatments:</strong>
<ul>
<li>Utilize a random number generator or a randomizing device to assign treatments to experimental units. This step ensures an unbiased distribution of treatments, a key feature of CRD.</li>
</ul></li>
<li><strong>Apply Treatments:</strong>
<ul>
<li>Implement the assigned treatments to the respective experimental units. Keep accurate records of application dates, quantities, and methods to maintain precision in data collection.</li>
</ul></li>
<li><strong>Collect Data:</strong>
<ul>
<li>Regularly monitor the experimental units, collecting pertinent data on crop growth, yield, and any other relevant parameters. Consistent and systematic data collection is crucial for the success of the experiment.</li>
</ul></li>
<li><strong>Analyze the Data:</strong>
<ul>
<li>Employ appropriate statistical methods to analyze the collected data. Determine whether there are significant differences in crop responses among the different treatment groups, providing valuable insights into the effectiveness of each treatment.</li>
</ul></li>
</ol>
</section>
<section id="advantages-of-crd-unraveling-simplicity-and-robustness" class="level2">
<h2 class="anchored" data-anchor-id="advantages-of-crd-unraveling-simplicity-and-robustness"><strong>Advantages of CRD: Unraveling Simplicity and Robustness</strong></h2>
<p><strong>Simplicity:</strong> CRD’s conceptual straightforwardness and ease of implementation make it accessible to researchers of varying experience levels. Its simplicity is a virtue that expedites the experimental process without compromising reliability.</p>
<p><strong>Flexibility:</strong> CRD’s adaptability shines through, accommodating a wide range of experimental setups. This flexibility allows researchers to explore various factors and treatment combinations, offering versatility in experimental design.</p>
<p><strong>Statistical Efficiency:</strong> By providing a statistically sound basis for comparing treatments, CRD ensures that conclusions drawn from the experiment are valid and reliable. This statistical efficiency is critical for making informed decisions based on experimental outcomes.</p>
<p><strong>Wide Applicability:</strong> CRD’s versatility extends across different crop types and experimental environments, making it a valuable tool for crop scientists working in diverse agricultural landscapes.</p>
</section>
<section id="applications-of-crd-in-crop-science-navigating-agricultural-frontiers" class="level2">
<h2 class="anchored" data-anchor-id="applications-of-crd-in-crop-science-navigating-agricultural-frontiers"><strong>Applications of CRD in Crop Science: Navigating Agricultural Frontiers</strong></h2>
<p>CRD has found widespread application in various facets of crop science research, including:</p>
<ul>
<li><strong>Evaluating Fertilizer Effectiveness:</strong>
<ul>
<li>CRD is instrumental in assessing the impact of different fertilizer rates and application methods on crop yield and nutrient utilization efficiency.</li>
</ul></li>
<li><strong>Comparing Crop Varieties:</strong>
<ul>
<li>Researchers leverage CRD to compare the performance of various crop varieties under different environmental conditions, aiding in the selection of optimal cultivars.</li>
</ul></li>
<li><strong>Optimizing Irrigation Practices:</strong>
<ul>
<li>CRD facilitates investigations into the effects of different irrigation regimes on crop yield and water use efficiency, contributing to water conservation efforts.</li>
</ul></li>
<li><strong>Exploring Tillage Practices:</strong>
<ul>
<li>Researchers delve into the effects of different tillage practices on soil health and crop productivity, using CRD as a systematic approach to experimentation.</li>
</ul></li>
</ul>
<p>In essence, CRD serves as a linchpin for crop scientists, offering a systematic and statistically sound approach to experimentation. Through its application, researchers generate reliable data that not only informs agricultural practices but also contributes to the broader understanding of crop dynamics, fostering innovation and sustainability in the realm of crop science.</p>
<p>The fields of green are not just a canvas for growth; they are a stage for scientific inquiry, and CRD takes center stage in unraveling the intricacies of crop science.</p>
</section>
</section>
<section id="mastering-completely-randomized-design-crd-analysis-with-agror-package" class="level1">
<h1>Mastering Completely Randomized Design (CRD) Analysis with AgroR package</h1>
<p>Conducting a thorough analysis of Completely Randomized Design (CRD) experiments in crop science can be a powerful tool for understanding treatment effects. Utilizing the AgroR package in R, you can navigate through the analysis seamlessly. Follow these steps to unlock meaningful insights from your CRD data:</p>
<section id="step-1-set-the-stage-with-agror" class="level2">
<h2 class="anchored" data-anchor-id="step-1-set-the-stage-with-agror"><strong>Step 1: Set the Stage with AgroR</strong></h2>
<section id="install-and-load-the-agror-package" class="level3">
<h3 class="anchored" data-anchor-id="install-and-load-the-agror-package">Install and Load the AgroR Package</h3>
<p>Begin by installing the AgroR package using the following R command:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AgroR"</span>)</span></code></pre></div>
</div>
<p>After installation, load the package into your R session with:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(AgroR)</span></code></pre></div>
</div>
</section>
</section>
<section id="step-2-prepare-your-data-for-analysis" class="level2">
<h2 class="anchored" data-anchor-id="step-2-prepare-your-data-for-analysis"><strong>Step 2: Prepare Your Data for Analysis</strong></h2>
<p>Ensure your CRD data is well-organized in a data frame with the following structure:</p>
<ul>
<li>Each row represents an experimental unit.</li>
<li>The first column contains treatment assignments (e.g., “Treatment 1”, “Treatment 2”, etc.).</li>
<li>Subsequent columns hold measured values for each experimental unit and response variable (e.g., yield, plant height).</li>
</ul>
</section>
<section id="step-3-unveil-patterns-with-analysis-of-variance-anova" class="level2">
<h2 class="anchored" data-anchor-id="step-3-unveil-patterns-with-analysis-of-variance-anova"><strong>Step 3: Unveil Patterns with Analysis of Variance (ANOVA)</strong></h2>
<p>Utilize the <code>DIC</code> function to perform ANOVA on your CRD data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(pomegranate)</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(pomegranate, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DIC</span>(trat, WL, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weight loss (%)"</span>)) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tukey</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Normality of errors
-----------------------------------------------------------------
                         Method Statistic   p.value
 Shapiro-Wilk normality test(W) 0.9448293 0.2087967</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered normal</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Homogeneity of Variances
-----------------------------------------------------------------
                              Method Statistic   p.value
 Bartlett test(Bartlett's K-squared)  8.568274 0.1275737</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level,hypothesis H0 is not rejected. Therefore, the variances can be considered homogeneous</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Independence from errors
-----------------------------------------------------------------
                 Method Statistic   p.value
 Durbin-Watson test(DW)  2.104821 0.1924474</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered independent</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Additional Information
-----------------------------------------------------------------

CV (%) =  10.84
MStrat/MST =  0.92
Mean =  2.2596
Median =  2.225
Possible outliers =  No discrepant point

-----------------------------------------------------------------
Analysis of Variance
-----------------------------------------------------------------
          Df   Sum Sq    Mean.Sq  F value        Pr(F)
Treatment  5 3.692121 0.73842417 12.31191 2.723541e-05
Residuals 18 1.079575 0.05997639                      </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value, it is less than the 5% significance level.The hypothesis H0 of equality of means is rejected. Therefore, at least two treatments differ</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

-----------------------------------------------------------------
Multiple Comparison Test: Tukey HSD
-----------------------------------------------------------------
     resp groups
T5 2.6375      a
T4 2.6200      a
T3 2.6175      a
T6 2.1625     ab
T1 1.8425      b
T2 1.6775      b</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/crd/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/crd/index_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>use <code>mcomp</code> to multiple comparison test (Tukey (default), LSD, Scott-Knott and Duncan)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(pomegranate, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DIC</span>(trat, WL, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mcomp =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"duncan"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weight loss (%)"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Normality of errors
-----------------------------------------------------------------
                         Method Statistic   p.value
 Shapiro-Wilk normality test(W) 0.9448293 0.2087967</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered normal</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Homogeneity of Variances
-----------------------------------------------------------------
                              Method Statistic   p.value
 Bartlett test(Bartlett's K-squared)  8.568274 0.1275737</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level,hypothesis H0 is not rejected. Therefore, the variances can be considered homogeneous</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Independence from errors
-----------------------------------------------------------------
                 Method Statistic   p.value
 Durbin-Watson test(DW)  2.104821 0.1924474</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered independent</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Additional Information
-----------------------------------------------------------------

CV (%) =  10.84
MStrat/MST =  0.92
Mean =  2.2596
Median =  2.225
Possible outliers =  No discrepant point

-----------------------------------------------------------------
Analysis of Variance
-----------------------------------------------------------------
          Df   Sum Sq    Mean.Sq  F value        Pr(F)
Treatment  5 3.692121 0.73842417 12.31191 2.723541e-05
Residuals 18 1.079575 0.05997639                      </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value, it is less than the 5% significance level.The hypothesis H0 of equality of means is rejected. Therefore, at least two treatments differ</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

-----------------------------------------------------------------
Multiple Comparison Test: Duncan
-----------------------------------------------------------------
     resp groups
T5 2.6375      a
T4 2.6200      a
T3 2.6175      a
T6 2.1625      b
T1 1.8425     bc
T2 1.6775      c</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/crd/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/crd/index_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>chart type: Graph type (columns, boxes or segments)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span>(pomegranate, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DIC</span>(trat, WL, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">geom=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"point"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Weight loss (%)"</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Normality of errors
-----------------------------------------------------------------
                         Method Statistic   p.value
 Shapiro-Wilk normality test(W) 0.9448293 0.2087967</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered normal</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Homogeneity of Variances
-----------------------------------------------------------------
                              Method Statistic   p.value
 Bartlett test(Bartlett's K-squared)  8.568274 0.1275737</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level,hypothesis H0 is not rejected. Therefore, the variances can be considered homogeneous</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Independence from errors
-----------------------------------------------------------------
                 Method Statistic   p.value
 Durbin-Watson test(DW)  2.104821 0.1924474</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered independent</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Additional Information
-----------------------------------------------------------------

CV (%) =  10.84
MStrat/MST =  0.92
Mean =  2.2596
Median =  2.225
Possible outliers =  No discrepant point

-----------------------------------------------------------------
Analysis of Variance
-----------------------------------------------------------------
          Df   Sum Sq    Mean.Sq  F value        Pr(F)
Treatment  5 3.692121 0.73842417 12.31191 2.723541e-05
Residuals 18 1.079575 0.05997639                      </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>As the calculated p-value, it is less than the 5% significance level.The hypothesis H0 of equality of means is rejected. Therefore, at least two treatments differ</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

-----------------------------------------------------------------
Multiple Comparison Test: Tukey HSD
-----------------------------------------------------------------
     resp groups
T5 2.6375      a
T4 2.6200      a
T3 2.6175      a
T6 2.1625     ab
T1 1.8425      b
T2 1.6775      b</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/crd/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/crd/index_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="step-4-decode-and-conclude" class="level2">
<h2 class="anchored" data-anchor-id="step-4-decode-and-conclude"><strong>Step 4: Decode and Conclude</strong></h2>
<section id="interpret-the-crd-results" class="level3">
<h3 class="anchored" data-anchor-id="interpret-the-crd-results">Interpret the CRD Results</h3>
<p>Based on ANOVA p-values and multiple comparisons, identify significant differences in the response variable among treatments.</p>
<p>If differences are detected, pinpoint the treatment combinations responsible for those variations.</p>
<p>Consider the biological implications of observed differences and draw conclusions about treatment effects on the response variable.</p>
<p>By systematically following these steps, you’ll harness the analytical prowess of AgroR and CRD, unraveling the intricacies of your crop science experiments with precision and confidence.</p>


</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {Unveiling the {Power} of {Completely} {Randomized} {Design}
    {(CRD)} in {Crop} {Science} {Experiments}},
  date = {2023-10-24},
  url = {https://franklinsantosm.com/posts/crd},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“Unveiling the Power of Completely
Randomized Design (CRD) in Crop Science Experiments.”</span> October 24,
2023. <a href="https://franklinsantosm.com/posts/crd">https://franklinsantosm.com/posts/crd</a>.
</div></div></section></div> ]]></description>
  <category>crd</category>
  <category>agroR package</category>
  <category>Experimental Design</category>
  <guid>https://franklinsantosm.com/posts/crd/</guid>
  <pubDate>Tue, 24 Oct 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/crd/cr.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>The corrr package in R: A powerful tool for exploring correlations</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/corrr/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Correlations are a fundamental tool for data analysis, and they can be used to measure the strength and direction of the relationship between two variables. The corrr package in R is a powerful tool for exploring correlations, and it makes it possible to easily perform routine tasks when exploring correlation matrices, such as:</p>
<ul>
<li>Ignoring the diagonal</li>
<li>Focusing on the correlations of certain variables against others</li>
<li>Rearranging and visualizing the matrix in terms of the strength of the correlations</li>
</ul>
<p>The corrr package also provides a number of functions for working with correlation data frames, including:</p>
<ul>
<li>Filtering and sorting</li>
<li>Computing descriptive statistics</li>
<li>Creating plots</li>
</ul>
</section>
<section id="body" class="level2">
<h2 class="anchored" data-anchor-id="body">Body</h2>
<p>This blog post will provide an overview of how to use the <code>corrr package</code> in R to explore correlations. We will cover the following topics:</p>
<ul>
<li>Installing and loading the corrr package</li>
<li>Creating a correlation data frame</li>
<li>Filtering and sorting the correlation data frame</li>
<li>Computing descriptive statistics for the correlation data frame</li>
<li>Creating plots of the correlation data frame</li>
</ul>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The corrr package is a powerful tool for exploring correlations in R. It is highly recommended for anyone who works with correlation data.</p>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">Example:</h2>
<p>Here is an example of how to use the corrr package to create a heatmap of the correlation matrix for the mtcars dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Install the corrr package</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"corrr"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the corrr package</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(corrr)</span></code></pre></div>
</div>
<section id="data" class="level3">
<h3 class="anchored" data-anchor-id="data">Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"airquality"</span>)</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(airquality)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Ozone Solar.R Wind Temp Month Day
1    41     190  7.4   67     5   1
2    36     118  8.0   72     5   2
3    12     149 12.6   74     5   3
4    18     313 11.5   62     5   4
5    NA      NA 14.3   56     5   5
6    28      NA 14.9   66     5   6</code></pre>
</div>
</div>
</section>
<section id="compute-correlation-matrix" class="level3">
<h3 class="anchored" data-anchor-id="compute-correlation-matrix">Compute correlation matrix</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">res.cor <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlate</span>(airquality)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Correlation computed with
• Method: 'pearson'
• Missing treated using: 'pairwise.complete.obs'</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">res.cor</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  term      Ozone Solar.R    Wind   Temp    Month      Day
  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 Ozone   NA       0.348  -0.602   0.698  0.165   -0.0132 
2 Solar.R  0.348  NA      -0.0568  0.276 -0.0753  -0.150  
3 Wind    -0.602  -0.0568 NA      -0.458 -0.178    0.0272 
4 Temp     0.698   0.276  -0.458  NA      0.421   -0.131  
5 Month    0.165  -0.0753 -0.178   0.421 NA       -0.00796
6 Day     -0.0132 -0.150   0.0272 -0.131 -0.00796 NA      </code></pre>
</div>
</div>
<p><code>fashion()</code>, this function is for pleasant correlation viewing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">res.cor <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fashion</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     term Ozone Solar.R Wind Temp Month  Day
1   Ozone           .35 -.60  .70   .16 -.01
2 Solar.R   .35         -.06  .28  -.08 -.15
3    Wind  -.60    -.06      -.46  -.18  .03
4    Temp   .70     .28 -.46        .42 -.13
5   Month   .16    -.08 -.18  .42       -.01
6     Day  -.01    -.15  .03 -.13  -.01     </code></pre>
</div>
</div>
</section>
<section id="create-a-correlation-network" class="level3">
<h3 class="anchored" data-anchor-id="create-a-correlation-network">Create a correlation network</h3>
<p>The R function <code>network_plot()</code> can be used to visualize and explore correlations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">airquality <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlate</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">network_plot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min_cor =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Correlation computed with
• Method: 'pearson'
• Missing treated using: 'pairwise.complete.obs'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/corrr/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The option <code>min_cor</code> indicates the required minimum correlation value for a correlation to be plotted.</p>
<p><strong>Each point reprents a variable</strong>. Variable that are highly correlated are clustered together. The positioning of variables is handled by multidimensional scaling of the absolute values of the correlations.</p>
<p>For example, it can be seen from the above plot that the variables <code>Ozone</code>, <code>Wind</code> and <code>Temp</code> are clustering together (which makes sense).</p>
<p><strong>Each path represents a correlation</strong> between the two variables that it joins. Blue color represents a positive correlation, and a red color corresponds to a negative correlation.</p>
<p>The width and transparency of the path represent the strength of the correlation (wider and less transparent = stronger correlation).</p>
<p>For example, it can be seen that the positive correlation between <code>Ozone</code> and <code>Temp</code> is stronger than the positive correlation between <code>Ozone</code> and <code>Solar.R</code>.</p>
</section>
<section id="cleaning-up-the-correlation-network" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-up-the-correlation-network">Cleaning up the correlation network</h3>
<p>We can clean this up by increasing the <code>min_cor</code>, thus plotting fewer correlation paths:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">mtcars <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">correlate</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">network_plot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">min_cor =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Correlation computed with
• Method: 'pearson'
• Missing treated using: 'pairwise.complete.obs'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/corrr/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {The Corrr Package in {R:} {A} Powerful Tool for Exploring
    Correlations},
  date = {2023-09-20},
  url = {https://franklinsantosm.com/posts/corrr},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“The Corrr Package in R: A Powerful Tool
for Exploring Correlations.”</span> September 20, 2023. <a href="https://franklinsantosm.com/posts/corrr">https://franklinsantosm.com/posts/corrr</a>.
</div></div></section></div> ]]></description>
  <category>correlation</category>
  <category>corrr package</category>
  <category>correlation plot</category>
  <guid>https://franklinsantosm.com/posts/corrr/</guid>
  <pubDate>Wed, 20 Sep 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/corrr/cor.png" medium="image" type="image/png" height="89" width="144"/>
</item>
<item>
  <title>La inteligencia artificial revoluciona la agricultura</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/agri_AI/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>La agricultura es un sector que se enfrenta a una serie de desafíos, como el cambio climático, la escasez de recursos y la creciente demanda de alimentos. La inteligencia artificial (IA) ofrece una serie de soluciones prometedoras para estos desafíos.</p>
<p>La IA se puede utilizar para analizar datos y tomar decisiones. Esto puede ayudar a los agricultores a:</p>
<ul>
<li><strong>Mejorar la detección de enfermedades y plagas</strong>: La IA se puede utilizar para analizar imágenes de cultivos para detectar signos de enfermedades o plagas. Esto permite a los agricultores tomar medidas para controlar estas amenazas antes de que causen daños significativos.</li>
<li><strong>Optimizar el riego</strong>: La IA se puede utilizar para analizar datos sobre el clima, el suelo y los cultivos para optimizar el riego. Esto puede ayudar a los agricultores a ahorrar agua y mejorar la eficiencia del riego.</li>
<li><strong>Mejorar la gestión de los nutrientes</strong>: La IA se puede utilizar para analizar datos sobre el suelo y los cultivos para optimizar la aplicación de fertilizantes. Esto puede ayudar a los agricultores a ahorrar fertilizantes y mejorar la salud de los cultivos.</li>
<li><strong>Automatizar las tareas agrícolas</strong>: La IA se puede utilizar para automatizar tareas agrícolas, como la siembra, la cosecha y el control de plagas. Esto puede ayudar a los agricultores a reducir los costos de mano de obra y mejorar la eficiencia.</li>
</ul>
<p>La IA aún está en sus primeras etapas de desarrollo, pero tiene el potencial de revolucionar la agricultura. A medida que la IA continúe desarrollándose, se espera que tenga un impacto aún mayor en el sector agropecuario.</p>
</section>
<section id="ejemplos-de-aplicaciones-de-la-ia-en-la-agricultura" class="level2">
<h2 class="anchored" data-anchor-id="ejemplos-de-aplicaciones-de-la-ia-en-la-agricultura">Ejemplos de aplicaciones de la IA en la agricultura</h2>
<p>Aquí hay algunos ejemplos de cómo la IA se está utilizando actualmente en la agricultura:</p>
<ul>
<li>La empresa estadounidense <strong>John Deere</strong> utiliza la IA para desarrollar tractores autónomos que pueden realizar tareas agrícolas sin la intervención humana.</li>
<li>La empresa israelí <strong>CropX</strong> utiliza la IA para analizar datos de imágenes satelitales para detectar signos de estrés en los cultivos.</li>
<li>La empresa estadounidense <strong>Blue River Technology</strong> utiliza la IA para desarrollar sistemas de riego que pueden ajustar la cantidad de agua aplicada a cada planta.</li>
</ul>
<p><img src="https://franklinsantosm.com/posts/agri_AI/2.webp" class="img-fluid"></p>
</section>
<section id="beneficios-de-la-ia-en-la-agricultura" class="level2">
<h2 class="anchored" data-anchor-id="beneficios-de-la-ia-en-la-agricultura">Beneficios de la IA en la agricultura</h2>
<p>La IA ofrece una serie de beneficios para la agricultura, incluyendo:</p>
<ul>
<li><strong>Mejora la productividad</strong>: La IA puede ayudar a los agricultores a obtener mayores rendimientos de sus cultivos.</li>
<li><strong>Reduce los costos</strong>: La IA puede ayudar a los agricultores a reducir los costos de mano de obra, insumos y otros gastos.</li>
<li><strong>Mejora la sostenibilidad</strong>: La IA puede ayudar a los agricultores a utilizar los recursos de manera más eficiente y reducir su impacto ambiental.</li>
</ul>
<p><img src="https://franklinsantosm.com/posts/agri_AI/3.jpeg" class="img-fluid"></p>
</section>
<section id="retos-de-la-ia-en-la-agricultura" class="level2">
<h2 class="anchored" data-anchor-id="retos-de-la-ia-en-la-agricultura">Retos de la IA en la agricultura</h2>
<p>La IA aún enfrenta algunos retos en la agricultura, incluyendo:</p>
<ul>
<li><strong>Costo</strong>: La tecnología de IA puede ser costosa, lo que puede limitar su adopción por parte de los agricultores.</li>
<li><strong>Acceso a datos</strong>: La IA requiere grandes cantidades de datos para funcionar de manera efectiva. Los agricultores pueden tener dificultades para acceder a estos datos.</li>
<li><strong>Aceptación por parte de los agricultores</strong>: Algunos agricultores pueden ser reacios a adoptar nuevas tecnologías, como la IA.</li>
</ul>
</section>
<section id="conclusión" class="level2">
<h2 class="anchored" data-anchor-id="conclusión">Conclusión</h2>
<p>La IA tiene el potencial de transformar la agricultura. A medida que la IA continúe desarrollándose y el costo de la tecnología disminuya, es probable que se adopte de manera más generalizada por los agricultores. Esto podría conducir a una agricultura más productiva, sostenible y rentable.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {La Inteligencia Artificial Revoluciona La Agricultura},
  date = {2023-08-30},
  url = {https://franklinsantosm.com/posts/agri_AI},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“La Inteligencia Artificial Revoluciona La
Agricultura.”</span> August 30, 2023. <a href="https://franklinsantosm.com/posts/agri_AI">https://franklinsantosm.com/posts/agri_AI</a>.
</div></div></section></div> ]]></description>
  <category>AI</category>
  <category>agriculture</category>
  <category>artificial intelligence</category>
  <guid>https://franklinsantosm.com/posts/agri_AI/</guid>
  <pubDate>Wed, 30 Aug 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/agri_AI/AI.webp" medium="image" type="image/webp"/>
</item>
<item>
  <title>Dumbbell plot: visualizar cambio en ggplot2</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/change_plot/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>El gráfico de mancuernas es una visualización que muestra el cambio entre dos puntos de nuestros datos. Su nombre se debe a la forma de la mancuerna. Es una gran manera de mostrar los datos cambiantes entre dos puntos (piensa en el inicio y el final). Aquí podemos ver la mejora en el ahorro de combustible de los vehículos a lo largo del tiempo (entre 1999 y 2008). La mancuerna muestra el punto inicial (MPG en 1999) y el punto final (MPG en 2008).</p>
</section>
<section id="cargar-librerias-y-datos" class="level2">
<h2 class="anchored" data-anchor-id="cargar-librerias-y-datos">Cargar librerias y datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyquant)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggalt)</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data</span></span>
<span id="cb1-6">mpg</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 234 × 11
   manufacturer model      displ  year   cyl trans drv     cty   hwy fl    class
   &lt;chr&gt;        &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
 1 audi         a4           1.8  1999     4 auto… f        18    29 p     comp…
 2 audi         a4           1.8  1999     4 manu… f        21    29 p     comp…
 3 audi         a4           2    2008     4 manu… f        20    31 p     comp…
 4 audi         a4           2    2008     4 auto… f        21    30 p     comp…
 5 audi         a4           2.8  1999     6 auto… f        16    26 p     comp…
 6 audi         a4           2.8  1999     6 manu… f        18    26 p     comp…
 7 audi         a4           3.1  2008     6 auto… f        18    27 p     comp…
 8 audi         a4 quattro   1.8  1999     4 manu… 4        18    26 p     comp…
 9 audi         a4 quattro   1.8  1999     4 auto… 4        16    25 p     comp…
10 audi         a4 quattro   2    2008     4 manu… 4        20    28 p     comp…
# ℹ 224 more rows</code></pre>
</div>
</div>
</section>
<section id="paso-1-preparacion-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="paso-1-preparacion-de-datos">Paso 1: Preparacion de datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">mpg_by_year_tbl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> mpg <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(hwy, year, model, class)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb3-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> year,</span>
<span id="cb3-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> hwy,</span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(class, model),</span>
<span id="cb3-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_fn =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_prefix =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year_"</span></span>
<span id="cb3-9">  )<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">model =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(model, year_2008))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>()</span></code></pre></div>
</div>
</section>
<section id="paso-2-dumbbell-plot-base" class="level2">
<h2 class="anchored" data-anchor-id="paso-2-dumbbell-plot-base">Paso 2: Dumbbell plot base</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># basic plot with ggalt</span></span>
<span id="cb4-2">g1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> mpg_by_year_tbl<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year_1999, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> year_2008,</span>
<span id="cb4-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> model, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> model))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_dumbbell</span>(</span>
<span id="cb4-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#a3c4dc"</span>,</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour_xend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#0e668b"</span>,</span>
<span id="cb4-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>,</span>
<span id="cb4-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dot_guide =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb4-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dot_guide_size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.19</span>,</span>
<span id="cb4-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dot_guide_colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey60"</span></span>
<span id="cb4-12">  )</span>
<span id="cb4-13"></span>
<span id="cb4-14">g1</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/change_plot/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="paso-3-configurar-con-ggplot" class="level2">
<h2 class="anchored" data-anchor-id="paso-3-configurar-con-ggplot">Paso 3: Configurar con <code>ggplot</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">g2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> g1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb5-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cambio de vehiculos entre 1999 y 2008"</span>,</span>
<span id="cb5-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fuel Economy (MPG)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Vehicle Model"</span></span>
<span id="cb5-5">)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_tq</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_line</span>(),</span>
<span id="cb5-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb5-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.border =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb5-13">  )</span>
<span id="cb5-14"></span>
<span id="cb5-15">g2</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/change_plot/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {Dumbbell Plot: Visualizar Cambio En Ggplot2},
  date = {2023-07-20},
  url = {https://franklinsantosm.com/posts/change_plot},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“Dumbbell Plot: Visualizar Cambio En
Ggplot2.”</span> July 20, 2023. <a href="https://franklinsantosm.com/posts/change_plot">https://franklinsantosm.com/posts/change_plot</a>.
</div></div></section></div> ]]></description>
  <category>data science</category>
  <category>ggalt</category>
  <category>dumbbell plot</category>
  <guid>https://franklinsantosm.com/posts/change_plot/</guid>
  <pubDate>Thu, 20 Jul 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/change_plot/change.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Analisis de datos climaticos</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/weather_mizque/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb1-2">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_excel</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/Users/franklin/Documents/R/myblog/posts/weather_mizque/dato_diarios.xlsx"</span>)</span></code></pre></div>
</div>
</section>
<section id="analisis-de-temperatura" class="level2">
<h2 class="anchored" data-anchor-id="analisis-de-temperatura">analisis de temperatura</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#Real data Mizque</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(metan)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>|=========================================================|</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Multi-Environment Trial Analysis (metan) v1.18.0        |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Author: Tiago Olivoto                                   |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Type 'citation('metan')' to know how to cite metan      |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Type 'vignette('metan_start')' for a short tutorial     |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>| Visit 'https://bit.ly/pkgmetan' for a complete tutorial |</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>|=========================================================|</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inspect</span>(df, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot =</span> F)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 10
   Variable      Class Missing Levels Valid_n    Min Median    Max Outlier Text 
   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;
 1 "mes"         nume… No      -          485    1      5     12         0  &lt;NA&gt;
 2 "dia"         nume… No      -          485    1     16     31         0  &lt;NA&gt;
 3 "estacion"    char… No      0          485   NA     NA     NA        NA "Lin…
 4 "longitud"    nume… No      -          485  -65.4  -65.4  -65.4       0  &lt;NA&gt;
 5 "latitud"     nume… No      -          485  -18.0  -18.0  -18.0       0  &lt;NA&gt;
 6 "altura"      nume… No      -          485 2055   2055   2055         0  &lt;NA&gt;
 7 "Precipitaci… char… No      0          485   NA     NA     NA        NA "Lin…
 8 "\"Temperatu… char… No      0          485   NA     NA     NA        NA "Lin…
 9 "\"Temperatu… char… No      0          485   NA     NA     NA        NA "Lin…
10 "\"Temperatu… char… No      0          485   NA     NA     NA        NA "Lin…
11 "\"Humedad R… char… No      0          485   NA     NA     NA        NA "Lin…
12 "\"Humedad R… char… No      0          485   NA     NA     NA        NA "Lin…
13 "\"Humedad R… char… No      0          485   NA     NA     NA        NA "Lin…</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Considering the levels of factors, .data should have 1 rows, but it
has 485. Use 'as_factor()' for coercing a variable to a factor.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Expected three or more factor variables. The data has only 0.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Possible text fragments in variable(s) estacion, Precipitación,
"Temperatura Máxima", "Temperatura Mínima", "Temperatura Media", "Humedad
Relativa Máxima", "Humedad Relativa Mínima", "Humedad Relativa Media".</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ forcats::as_factor()         masks metan::as_factor()
✖ tibble::column_to_rownames() masks metan::column_to_rownames()
✖ dplyr::filter()              masks stats::filter()
✖ dplyr::lag()                 masks stats::lag()
✖ dplyr::recode_factor()       masks metan::recode_factor()
✖ tibble::remove_rownames()    masks metan::remove_rownames()
✖ tidyr::replace_na()          masks metan::replace_na()
✖ tibble::rownames_to_column() masks metan::rownames_to_column()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "gestion"                     "mes"                        
 [3] "dia"                         "estacion"                   
 [5] "longitud"                    "latitud"                    
 [7] "altura"                      "Precipitación"              
 [9] "\"Temperatura Máxima\""      "\"Temperatura Mínima\""     
[11] "\"Temperatura Media\""       "\"Humedad Relativa Máxima\""
[13] "\"Humedad Relativa Mínima\"" "\"Humedad Relativa Media\"" </code></pre>
</div>
</div>
</section>
<section id="rename-variables" class="level2">
<h2 class="anchored" data-anchor-id="rename-variables">Rename variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">newvar <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PP =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Precipitación"</span>, </span>
<span id="cb21-2">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tmax =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Temperatura Máxima</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb21-3">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tmin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Temperatura Mínima</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb21-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tmean =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Temperatura Media</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb21-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HRmax =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Humedad Relativa Máxima</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb21-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HRmin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Humedad Relativa Mínima</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb21-7">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">HRmean =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Humedad Relativa Media</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">db <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any_of</span>(newvar))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate_if</span>(is.character, as.numeric)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(mes), </span>
<span id="cb22-6">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gestion =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(gestion))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb22-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mes=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(mes, </span>
<span id="cb22-8">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ene'</span>, </span>
<span id="cb22-9">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Feb'</span>,</span>
<span id="cb22-10">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'3'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Mar'</span>,</span>
<span id="cb22-11">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'4'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Abr'</span>,</span>
<span id="cb22-12">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'5'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'May'</span>,</span>
<span id="cb22-13">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'6'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Jun'</span>,</span>
<span id="cb22-14">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'7'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Jul'</span>,</span>
<span id="cb22-15">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'8'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Ago'</span>,</span>
<span id="cb22-16">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'9'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Sep'</span>,</span>
<span id="cb22-17">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'10'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Oct'</span>,</span>
<span id="cb22-18">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'11'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Nov'</span>,</span>
<span id="cb22-19">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'12'</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Dic'</span>))</span>
<span id="cb22-20">db  </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 485 × 10
   gestion mes     dia    PP  Tmax  Tmin Tmean HRmax HRmin HRmean
   &lt;fct&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2022    Ene       1   0.4  31.4  9.92  20.6  93.2  19.3   53.4
 2 2022    Ene       2   0    33.3 11.7   19.7  96.6  18.0   69.6
 3 2022    Ene       3   5.1  29.6 14.4   21.0  88.7  27.2   58.7
 4 2022    Ene       4   0    30.1 14.1   20.1  90.8  23.6   66.3
 5 2022    Ene       5   1.5  21.9 13.4   16.7  94.6  47.8   81.0
 6 2022    Ene       6   4.5  25.5 14.4   19.8  94.3  35.9   65.8
 7 2022    Ene       7   0    27.3 14.7   20.4  95.6  39.9   67.3
 8 2022    Ene       8  24.2  25.3 15.3   19.0  91.3  49.6   74.5
 9 2022    Ene       9   0    26.9 15.5   20.2  92.7  38.5   70.6
10 2022    Ene      10   0    24   14.5   18.5  91.9  47.2   73.0
# ℹ 475 more rows</code></pre>
</div>
</div>
</section>
<section id="plot-temperature" class="level2">
<h2 class="anchored" data-anchor-id="plot-temperature">plot temperature</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggridges)</span>
<span id="cb24-2"></span>
<span id="cb24-3">my_theme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb24-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb24-6">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>),</span>
<span id="cb24-7">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>),</span>
<span id="cb24-8">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb24-9"></span>
<span id="cb24-10">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb24-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> db,</span>
<span id="cb24-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tmean</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb24-13">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mes</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb24-14">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(x))</span>
<span id="cb24-15">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density_ridges_gradient</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, </span>
<span id="cb24-17">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rel_min_height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Temp (ºC)"</span>, </span>
<span id="cb24-19">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"H"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-20">  my_theme <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.95</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Temperatura promedio (ºC)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Meses"</span>)</span>
<span id="cb24-23"></span>
<span id="cb24-24">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb24-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> db,</span>
<span id="cb24-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tmin</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb24-27">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mes</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb24-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(x))</span>
<span id="cb24-29">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density_ridges_gradient</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, </span>
<span id="cb24-31">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rel_min_height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Temp (ºC)"</span>, </span>
<span id="cb24-33">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"H"</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-34">  my_theme<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.9</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.77</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Temperatura mínima (ºC)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Meses"</span>)</span>
<span id="cb24-37"></span>
<span id="cb24-38"></span>
<span id="cb24-39">p3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb24-40">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> db,</span>
<span id="cb24-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Tmax</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb24-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mes</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>,</span>
<span id="cb24-43">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">after_stat</span>(x))</span>
<span id="cb24-44">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_density_ridges_gradient</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1</span>, </span>
<span id="cb24-46">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rel_min_height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.001</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_viridis_c</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Temp (ºC)"</span>, </span>
<span id="cb24-48">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"H"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-49">  my_theme<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb24-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Temperatura maxima (ºC)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Meses"</span>)</span>
<span id="cb24-52"></span>
<span id="cb24-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange_ggplot</span>((p1),</span>
<span id="cb24-54">               (p2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>p3),</span>
<span id="cb24-55">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb24-56">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.801</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 1.11</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 1.2</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/weather_mizque/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-precipitation" class="level2">
<h2 class="anchored" data-anchor-id="plot-precipitation">plot precipitation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">pp <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span>db<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">PP =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">na_if</span>(PP, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> mes,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> PP,</span>
<span id="cb28-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> mes</span>
<span id="cb28-5">             )) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_boxplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outlier.shape =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_jitter</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-8">  my_theme<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Meses"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Precipitacion (mm)"</span>)</span></code></pre></div>
</div>
</section>
<section id="humedad-relativa-plot" class="level2">
<h2 class="anchored" data-anchor-id="humedad-relativa-plot">Humedad relativa plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">fechas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb29-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any_of</span>(newvar))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb29-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb29-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate_if</span>(is.character, as.numeric)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb29-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fecha =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">make_datetime</span>(gestion,mes,dia))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb29-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(fecha,HRmin,HRmax, HRmean)</span>
<span id="cb29-7">fechas</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 485 × 4
   fecha               HRmin HRmax HRmean
   &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 2022-01-01 00:00:00  19.3  93.2   53.4
 2 2022-01-02 00:00:00  18.0  96.6   69.6
 3 2022-01-03 00:00:00  27.2  88.7   58.7
 4 2022-01-04 00:00:00  23.6  90.8   66.3
 5 2022-01-05 00:00:00  47.8  94.6   81.0
 6 2022-01-06 00:00:00  35.9  94.3   65.8
 7 2022-01-07 00:00:00  39.9  95.6   67.3
 8 2022-01-08 00:00:00  49.6  91.3   74.5
 9 2022-01-09 00:00:00  38.5  92.7   70.6
10 2022-01-10 00:00:00  47.2  91.9   73.0
# ℹ 475 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">HR <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> fechas<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb31-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span>fecha, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span>HRmean))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-4">  my_theme<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Meses"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Humedad relativa promedio (%)"</span>)</span>
<span id="cb31-6">HR</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/weather_mizque/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(plotly)</span>
<span id="cb32-2">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> fechas<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb32-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_ly</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>fecha, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>HRmean)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb32-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">add_lines</span>()</span>
<span id="cb32-5">p</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange_ggplot</span>((pp),</span>
<span id="cb33-2">               (p1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>HR),</span>
<span id="cb33-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb33-4">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tag_levels =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 342 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 342 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.801</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/weather_mizque/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {Analisis de Datos Climaticos},
  date = {2023-06-25},
  url = {https://franklinsantosm.com/posts/weather_mizque},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“Analisis de Datos Climaticos.”</span>
June 25, 2023. <a href="https://franklinsantosm.com/posts/weather_mizque">https://franklinsantosm.com/posts/weather_mizque</a>.
</div></div></section></div> ]]></description>
  <category>data science</category>
  <category>weather analysis</category>
  <category>plot</category>
  <guid>https://franklinsantosm.com/posts/weather_mizque/</guid>
  <pubDate>Sun, 25 Jun 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/weather_mizque/w.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>ggplot2: facet_wrap, facet_grid</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/facet_ggplot2/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p><code>ggplot2</code> es un paquete de visualización de datos en R que utiliza la gramática de gráficos para crear gráficos flexibles y de alta calidad. Con su sintaxis intuitiva, amplias opciones de personalización y variedad de gráficos predefinidos, <code>ggplot2</code> se ha convertido en una herramienta popular y poderosa para la visualización de datos en la comunidad de R.</p>
<p><code>facet_grid</code> y <code>facet_wrap</code> son dos funciones en el paquete <code>ggplot2</code> de R que permiten dividir un gráfico en múltiples paneles según las variables de una o varias variables categóricas. Estas funciones son especialmente útiles cuando se desea explorar la relación entre variables en diferentes subconjuntos de datos.</p>
</section>
<section id="facet-wrap" class="level2">
<h2 class="anchored" data-anchor-id="facet-wrap">Facet wrap</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2">mpg2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">subset</span>(mpg, cyl <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> drv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"f"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> class <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2seater"</span>)</span>
<span id="cb1-3">base <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(mpg2, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(displ, hwy)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_blank</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)</span>
<span id="cb1-7"></span>
<span id="cb1-8">base <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>class, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">base <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>class, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">as.table =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">base <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>class, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">base <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>class, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dir =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"v"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-2-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="facet-grid" class="level2">
<h2 class="anchored" data-anchor-id="facet-grid">Facet grid</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">base <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(. <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> cyl)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><code>facet_grid()</code> dispone los gráficos en una cuadrícula 2D, definida por una fórmula:</li>
</ul>
<p><code>. ~ a</code> distribuye los valores de <code>a</code> a través de las columnas. Esta dirección facilita las comparaciones de la posición y, porque las escalas verticales están alineadas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">base <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(. <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> cyl)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><code>b ~ .</code> reparte los valores de <code>b</code> por las filas. Esta dirección facilita la comparación de la posición x porque las escalas horizontales están alineadas. Esto la hace especialmente útil para comparar distribuciones.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">base <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(drv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> .)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><code>b ~ a</code> distribuye <code>a</code> a lo largo de las columnas y <code>b</code> a lo largo de las filas. Normalmente querrás poner la variable con el mayor número de niveles en las columnas, para aprovechar la relación de aspecto de tu pantalla.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">base <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(drv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> cyl)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Puede utilizar múltiples variables en las filas o columnas, “sumándolas”, por ejemplo <code>a + b ~ c + d</code>. Las variables que aparecen juntas en las filas o columnas están anidadas en el sentido de que sólo las combinaciones que aparecen en los datos aparecerán en el gráfico. Las variables que se especifican en filas y columnas se cruzarán: se mostrarán todas las combinaciones, incluidas las que no aparecían en el conjunto de datos original: esto puede dar lugar a paneles vacíos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Simulación de datos</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb9-3">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>)</span>
<span id="cb9-4">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb9-5">grupo1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G1"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G2"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G3"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G4"</span>)))</span>
<span id="cb9-6">grupo2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>)</span>
<span id="cb9-7">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Data frame</span></span>
<span id="cb9-10">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grupo1 =</span> grupo1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grupo2 =</span> grupo2)</span>
<span id="cb9-11"></span>
<span id="cb9-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Matriz de gráficos</span></span>
<span id="cb9-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> grupo1)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">show.legend =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(grupo1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> grupo2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) </span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="controlando-escalas" class="level2">
<h2 class="anchored" data-anchor-id="controlando-escalas">Controlando escalas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">economics_long</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,870 × 4
   date       variable value  value01
   &lt;date&gt;     &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 1967-07-01 pce       507. 0       
 2 1967-08-01 pce       510. 0.000265
 3 1967-09-01 pce       516. 0.000762
 4 1967-10-01 pce       512. 0.000471
 5 1967-11-01 pce       517. 0.000916
 6 1967-12-01 pce       525. 0.00157 
 7 1968-01-01 pce       531. 0.00207 
 8 1968-02-01 pce       534. 0.00230 
 9 1968-03-01 pce       544. 0.00322 
10 1968-04-01 pce       544  0.00319 
# ℹ 2,860 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(economics_long, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(date, value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>variable, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free_y"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">mpg2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reorder</span>(mpg2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>model, mpg2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cty)</span>
<span id="cb13-2">mpg2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>manufacturer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">reorder</span>(mpg2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>manufacturer, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>mpg2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>cty)</span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(mpg2, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(cty, model)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(manufacturer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ., <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scales =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">space =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"free"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strip.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/facet_ggplot2/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {Ggplot2: Facet\_wrap, Facet\_grid},
  date = {2023-05-15},
  url = {https://franklinsantosm.com/posts/facet_ggplot2},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“Ggplot2: Facet_wrap, Facet_grid.”</span>
May 15, 2023. <a href="https://franklinsantosm.com/posts/facet_ggplot2">https://franklinsantosm.com/posts/facet_ggplot2</a>.
</div></div></section></div> ]]></description>
  <category>ggplot2</category>
  <category>facet_wrap</category>
  <category>facet_grid</category>
  <guid>https://franklinsantosm.com/posts/facet_ggplot2/</guid>
  <pubDate>Mon, 15 May 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/facet_ggplot2/ggp.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>JULIA: Lenguaje de programación del futuro</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/julia/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="qué-es-julia" class="level2">
<h2 class="anchored" data-anchor-id="qué-es-julia">¿Qué es Julia?</h2>
<p>Julia es un lenguaje de programación de alto nivel, diseñado específicamente para el cómputo científico y la estadística. Fue creado en el año 2009 por un grupo de investigadores en la Universidad de California, Berkeley, y se lanzó oficialmente en el año 2012.</p>
<p>Julia combina la facilidad de uso de lenguajes como Python y R con el rendimiento de lenguajes de bajo nivel como C y Fortran. Utiliza una sintaxis clara y concisa, similar a la de MATLAB, y cuenta con una amplia variedad de paquetes y librerías especializadas para estadística y ciencias de datos.</p>
</section>
<section id="ventajas-de-julia-para-estadística" class="level2">
<h2 class="anchored" data-anchor-id="ventajas-de-julia-para-estadística">Ventajas de Julia para estadística</h2>
<p>Julia tiene varias ventajas que lo hacen especialmente útil para aplicaciones estadísticas y de ciencias de datos:</p>
<ul>
<li><p><strong>Rendimiento</strong>: Julia se ejecuta muy rápidamente gracias a su compilación just-in-time (JIT) y a la capacidad de definir tipos de datos específicos para mejorar el rendimiento. Esto significa que se puede trabajar con grandes conjuntos de datos y cálculos complejos de manera eficiente.</p></li>
<li><p><strong>Sintaxis clara y expresiva</strong>: Julia tiene una sintaxis intuitiva y fácil de aprender, que se asemeja a la de otros lenguajes populares como MATLAB o Python. Esto hace que sea fácil para los nuevos usuarios comenzar a trabajar con él.</p></li>
<li><p><strong>Interoperabilidad</strong>: Julia es capaz de integrarse fácilmente con otros lenguajes como Python, R y C. Esto significa que los usuarios pueden aprovechar las bibliotecas y paquetes de otros lenguajes y combinarlos con Julia para obtener el mejor rendimiento posible.</p></li>
<li><p><strong>Paquetes especializados</strong>: Julia cuenta con una amplia variedad de paquetes especializados para estadística y ciencias de datos, como DataFrames.jl, Plots.jl, StatsModels.jl y muchas otras. Esto facilita mucho el trabajo con datos y cálculos estadísticos.</p></li>
</ul>
</section>
<section id="ejemplos-de-uso-de-julia-en-estadística" class="level2">
<h2 class="anchored" data-anchor-id="ejemplos-de-uso-de-julia-en-estadística">Ejemplos de uso de Julia en estadística</h2>
<p>Aquí te presento algunos ejemplos de cómo se puede utilizar Julia para aplicaciones estadísticas:</p>
<ul>
<li><p><strong>Análisis de datos</strong>: Julia es especialmente útil para el análisis de grandes conjuntos de datos. Con paquetes como <a href="https://dataframes.juliadata.org/stable/"><code>DataFrames.jl</code></a>, se puede cargar, manipular y analizar datos de manera eficiente y con alta precisión.</p></li>
<li><p><strong>Modelado estadístico</strong>: Julia cuenta con paquetes especializados para modelado estadístico, como <a href="https://juliastats.org/StatsModels.jl/stable/"><code>StatsModels.jl</code></a> y <a href="https://juliastats.org/GLM.jl/stable/"><code>GLM.jl</code></a>. Estos paquetes permiten ajustar modelos estadísticos complejos y realizar inferencias precisas sobre los datos.</p></li>
<li><p><strong>Visualización de datos</strong>: Julia cuenta con varias bibliotecas de visualización de datos, como <a href="https://docs.juliaplots.org/stable/"><code>Plots.jl</code></a> y <a href="http://gadflyjl.org/stable/"><code>Gadfly.jl</code></a>, que permiten crear visualizaciones de datos de alta calidad de manera eficiente.</p></li>
<li><p><strong>Machine learning</strong>: Julia cuenta con paquetes especializados para el aprendizaje automático, como <a href="https://fluxml.ai/Flux.jl/stable/"><code>Flux.jl</code></a> y <a href="https://alan-turing-institute.github.io/MLJ.jl/dev/"><code>MLJ.jl</code></a>, que permiten entrenar y evaluar modelos de aprendizaje automático de manera eficiente y escalable.</p></li>
</ul>
</section>
<section id="conclusión" class="level2">
<h2 class="anchored" data-anchor-id="conclusión">Conclusión</h2>
<p>Julia es un lenguaje de programación poderoso y versátil que ofrece muchas ventajas para aplicaciones estadísticas y científicas. Con su combinación de rendimiento, sintaxis clara y concisa, y paquetes especializados, Julia se está convirtiendo en una herramienta cada vez más popular para la comunidad estadística y de ciencias de datos.</p>
<p>A medida que se continúa desarrollando y mejorando, se espera que Julia continúe creciendo en popularidad y se convierta en una herramienta aún más valiosa para aplicaciones estadísticas. Además, dado que Julia está diseñado para ser interoperable con otros lenguajes, se espera que su uso se expanda aún más a medida que se integra en ecosistemas de datos y herramientas existentes.</p>
</section>
<section id="resumen" class="level2">
<h2 class="anchored" data-anchor-id="resumen">Resumen</h2>
<p>Si estás buscando una herramienta poderosa y eficiente para aplicaciones estadísticas y científicas, definitivamente vale la pena considerar Julia. Con su rendimiento de alta velocidad y sus paquetes especializados, Julia tiene el potencial de acelerar y mejorar significativamente la investigación y el análisis en muchas áreas diferentes.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {JULIA: {Lenguaje} de Programación Del Futuro},
  date = {2023-04-25},
  url = {https://franklinsantosm.com/posts/julia},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“JULIA: Lenguaje de Programación Del
Futuro.”</span> April 25, 2023. <a href="https://franklinsantosm.com/posts/julia">https://franklinsantosm.com/posts/julia</a>.
</div></div></section></div> ]]></description>
  <category>julia</category>
  <category>Artificial Intelligence</category>
  <category>Data Science</category>
  <guid>https://franklinsantosm.com/posts/julia/</guid>
  <pubDate>Tue, 25 Apr 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/julia/julia.png" medium="image" type="image/png" height="96" width="144"/>
</item>
<item>
  <title>Inteligencia artificial en la agricultura</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/AI/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="qué-es-la-inteligencia-artificial" class="level2">
<h2 class="anchored" data-anchor-id="qué-es-la-inteligencia-artificial">¿Qué es la inteligencia artificial?</h2>
<p>La inteligencia artificial es la capacidad de una máquina o sistema de software para realizar tareas que normalmente requerirían inteligencia humana, como el aprendizaje, la percepción, el razonamiento y la toma de decisiones. La IA puede ser utilizada en una amplia variedad de aplicaciones, desde el reconocimiento de imágenes hasta la automatización de procesos.</p>
</section>
<section id="el-estado-del-arte-de-la-ia" class="level2">
<h2 class="anchored" data-anchor-id="el-estado-del-arte-de-la-ia">El estado del arte de la IA</h2>
<p>En la actualidad, la IA se encuentra en un estado avanzado de desarrollo. Los sistemas de IA están mejorando rápidamente y se están utilizando en una amplia variedad de aplicaciones, incluyendo la medicina, el transporte, la banca y la industria agrícola.</p>
</section>
<section id="desafíos-y-oportunidades-futuras" class="level2">
<h2 class="anchored" data-anchor-id="desafíos-y-oportunidades-futuras">Desafíos y oportunidades futuras</h2>
<p>A pesar del progreso significativo, todavía hay desafíos que se deben abordar en la aplicación de la IA en la agricultura. Algunos de estos desafíos incluyen la falta de datos de calidad y la resistencia de los agricultores a adoptar nuevas tecnologías. Sin embargo, la oportunidad de mejorar la producción y la sostenibilidad agrícola mediante la aplicación de la IA sigue siendo significativa.</p>
</section>
<section id="habilidades-en-programación-y-ciencia-de-datos-para-ingenieros-agrónomos" class="level2">
<h2 class="anchored" data-anchor-id="habilidades-en-programación-y-ciencia-de-datos-para-ingenieros-agrónomos">Habilidades en programación y ciencia de datos para ingenieros agrónomos</h2>
<p>Los ingenieros agrónomos pueden mejorar su trabajo en la agronomía aprendiendo habilidades en programación y ciencia de datos. Estas habilidades incluyen aprender los fundamentos de programación, lenguajes de programación populares, realizar cursos en línea o presenciales, trabajar en proyectos prácticos y participar en eventos y comunidades de programación y ciencia de datos.</p>
</section>
<section id="la-aplicación-de-la-ia-en-la-agricultura" class="level2">
<h2 class="anchored" data-anchor-id="la-aplicación-de-la-ia-en-la-agricultura">La aplicación de la IA en la agricultura</h2>
<p>La aplicación de la IA en la agricultura puede proporcionar soluciones para mejorar la producción, la calidad y la sostenibilidad de los cultivos. Algunas de las aplicaciones de la IA en la agricultura incluyen el análisis de datos agrícolas para la toma de decisiones, la automatización de procesos agrícolas, el monitoreo y la detección de enfermedades en los cultivos, la identificación de plagas y la predicción de la calidad de los cultivos.</p>
</section>
<section id="conclusión" class="level2">
<h2 class="anchored" data-anchor-id="conclusión">Conclusión</h2>
<p>La IA es una tecnología emergente que tiene el potencial de revolucionar la forma en que se aborda la producción agrícola. Los ingenieros agrónomos pueden mejorar su trabajo en la agronomía aprendiendo habilidades en programación y ciencia de datos, lo que les permitirá aprovechar la IA para mejorar la producción, la calidad y la sostenibilidad de los cultivos. A medida que la tecnología continúa avanzando, es probable que veamos aún más aplicaciones de la IA en la industria agrícola.</p>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {Inteligencia Artificial En La Agricultura},
  date = {2023-03-15},
  url = {https://franklinsantosm.com/posts/AI},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“Inteligencia Artificial En La
Agricultura.”</span> March 15, 2023. <a href="https://franklinsantosm.com/posts/AI">https://franklinsantosm.com/posts/AI</a>.
</div></div></section></div> ]]></description>
  <category>AI</category>
  <category>Artificial Intelligence</category>
  <category>Agriculture</category>
  <guid>https://franklinsantosm.com/posts/AI/</guid>
  <pubDate>Wed, 15 Mar 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/AI/ai.webp" medium="image" type="image/webp"/>
</item>
<item>
  <title>Mapas de Bolivia</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/maps/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="mapas" class="level1">
<h1>Mapas</h1>
<section id="introduccion" class="level2">
<h2 class="anchored" data-anchor-id="introduccion">Introduccion</h2>
<p>El paquete <code>rnaturalearth</code> es una herramienta excelente para mantener y facilitar la interacción con los datos cartográficos de <a href="https://www.naturalearthdata.com/">Natural Earth</a>. Para producir mapas con <code>ggplot2</code>, se necesitan los siguientes paquetes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.0      ✔ purrr   1.0.0 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.5.0 
✔ readr   2.1.3      ✔ forcats 0.5.2 
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rnaturalearth)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># America del sur</span></span>
<span id="cb4-2">sam <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_countries</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">continent =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"south america"</span>,</span>
<span id="cb4-3">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>,</span>
<span id="cb4-4">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb4-5">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sam, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlim</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span>))</span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Imagen de Bolivia y destacar La Paz</span></span>
<span id="cb4-11"></span>
<span id="cb4-12">bolivia <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ne_states</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bolivia"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">returnclass =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sf"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scat =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(postal <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LP"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"La Paz"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Otros"</span>))</span>
<span id="cb4-14"></span>
<span id="cb4-15">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> </span>
<span id="cb4-16">  p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> bolivia, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> scat))</span>
<span id="cb4-18">p2</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/maps/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {Mapas de {Bolivia}},
  date = {2023-02-01},
  url = {https://franklinsantosm.com/posts/maps},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“Mapas de Bolivia.”</span> February 1,
2023. <a href="https://franklinsantosm.com/posts/maps">https://franklinsantosm.com/posts/maps</a>.
</div></div></section></div> ]]></description>
  <category>maps</category>
  <category>Bolivia</category>
  <category>bioinformatic</category>
  <guid>https://franklinsantosm.com/posts/maps/</guid>
  <pubDate>Wed, 01 Feb 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/maps/map.png" medium="image" type="image/png" height="112" width="144"/>
</item>
<item>
  <title>Análisis de datos experimentales agrícolas</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/agridata/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introducción" class="level1">
<h1>Introducción</h1>
<p>El análisis de datos es una etapa esencial en el proceso de investigación y consiste en examinar y analizar los datos recopilados de manera detallada para extraer información y obtener conclusiones relevantes en función a los objetivos de la investigación. Para realizar el análisis de datos, se pueden utilizar diferentes herramientas y técnicas, generalmente se construyen tablas y figuras. Estos resultados son usados para tomar decisiones y formular conclusiones sobre los datos, y también pueden ser utilizados para mejorar y optimizar procesos y sistemas. El análisis de datos es importante ya que permite a los investigadores obtener una visión más profunda y detallada de los datos y tomar decisiones más informadas y precisas.</p>
<p>La etapa de análisis de datos puede resultar un reto difícil para un recien egresado o tesista. Esto debido a la falta de experiencia o conocimiento en el uso de herramientas y técnicas de análisis de datos. Debido a ello, queremos facilitar algunas herramientas de análisis, al mismo tiempo, se pretende que los interesados puedan entrenarse en el uso de R. Ya que esta herramienta estadística ofrece un sin fin de paquetes que nos ayudan a realizar los análisis de manera sencilla pero de mucha categoría científica.</p>
</section>
<section id="análisis-de-datos" class="level1">
<h1>Análisis de datos</h1>
<section id="librerias" class="level2">
<h2 class="anchored" data-anchor-id="librerias">Librerias</h2>
</section>
<section id="base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="base-de-datos">Base de datos</h2>
<p>Para esta oportunidad daremos uso de la base de datos de <code>iris</code>. Estos datos estarán disponibles al momento de instalar R.</p>
</section>
<section id="análisis-descriptivo" class="level2">
<h2 class="anchored" data-anchor-id="análisis-descriptivo">Análisis descriptivo</h2>
<p>Generalmente se puede presentar en una tabla los resultados descriptivos.</p>
<div class="cell">
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Análisis descriptivo</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">se</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kurt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">skew</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Petal.Length</td>
<td style="text-align: right;">3.76</td>
<td style="text-align: right;">0.14</td>
<td style="text-align: right;">-1.40</td>
<td style="text-align: right;">-0.27</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">6.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Petal.Width</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">-1.34</td>
<td style="text-align: right;">-0.10</td>
<td style="text-align: right;">0.1</td>
<td style="text-align: right;">2.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sepal.Length</td>
<td style="text-align: right;">5.84</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">-0.55</td>
<td style="text-align: right;">0.31</td>
<td style="text-align: right;">4.3</td>
<td style="text-align: right;">7.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sepal.Width</td>
<td style="text-align: right;">3.06</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">4.4</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>La otra opción podría ser una figura <code>boxplot</code></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/agridata/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="análisis-de-varianza" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-varianza">Análisis de varianza</h2>
<p>Generalmente en la mayoría de las tesis se presenta cada ANOVA para cada variable, la cual no es muy redundante en todo el documento. Además, en las revistas científicas de impacto, este tipo de tablas no es permitido si se tiene varias variables.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Sepal.Width
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species     2 11.345  5.6725   49.16 &lt; 2.2e-16 ***
Residuals 147 16.962  0.1154                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Sin embargo, se podría resumir de esta manera. En la tabla solamente se presenta aquellas variables con significancia estadística.</p>
<div class="cell">
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Análisis de varianza</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">FV</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DF</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sepal.Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Sepal.Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Petal.Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Petal.Width</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Species</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">31.61 **</td>
<td style="text-align: left;">5.67 **</td>
<td style="text-align: left;">218.55 **</td>
<td style="text-align: left;">40.21 **</td>
</tr>
<tr class="even">
<td style="text-align: left;">Residuals</td>
<td style="text-align: right;">147</td>
<td style="text-align: left;">0.27</td>
<td style="text-align: left;">0.12</td>
<td style="text-align: left;">0.19</td>
<td style="text-align: left;">0.04</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Una vez identificada las diferencias estadisticas se procede a realizar pruebas de promedio para seleccionar genotipos sobresalientes.</p>
<p>Hay otra manera de representar comparaciones graficamente</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/agridata/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>
<p>Tambien existe otra opción con el paquete <code>AgroR</code></p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/agridata/index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
-----------------------------------------------------------------
Normality of errors
-----------------------------------------------------------------
                         Method Statistic   p.value
 Shapiro-Wilk normality test(W) 0.9878974 0.2188639


-----------------------------------------------------------------
Homogeneity of Variances
-----------------------------------------------------------------
                              Method Statistic      p.value
 Bartlett test(Bartlett's K-squared)   16.0057 0.0003345076


-----------------------------------------------------------------
Independence from errors
-----------------------------------------------------------------
                 Method Statistic   p.value
 Durbin-Watson test(DW)  2.043002 0.5401261


-----------------------------------------------------------------
Additional Information
-----------------------------------------------------------------

CV (%) =  8.81
MStrat/MST =  0.99
Mean =  5.8433
Median =  5.8
Possible outliers =  107

-----------------------------------------------------------------
Analysis of Variance
-----------------------------------------------------------------
           Df   Sum Sq    Mean.Sq  F value        Pr(F)
trat        2 63.21213 31.6060667 119.2645 1.669669e-31
Residuals 147 38.95620  0.2650082                      




-----------------------------------------------------------------
Multiple Comparison Test: Tukey HSD
-----------------------------------------------------------------
            resp groups
virginica  6.588      a
versicolor 5.936      b
setosa     5.006      c</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/agridata/index_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="análisis-multivariado" class="level2">
<h2 class="anchored" data-anchor-id="análisis-multivariado">Análisis multivariado</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
-------------------------------------------------------------------------------
Principal Component Analysis
-------------------------------------------------------------------------------
# A tibble: 22 × 4
   PC    Eigenvalues `Variance (%)` `Cum. variance (%)`
   &lt;chr&gt;       &lt;dbl&gt;          &lt;dbl&gt;               &lt;dbl&gt;
 1 PC1         14.2            64.4                64.4
 2 PC2          5.24           23.8                88.2
 3 PC3          2.58           11.8               100  
 4 PC4          0               0                 100  
 5 PC5          0               0                 100  
 6 PC6          0               0                 100  
 7 PC7          0               0                 100  
 8 PC8          0               0                 100  
 9 PC9          0               0                 100  
10 PC10         0               0                 100  
# … with 12 more rows
-------------------------------------------------------------------------------
Factor Analysis - factorial loadings after rotation-
-------------------------------------------------------------------------------
# A tibble: 22 × 6
   VAR     FA1   FA2   FA3 Communality Uniquenesses
   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
 1 NNCF  -0.72 -0.67 -0.17           1            0
 2 WNCF  -0.65 -0.75 -0.14           1            0
 3 AWNCF  0.63  0.49  0.6            1            0
 4 WUE    1     0.04  0.03           1            0
 5 NDBF  -0.11  0.07 -0.99           1            0
 6 NDFF  -0.16 -0.24 -0.96           1            0
 7 NDBH  -0.17  0.07 -0.98           1            0
 8 PHYL   0.6   0.79 -0.12           1            0
 9 TA     0.84  0.1   0.54           1            0
10 NCF   -0.84 -0.42 -0.35           1            0
# … with 12 more rows
-------------------------------------------------------------------------------
Comunalit Mean: 1 
-------------------------------------------------------------------------------
Selection differential 
-------------------------------------------------------------------------------
# A tibble: 22 × 8
   VAR    Factor       Xo       Xs        SD  SDperc sense     goal
   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
 1 NNCF   FA1        7.20     7.86    0.650    9.02  increase   100
 2 AWNCF  FA1        8.74     8.70   -0.0425  -0.486 increase     0
 3 WUE    FA1      116.     101.    -15.0    -12.9   increase     0
 4 TA     FA1        1.42     1.35   -0.0700  -4.93  increase     0
 5 NCF    FA1       23.5     25.0     1.52     6.48  increase   100
 6 TNF    FA1       30.7     32.8     2.16     7.04  increase   100
 7 WCF    FA1      359.     395.     36.9     10.3   increase   100
 8 TWF    FA1      413.     442.     29.1      7.05  increase   100
 9 FY     FA1    30957.   33137.   2180.       7.04  increase   100
10 TSS_TA FA1        5.39     5.66    0.268    4.96  increase   100
# … with 12 more rows
------------------------------------------------------------------------------
Selected genotypes
-------------------------------------------------------------------------------
NAC_CAM IMP_ALB
-------------------------------------------------------------------------------</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "VAR"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/agridata/index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="1056"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{santos2023,
  author = {Santos, Franklin},
  title = {Análisis de Datos Experimentales Agrícolas},
  date = {2023-01-01},
  url = {https://franklinsantosm.com/posts/agridata},
  langid = {en}
}
</code></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-santos2023" class="csl-entry quarto-appendix-citeas">
Santos, Franklin. 2023. <span>“Análisis de Datos Experimentales
Agrícolas.”</span> January 1, 2023. <a href="https://franklinsantosm.com/posts/agridata">https://franklinsantosm.com/posts/agridata</a>.
</div></div></section></div> ]]></description>
  <category>agridata</category>
  <category>data science</category>
  <category>bioinformatic</category>
  <guid>https://franklinsantosm.com/posts/agridata/</guid>
  <pubDate>Sun, 01 Jan 2023 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/agridata/pic.png" medium="image" type="image/png" height="65" width="144"/>
</item>
<item>
  <title>Análisis de Componentes Principales</title>
  <dc:creator>Franklin Santos</dc:creator>
  <link>https://franklinsantosm.com/posts/componentes_principales/</link>
  <description><![CDATA[ 





<style>
body {
text-align: justify}
</style>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>El <strong>análisis de componentes principales (PCA)</strong> nos permite resumir y visualizar la información en un conjunto de datos que contiene individuos/observaciones descritos por múltiples variables cuantitativas inter-correlacionadas. Cada variable podría considerarse como una dimensión diferente. Si tiene más de 3 variables en sus conjuntos de datos, podría ser muy difícil visualizar un hiperespacio multidimensional.</p>
<p>El análisis de componentes principales se utiliza para extraer la información importante de una tabla de datos multivariados y para expresar esta información como un conjunto de algunas variables nuevas llamadas <strong>componentes principales</strong>. Estas nuevas variables corresponden a una combinación lineal de las originales. El número de componentes principales es menor o igual al número de variables originales.</p>
<p>La información de un conjunto de datos dado corresponde a la <em>variación total</em> que contiene. El objetivo de PCA es identificar direcciones (o componentes principales) a lo largo de los cuales la variación en los datos es máxima.</p>
<p>En otras palabras, PCA reduce la dimensionalidad de un dato multivariado a dos o tres componentes principales, que se pueden visualizar gráficamente, con una mínima pérdida de información.</p>
<blockquote class="blockquote">
<p>En este capítulo, describimos la idea básica de PCA y demostramos cómo calcular y visualizar PCA usando el software R. Además, mostraremos cómo identificar las variables más importantes que explican las variaciones en un conjunto de datos.</p>
</blockquote>
<p>En conjunto, el objetivo principal del análisis de componentes principales es:</p>
<blockquote class="blockquote">
<ul>
<li>identificar patrones ocultos en un conjunto de datos,</li>
<li>reducir la dimensionalidad de los datos <strong>eliminando el ruido</strong> y la <strong>redundancia</strong> en los datos,</li>
<li>identificar variables correlacionadas</li>
</ul>
</blockquote>
</section>
<section id="metodología-de-análisis" class="level2">
<h2 class="anchored" data-anchor-id="metodología-de-análisis">Metodología de análisis</h2>
<p>Instale los dos paquetes de la siguiente manera:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FactoMineR"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"factoextra"</span>))</span></code></pre></div>
</div>
<p>Cargar paquetes en R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FactoMineR"</span>)</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"factoextra"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
</div>
<section id="cargando-datos" class="level3">
<h3 class="anchored" data-anchor-id="cargando-datos">Cargando datos</h3>
<p>Usaremos los conjuntos de datos de demostración <strong>decathlon2</strong> del paquete <code>factoextra</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(decathlon2)</span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#head(decathlon2)</span></span></code></pre></div>
</div>
<p>De esta base de datos seleccionamos variables cuantitativas para el análisis de componentes principales:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#seleccionamos 27 filas y las primeras 10 variables</span></span>
<span id="cb6-2">decathlon2.active <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> decathlon2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">23</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(decathlon2.active[, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>], <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        X100m Long.jump Shot.put High.jump X400m X110m.hurdle Discus
SEBRLE  11.04      7.58    14.83      2.07 49.81        14.69  43.75
CLAY    10.76      7.40    14.26      1.86 49.37        14.05  50.72
BERNARD 11.02      7.23    14.25      1.92 48.93        14.99  40.87
YURKOV  11.34      7.09    15.19      2.10 50.42        15.31  46.26</code></pre>
</div>
</div>
</section>
<section id="código-r" class="level3">
<h3 class="anchored" data-anchor-id="código-r">Código R</h3>
<p>Se puede utilizar la función <code>PCA()</code> [paquete <em>FactoMineR</em>]. Un formato simplificado es:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">PCA</span>(X, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">scale.unit =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ncp =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">graph =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
</div>
<blockquote class="blockquote">
<ul>
<li><strong>X</strong>: un marco de datos. Las filas son individuos y las columnas son variables numéricas</li>
<li><strong>scale.unit</strong>: un valor lógico. Si es <code>TRUE</code>, los datos se escalan a la varianza de la unidad antes del análisis. Esta estandarización a la misma escala evita que algunas variables se conviertan en dominantes solo por sus grandes unidades de medida. Hace que la variable sea comparable.</li>
<li><strong>ncp</strong>: número de dimensiones mantenidas en los resultados finales.</li>
<li><strong>graph</strong>: un valor lógico. Si es <code>TRUE</code>, se muestra un gráfico.</li>
</ul>
</blockquote>
<p>El código R a continuación, calcula el análisis de componentes principales de las variables seleccionadas o activas:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FactoMineR"</span>)</span>
<span id="cb9-2">res.pca <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">PCA</span>(decathlon2.active, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">graph =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
</div>
<blockquote class="blockquote">
<p>El objeto que se crea usando la función <code>PCA()</code> contiene mucha información que se encuentra en muchas listas y matrices diferentes. Estos valores se describen en la siguiente sección.</p>
</blockquote>
</section>
<section id="extraiga-y-visualice-valores-propiosvarianzas" class="level3">
<h3 class="anchored" data-anchor-id="extraiga-y-visualice-valores-propiosvarianzas">Extraiga y visualice valores propios/varianzas:</h3>
<p>Los valores propios o varianzas miden la cantidad de variación retenida por cada componente principal. Las varianzas son grandes para los primeros componentes y pequeños para las siguientes. Es decir, las primeras PC corresponden a las direcciones con la cantidad máxima de variación en el conjunto de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extraer valores propios/varianzas</span></span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_eig</span>(res.pca)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       eigenvalue variance.percent cumulative.variance.percent
Dim.1   4.1242133        41.242133                    41.24213
Dim.2   1.8385309        18.385309                    59.62744
Dim.3   1.2391403        12.391403                    72.01885
Dim.4   0.8194402         8.194402                    80.21325
Dim.5   0.7015528         7.015528                    87.22878
Dim.6   0.4228828         4.228828                    91.45760
Dim.7   0.3025817         3.025817                    94.48342
Dim.8   0.2744700         2.744700                    97.22812
Dim.9   0.1552169         1.552169                    98.78029
Dim.10  0.1219710         1.219710                   100.00000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Visualizar valores propios/variaciones</span></span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_screeplot</span>(res.pca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">addlabels =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/componentes_principales/index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La suma de todos los valores propios da una varianza total de 10.</p>
<p>La proporción de variación explicada por cada valor propio se da en la segunda columna. Por ejemplo, 4,124 dividido por 10 es igual a 0,4124, o aproximadamente el 41,24% de la variación se explica por este primer valor propio. El porcentaje acumulado explicado se obtiene sumando las sucesivas proporciones de variación explicadas para obtener el total acumulado. Por ejemplo, 41,242% más 18,385% es igual a 59,627%, y así sucesivamente. Por lo tanto, aproximadamente el 59,627% de la variación se explica por los dos primeros valores propios juntos.</p>
<p>Los valores propios se pueden utilizar para determinar la cantidad de componentes principales que se deben retener después de la PCA (Kaiser 1961):</p>
<blockquote class="blockquote">
<ul>
<li>Un <em>valor propio</em> &gt; 1 indica que los PCs representan más varianza que la contabilizada por una de las variables originales en los datos estandarizados. Esto se usa comúnmente como un punto de corte para el cual se retienen las PCs. Esto es válido solo cuando los datos están estandarizados.</li>
<li>También puede limitar el número de componentes a ese número que representa una cierta fracción de la varianza total. Por ejemplo, si está satisfecho con el 70% de la varianza total explicada, utilice el número de componentes para lograrlo.</li>
</ul>
</blockquote>
<p>Desafortunadamente, no existe una forma objetiva bien aceptada de decidir cuántos componentes principales son suficientes. Esto dependerá del campo de aplicación específico y del conjunto de datos específico. En la práctica, tendemos a mirar los primeros componentes principales para encontrar patrones interesantes en los datos.</p>
<p>En nuestro análisis, los tres primeros componentes principales explican el 72% de la variación. Este es un porcentaje aceptablemente grande.</p>
</section>
<section id="gráfica-círculo-de-correlación" class="level3">
<h3 class="anchored" data-anchor-id="gráfica-círculo-de-correlación">Gráfica círculo de correlación</h3>
<p>La correlación entre una variable y un componente principal (PC) se utiliza como coordenadas de la variable en la PC. La representación de las variables difiere del gráfico de las observaciones: las observaciones están representadas por sus proyecciones, pero las variables están representadas por sus correlaciones (Abdi y Williams 2010).</p>
<p>Es posible controlar los colores de las variables usando sus contribuciones (“contrib”) a los ejes principales:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Control variable colors using their contributions</span></span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_pca_var</span>(res.pca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col.var=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"contrib"</span>,</span>
<span id="cb13-3">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gradient.cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#00AFBB"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E7B800"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#FC4E07"</span>),</span>
<span id="cb13-4">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Avoid text overlapping</span></span>
<span id="cb13-5">             )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/componentes_principales/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La gráfica anterior también se conoce como gráficas de correlación variable. Muestra las relaciones entre todas las variables. Se puede interpretar de la siguiente manera:</p>
<ul>
<li>Las variables correlacionadas positivamente se agrupan.</li>
<li>Las variables correlacionadas negativamente se colocan en lados opuestos del origen de la gráfica (cuadrantes opuestos).</li>
<li>La distancia entre las variables y el origen mide la calidad de las variables en el mapa de factores. Las variables que están lejos del origen están bien representadas en el mapa de factores.</li>
</ul>
</section>
<section id="contribucion-de-las-variables-a-los-ejes-principales" class="level3">
<h3 class="anchored" data-anchor-id="contribucion-de-las-variables-a-los-ejes-principales">Contribucion de las variables a los ejes principales:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Contributions of variables to PC1</span></span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_contrib</span>(res.pca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choice =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"var"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/componentes_principales/index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Contributions of variables to PC2</span></span>
<span id="cb15-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_contrib</span>(res.pca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">choice =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"var"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axes =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">top =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/componentes_principales/index_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La línea discontinua roja en el gráfico anterior indica la contribución promedio esperada. Si la contribución de las variables fuera uniforme, el valor esperado sería 1/longitud(variables) = 1/10 = 10%. Para un componente dado, una variable con una contribución mayor que este límite podría considerarse importante para contribuir al componente.</p>
<blockquote class="blockquote">
<p>Se puede observar que las variables <code>X100m</code>, <code>Long.jump</code> y <code>Pole.vault</code> contribuyen más a las dimensiones 1 y 2.</p>
</blockquote>
</section>
<section id="biplot" class="level3">
<h3 class="anchored" data-anchor-id="biplot">Biplot</h3>
<p>Para hacer un biplot simple de individuos y variables, escriba esto:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Biplot of individuals and variables</span></span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fviz_pca_biplot</span>(res.pca, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">repel =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://franklinsantosm.com/posts/componentes_principales/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>En biplot, debe centrarse principalmente en la dirección de las variables pero no en sus posiciones absolutas en la gráfica.</p>
<p>En términos generales, un biplot se puede interpretar de la siguiente manera:</p>
<ul>
<li>un individuo que está en el mismo lado de una variable dada tiene un valor alto para esta variable;</li>
<li>un individuo que está en el lado opuesto de una variable dada tiene un valor bajo para esta variable.</li>
</ul>
<p>Nota: Este post fue extraido del libro <strong>“Multivariate Analisis II”</strong></p>
</section>
</section>
<section id="referencias" class="level2">
<h2 class="anchored" data-anchor-id="referencias">Referencias</h2>
<p>Kassambara A. 2017. Multivariate Analysis: Practical Guide to Principal Component Methods in R.</p>


</section>

 ]]></description>
  <category>Biplot</category>
  <category>Componentes Principales</category>
  <category>Correlation</category>
  <guid>https://franklinsantosm.com/posts/componentes_principales/</guid>
  <pubDate>Tue, 15 Dec 2020 04:00:00 GMT</pubDate>
  <media:content url="https://franklinsantosm.com/posts/componentes_principales/featured.png" medium="image" type="image/png" height="125" width="144"/>
</item>
</channel>
</rss>
