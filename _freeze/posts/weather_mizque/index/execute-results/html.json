{
  "hash": "ba6a0003c6a714829dfd370789743f52",
  "result": {
    "markdown": "---\ntitle: \"Analisis de datos climaticos\"\ndescription: |\n  Mostramos unas figuras relacionadas a datos climaticos, las cuales pueden ser utilizados para presentar en manuscritos.\ncategories: [data science, weather analysis, plot]\nauthor:\n  - name: Franklin Santos\n    url: https://franklinsantosm.com\n    affiliation: AgriTech Bolivia\n    orcid: 0000-0002-7509-2910\n    email: franklin25santos@gmail.com\ndate: \"2023-06-25\"\nimage: ai.webp\ncitation: true\neditor_options: \n  chunk_output_type: console\n---\n\n```{=html}\n<style>\nbody {\ntext-align: justify}\n</style>\n```\n\n\n## Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\ndf <- read_excel(\"/Users/franklin/Documents/R/myblog/posts/weather_mizque/dato_diarios.xlsx\")\n```\n:::\n\n\n\n\n## analisis de temperatura\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Real data Mizque\nlibrary(metan)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'GGally':\n  method from   \n  +.gg   ggplot2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n|=========================================================|\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n| Multi-Environment Trial Analysis (metan) v1.18.0        |\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n| Author: Tiago Olivoto                                   |\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n| Type 'citation('metan')' to know how to cite metan      |\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n| Type 'vignette('metan_start')' for a short tutorial     |\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n| Visit 'https://bit.ly/pkgmetan' for a complete tutorial |\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n|=========================================================|\n```\n:::\n\n```{.r .cell-code}\ninspect(df, 2:14, plot = F)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 13 × 10\n   Variable      Class Missing Levels Valid_n    Min Median    Max Outlier Text \n   <chr>         <chr> <chr>   <chr>    <int>  <dbl>  <dbl>  <dbl>   <dbl> <chr>\n 1 \"mes\"         nume… No      -          485    1      5     12         0  <NA>\n 2 \"dia\"         nume… No      -          485    1     16     31         0  <NA>\n 3 \"estacion\"    char… No      0          485   NA     NA     NA        NA \"Lin…\n 4 \"longitud\"    nume… No      -          485  -65.4  -65.4  -65.4       0  <NA>\n 5 \"latitud\"     nume… No      -          485  -18.0  -18.0  -18.0       0  <NA>\n 6 \"altura\"      nume… No      -          485 2055   2055   2055         0  <NA>\n 7 \"Precipitaci… char… No      0          485   NA     NA     NA        NA \"Lin…\n 8 \"\\\"Temperatu… char… No      0          485   NA     NA     NA        NA \"Lin…\n 9 \"\\\"Temperatu… char… No      0          485   NA     NA     NA        NA \"Lin…\n10 \"\\\"Temperatu… char… No      0          485   NA     NA     NA        NA \"Lin…\n11 \"\\\"Humedad R… char… No      0          485   NA     NA     NA        NA \"Lin…\n12 \"\\\"Humedad R… char… No      0          485   NA     NA     NA        NA \"Lin…\n13 \"\\\"Humedad R… char… No      0          485   NA     NA     NA        NA \"Lin…\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Considering the levels of factors, .data should have 1 rows, but it\nhas 485. Use 'as_factor()' for coercing a variable to a factor.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expected three or more factor variables. The data has only 0.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Possible text fragments in variable(s) estacion, Precipitación,\n\"Temperatura Máxima\", \"Temperatura Mínima\", \"Temperatura Media\", \"Humedad\nRelativa Máxima\", \"Humedad Relativa Mínima\", \"Humedad Relativa Media\".\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ forcats::as_factor()         masks metan::as_factor()\n✖ tibble::column_to_rownames() masks metan::column_to_rownames()\n✖ dplyr::filter()              masks stats::filter()\n✖ dplyr::lag()                 masks stats::lag()\n✖ dplyr::recode_factor()       masks metan::recode_factor()\n✖ tibble::remove_rownames()    masks metan::remove_rownames()\n✖ tidyr::replace_na()          masks metan::replace_na()\n✖ tibble::rownames_to_column() masks metan::rownames_to_column()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nnames(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"gestion\"                     \"mes\"                        \n [3] \"dia\"                         \"estacion\"                   \n [5] \"longitud\"                    \"latitud\"                    \n [7] \"altura\"                      \"Precipitación\"              \n [9] \"\\\"Temperatura Máxima\\\"\"      \"\\\"Temperatura Mínima\\\"\"     \n[11] \"\\\"Temperatura Media\\\"\"       \"\\\"Humedad Relativa Máxima\\\"\"\n[13] \"\\\"Humedad Relativa Mínima\\\"\" \"\\\"Humedad Relativa Media\\\"\" \n```\n:::\n:::\n\n\n## Rename variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewvar = c(PP = \"Precipitación\", \n           Tmax = \"\\\"Temperatura Máxima\\\"\",\n           Tmin = \"\\\"Temperatura Mínima\\\"\",\n           Tmean = \"\\\"Temperatura Media\\\"\",\n           HRmax = \"\\\"Humedad Relativa Máxima\\\"\",\n           HRmin = \"\\\"Humedad Relativa Mínima\\\"\",\n           HRmean = \"\\\"Humedad Relativa Media\\\"\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndb = df%>%\n  rename(any_of(newvar))%>%\n  select(c(1,2,3, 8:14))%>%\n  mutate_if(is.character, as.numeric)%>%\n  mutate(mes = as.factor(mes), \n         gestion = as.factor(gestion))%>%\n  mutate(mes=recode(mes, \n                    '1'='Ene', \n                    '2'='Feb',\n                    '3'='Mar',\n                    '4'='Abr',\n                    '5'='May',\n                    '6'='Jun',\n                    '7'='Jul',\n                    '8'='Ago',\n                    '9'='Sep',\n                    '10'='Oct',\n                    '11'='Nov',\n                    '12'='Dic'))\ndb  \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 485 × 10\n   gestion mes     dia    PP  Tmax  Tmin Tmean HRmax HRmin HRmean\n   <fct>   <fct> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>  <dbl>\n 1 2022    Ene       1   0.4  31.4  9.92  20.6  93.2  19.3   53.4\n 2 2022    Ene       2   0    33.3 11.7   19.7  96.6  18.0   69.6\n 3 2022    Ene       3   5.1  29.6 14.4   21.0  88.7  27.2   58.7\n 4 2022    Ene       4   0    30.1 14.1   20.1  90.8  23.6   66.3\n 5 2022    Ene       5   1.5  21.9 13.4   16.7  94.6  47.8   81.0\n 6 2022    Ene       6   4.5  25.5 14.4   19.8  94.3  35.9   65.8\n 7 2022    Ene       7   0    27.3 14.7   20.4  95.6  39.9   67.3\n 8 2022    Ene       8  24.2  25.3 15.3   19.0  91.3  49.6   74.5\n 9 2022    Ene       9   0    26.9 15.5   20.2  92.7  38.5   70.6\n10 2022    Ene      10   0    24   14.5   18.5  91.9  47.2   73.0\n# ℹ 475 more rows\n```\n:::\n:::\n\n\n\n## plot temperature\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggridges)\n\nmy_theme <- \n  theme_bw() +\n  theme(legend.title = element_blank(),\n        axis.title = element_text(color = \"black\"),\n        axis.text = element_text(color = \"black\"),\n        panel.grid.minor = element_blank())\n\np1 = ggplot(\n  data = db,\n  aes(x = `Tmean`,\n      y = `mes`,\n      fill = after_stat(x))\n) +\n  geom_density_ridges_gradient(scale = 1.5, size = 0.1, \n                               rel_min_height = 0.001) +\n  scale_fill_viridis_c(name = \"Temp (ºC)\", \n                       direction = 1, option = \"H\") +\n  my_theme +\n  theme(legend.position = c(0.95, 0.4))+\n  labs(x=\"Temperatura promedio (ºC)\", y = \"Meses\")\n\np2 = ggplot(\n  data = db,\n  aes(x = `Tmin`,\n      y = `mes`,\n      fill = after_stat(x))\n) +\n  geom_density_ridges_gradient(scale = 1.5, size = 0.1, \n                               rel_min_height = 0.001) +\n  scale_fill_viridis_c(name = \"Temp (ºC)\", \n                       direction = 1, option = \"H\")+\n  my_theme+\n  theme(legend.position = c(0.9, 0.77))+\n  labs(x=\"Temperatura mínima (ºC)\", y = \"Meses\")\n\n\np3 = ggplot(\n  data = db,\n  aes(x = `Tmax`,\n      y = `mes`,\n      fill = after_stat(x))\n) +\n  geom_density_ridges_gradient(scale = 1.5, size = 0.1, \n                               rel_min_height = 0.001) +\n  scale_fill_viridis_c(name = \"Temp (ºC)\", \n                       direction = 1, option = \"H\") +\n  my_theme+\n  theme(legend.position = \"\")+\n  labs(x=\"Temperatura maxima (ºC)\", y = \"Meses\")\n\narrange_ggplot((p1),\n               (p2+p3),\n               nrow = 2,\n               tag_levels = \"a\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.801\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 1.11\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 1.2\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n## plot precipitation\n\n\n::: {.cell}\n\n```{.r .cell-code}\npp =db%>%\n  mutate(PP = na_if(PP, 0.0))%>%\n  ggplot(aes(x = mes,y = PP,\n             colour = mes\n             )) +\n  geom_boxplot(outlier.shape = NA)+\n  geom_jitter()+\n  my_theme+\n  theme(legend.position = \"\")+\n  labs(x=\"Meses\", y = \"Precipitacion (mm)\")\n```\n:::\n\n\n\n## Humedad relativa plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfechas = df%>%\n  rename(any_of(newvar))%>%\n  select(c(1,2,3, 8:14))%>%\n  mutate_if(is.character, as.numeric)%>%\n  mutate(fecha = make_datetime(gestion,mes,dia))%>%\n  select(fecha,HRmin,HRmax, HRmean)\nfechas\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 485 × 4\n   fecha               HRmin HRmax HRmean\n   <dttm>              <dbl> <dbl>  <dbl>\n 1 2022-01-01 00:00:00  19.3  93.2   53.4\n 2 2022-01-02 00:00:00  18.0  96.6   69.6\n 3 2022-01-03 00:00:00  27.2  88.7   58.7\n 4 2022-01-04 00:00:00  23.6  90.8   66.3\n 5 2022-01-05 00:00:00  47.8  94.6   81.0\n 6 2022-01-06 00:00:00  35.9  94.3   65.8\n 7 2022-01-07 00:00:00  39.9  95.6   67.3\n 8 2022-01-08 00:00:00  49.6  91.3   74.5\n 9 2022-01-09 00:00:00  38.5  92.7   70.6\n10 2022-01-10 00:00:00  47.2  91.9   73.0\n# ℹ 475 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nHR = fechas%>%\n  ggplot(aes(x=fecha, y=HRmean))+\n  geom_line()+\n  my_theme+\n  labs(x=\"Meses\", y = \"Humedad relativa promedio (%)\")\nHR\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plotly)\np = fechas%>%\nplot_ly(x=~fecha, y=~HRmean)%>%\n  add_lines()\np\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\narrange_ggplot((pp),\n               (p1+HR),\n               nrow = 2,\n               tag_levels = \"a\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 342 rows containing non-finite values (`stat_boxplot()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 342 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nPicking joint bandwidth of 0.801\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}