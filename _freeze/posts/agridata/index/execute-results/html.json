{
  "hash": "1f6404d1b6c4e8a181e937523c4da92b",
  "result": {
    "markdown": "---\ntitle: \"Análisis de datos experimentales agrícolas\"\ndescription: |\n  Uso de datos agrícolas y metodologias básicas para un tesista o investigador despues de haber culminado la etapa de campo.\ncategories: [agridata, data science, bioinformatic]\nauthor:\n  - name: Franklin Santos\n    url: https://franklinsantos.com\n    affiliation: AgriTech Bolivia\n    orcid: 0000-0002-7509-2910\n    email: franklin25santos@gmail.com\ndate: \"2023-01-01\"\nimage: plot.png\ncitation: true\neditor_options: \n  chunk_output_type: console\n---\n\n```{=html}\n<style>\nbody {\ntext-align: justify}\n</style>\n```\n\n# Introducción\n\nEl análisis de datos es una etapa esencial en el proceso de investigación y consiste en examinar y analizar los datos recopilados de manera detallada para extraer información y obtener conclusiones relevantes en función a los objetivos de la investigación. Para realizar el análisis de datos, se pueden utilizar diferentes herramientas y técnicas, generalmente se construyen tablas y figuras. Estos resultados son usados para tomar decisiones y formular conclusiones sobre los datos, y también pueden ser utilizados para mejorar y optimizar procesos y sistemas. El análisis de datos es importante ya que permite a los investigadores obtener una visión más profunda y detallada de los datos y tomar decisiones más informadas y precisas.\n\nLa etapa de análisis de datos puede resultar un reto difícil para un recien egresado o tesista. Esto debido a la falta de experiencia o conocimiento en el uso de herramientas y técnicas de análisis de datos. Debido a ello, queremos facilitar algunas herramientas de análisis, al mismo tiempo, se pretende que los interesados puedan entrenarse en el uso de R. Ya que esta herramienta estadística ofrece un sin fin de paquetes que nos ayudan a realizar los análisis de manera sencilla pero de mucha categoría científica.\n\n# Análisis de datos\n\n## Librerias\n\n\n::: {.cell}\n\n:::\n\n\n## Base de datos\n\nPara esta oportunidad daremos uso de la base de datos de `iris`. Estos datos estarán disponibles al momento de instalar R.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n  Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n1          5.1         3.5          1.4         0.2  setosa\n2          4.9         3.0          1.4         0.2  setosa\n3          4.7         3.2          1.3         0.2  setosa\n4          4.6         3.1          1.5         0.2  setosa\n5          5.0         3.6          1.4         0.2  setosa\n6          5.4         3.9          1.7         0.4  setosa\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n  Species Sepal.Length Sepal.Width Petal.Length Petal.Width\n1  setosa          5.1         3.5          1.4         0.2\n2  setosa          4.9         3.0          1.4         0.2\n3  setosa          4.7         3.2          1.3         0.2\n4  setosa          4.6         3.1          1.5         0.2\n5  setosa          5.0         3.6          1.4         0.2\n6  setosa          5.4         3.9          1.7         0.4\n```\n:::\n:::\n\n\n## Análisis descriptivo\n\nGeneralmente se puede presentar en una tabla los resultados descriptivos.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Análisis descriptivo</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> variable </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> se </th>\n   <th style=\"text-align:right;\"> kurt </th>\n   <th style=\"text-align:right;\"> skew </th>\n   <th style=\"text-align:right;\"> min </th>\n   <th style=\"text-align:right;\"> max </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Petal.Length </td>\n   <td style=\"text-align:right;\"> 3.76 </td>\n   <td style=\"text-align:right;\"> 0.14 </td>\n   <td style=\"text-align:right;\"> -1.40 </td>\n   <td style=\"text-align:right;\"> -0.27 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 6.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Petal.Width </td>\n   <td style=\"text-align:right;\"> 1.20 </td>\n   <td style=\"text-align:right;\"> 0.06 </td>\n   <td style=\"text-align:right;\"> -1.34 </td>\n   <td style=\"text-align:right;\"> -0.10 </td>\n   <td style=\"text-align:right;\"> 0.1 </td>\n   <td style=\"text-align:right;\"> 2.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sepal.Length </td>\n   <td style=\"text-align:right;\"> 5.84 </td>\n   <td style=\"text-align:right;\"> 0.07 </td>\n   <td style=\"text-align:right;\"> -0.55 </td>\n   <td style=\"text-align:right;\"> 0.31 </td>\n   <td style=\"text-align:right;\"> 4.3 </td>\n   <td style=\"text-align:right;\"> 7.9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Sepal.Width </td>\n   <td style=\"text-align:right;\"> 3.06 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.23 </td>\n   <td style=\"text-align:right;\"> 0.32 </td>\n   <td style=\"text-align:right;\"> 2.0 </td>\n   <td style=\"text-align:right;\"> 4.4 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nLa otra opción podría ser una figura `boxplot`\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Análisis de varianza\n\n\n::: {.cell}\n\n:::\n\n\nGeneralmente en la mayoría de las tesis se presenta cada ANOVA para cada variable, la cual no es muy redundante en todo el documento. Además, en las revistas científicas de impacto, este tipo de tablas no es permitido si se tiene varias variables.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: Sepal.Width\n           Df Sum Sq Mean Sq F value    Pr(>F)    \nSpecies     2 11.345  5.6725   49.16 < 2.2e-16 ***\nResiduals 147 16.962  0.1154                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\nSin embargo, se podría resumir de esta manera. En la tabla solamente se presenta aquellas variables con significancia estadística.\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Análisis de varianza</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> FV </th>\n   <th style=\"text-align:right;\"> DF </th>\n   <th style=\"text-align:left;\"> Sepal.Length </th>\n   <th style=\"text-align:left;\"> Sepal.Width </th>\n   <th style=\"text-align:left;\"> Petal.Length </th>\n   <th style=\"text-align:left;\"> Petal.Width </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Species </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> 31.61 ** </td>\n   <td style=\"text-align:left;\"> 5.67 ** </td>\n   <td style=\"text-align:left;\"> 218.55 ** </td>\n   <td style=\"text-align:left;\"> 40.21 ** </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Residuals </td>\n   <td style=\"text-align:right;\"> 147 </td>\n   <td style=\"text-align:left;\"> 0.27 </td>\n   <td style=\"text-align:left;\"> 0.12 </td>\n   <td style=\"text-align:left;\"> 0.19 </td>\n   <td style=\"text-align:left;\"> 0.04 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nUna vez identificada las diferencias estadisticas se procede a realizar pruebas de promedio para seleccionar genotipos sobresalientes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\nanova1 = aov(Sepal.Length ~ Species, data = data)\nanova2 = aov(Sepal.Width ~ Species, data = data)\nanova3 = aov(Petal.Length ~ Species, data = data)\nanova4 = aov(Petal.Width ~ Species, data = data)\n#comparacion de medias\nmedias1 = emmeans(anova1, ~Species)\nmedias2 = emmeans(anova2, ~Species)\nmedias3 = emmeans(anova3, ~Species)\nmedias4 = emmeans(anova4, ~Species)\npwpm(medias1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           setosa versicolor virginica\nsetosa     [5.01]     <.0001    <.0001\nversicolor -0.930     [5.94]    <.0001\nvirginica  -1.582     -0.652    [6.59]\n\nRow and column labels: Species\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n:::\n\n```{.r .cell-code}\npwpp(medias1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nHay otra manera de representar comparaciones graficamente\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# set a theme plot\nmy_theme = theme_bw()+\n  theme(legend.title = element_blank(),\n        axis.title = element_text(color = \"black\"),\n        axis.text = element_text(colour = \"black\"),\n        panel.grid.minor = element_blank())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\np1 = plot(medias1,\n     CIs = FALSE,\n     comparisons = TRUE,\n     xlab = \"Mean\",\n     ylab = \"Treatments\") +\n  geom_vline(xintercept = mean(data$Sepal.Length)) +\n  my_theme\n\np2 = plot(medias2,\n     CIs = FALSE,\n     comparisons = TRUE,\n     xlab = \"Mean\",\n     ylab = \"Treatments\") +\n  geom_vline(xintercept = mean(data$Sepal.Width)) +\n  my_theme\n\np3 = plot(medias3,\n     CIs = FALSE,\n     comparisons = TRUE,\n     xlab = \"Mean\",\n     ylab = \"Treatments\") +\n  geom_vline(xintercept = mean(data$Petal.Length)) +\n  my_theme\n\np4 = plot(medias4,\n     CIs = FALSE,\n     comparisons = TRUE,\n     xlab = \"Mean\",\n     ylab = \"Treatments\") +\n  geom_vline(xintercept = mean(data$Sepal.Width)) +\n  my_theme\n\narrange_ggplot((p1 + p2 + p3 + p4),\n               nrow = 2,\n               heights = c(0.6, 1),\n               tag_levels = \"a\",\n               guides = \"collect\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Utilizando paquete AgroR\nlibrary(AgroR)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'AgroR'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    desc\n```\n:::\n\n```{.r .cell-code}\nwith(data,\n     DIC(Species, Sepal.Length))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n-----------------------------------------------------------------\nNormality of errors\n-----------------------------------------------------------------\n                         Method Statistic   p.value\n Shapiro-Wilk normality test(W) 0.9878974 0.2188639\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nAs the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered normal\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n-----------------------------------------------------------------\nHomogeneity of Variances\n-----------------------------------------------------------------\n                              Method Statistic      p.value\n Bartlett test(Bartlett's K-squared)   16.0057 0.0003345076\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nAs the calculated p-value is less than the 5% significance level, H0 is rejected.Therefore, the variances are not homogeneous\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n-----------------------------------------------------------------\nIndependence from errors\n-----------------------------------------------------------------\n                 Method Statistic   p.value\n Durbin-Watson test(DW)  2.043002 0.5401261\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nAs the calculated p-value is greater than the 5% significance level, hypothesis H0 is not rejected. Therefore, errors can be considered independent\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n-----------------------------------------------------------------\nAdditional Information\n-----------------------------------------------------------------\n\nCV (%) =  8.81\nMStrat/MST =  0.99\nMean =  5.8433\nMedian =  5.8\nPossible outliers =  107\n\n-----------------------------------------------------------------\nAnalysis of Variance\n-----------------------------------------------------------------\n           Df   Sum Sq    Mean.Sq  F value        Pr(F)\ntrat        2 63.21213 31.6060667 119.2645 1.669669e-31\nResiduals 147 38.95620  0.2650082                      \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nAs the calculated p-value, it is less than the 5% significance level.The hypothesis H0 of equality of means is rejected. Therefore, at least two treatments differ\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\n-----------------------------------------------------------------\nMultiple Comparison Test: Tukey HSD\n-----------------------------------------------------------------\n            resp groups\nvirginica  6.588      a\nversicolor 5.936      b\nsetosa     5.006      c\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nYour analysis is not valid, suggests using a non-parametric test and try to transform the data\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}