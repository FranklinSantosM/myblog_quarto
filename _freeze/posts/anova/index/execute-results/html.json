{
  "hash": "17ce26223d4e7f92957afd7e142f3171",
  "result": {
    "markdown": "---\ntitle: \"Análisis de Varianza y Prueba de Promedios en R\"\ndescription: |\n  La figura de prueba de promedios de TukeyHSD es una buena opción, ya que incluye p-valor del ANVA y de la comparación de medias entre tratamientos.\ncategories:\n  - ANOVA\n  - Post hoc\n  - Inferencial Statistic\nauthor:\n  - name: Franklin Santos\n    url: https://franklinsantos.com\n    affiliation: AgriTech Bolivia\n    orcid: 0000-0002-7509-2910\ndate: \"2020-11-15\"\nimage: \"featured.png\"\n---\n\n```{=html}\n<style>\nbody {\ntext-align: justify}\n</style>\n```\n\n\n## Introducción\n\nEl análisis de varianza es una prueba estadística para determinar si dos o más medias poblacionales son diferentes entre si. En otras palabras, se usa para comparar dos o más grupos para ver si son significativamente diferentes.\n\nEn el resto del post lo comentaremos desde un punto de vista más práctico y en particular abordaremos los siguientes puntos:\n\n-   el objetivo del análisis de varianza y cuándo debe usarse\n-   cómo realizar el ANVA en R\n-   cómo interpretar los resultados del ANVA\n-   comprender la noción de prueba de promedios e interpretar los resultados\n-   cómo visualizar los resultados de ANVA y pruebas de promedio\n\n## Datos\n\nEl dato que se utilizará es `iris`, que se encuentra en la base de datos de R. Estos datos como tratamientos tienen tres especies (`setosa`, `versicolor` y `virginica`) y cuatro variables (`Sepal.Length`, `Sepal.Width`, `Petal.Length` y `Petal.Width`) cuantitativas\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#paquetes R a utilizar\nlibrary(tidyverse)\nlibrary(easyanova)\nlibrary(car)\nlibrary(lattice)\nlibrary(multcomp)\nlibrary(ggpubr)\nlibrary(rstatix)\n```\n:::\n\n\nLa librería de `easyanova` es un paquete para realizar análisis de experimentos agrícolas y animales. Las funciones de esta librería son fáciles de usar. Realiza análisis en varios diseños, con datos balanceados y no balanceados.\n\nSalida de datos a utilizar:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#datos\ntibble(iris)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 150 × 5\n   Sepal.Length Sepal.Width Petal.Length Petal.Width Species\n          <dbl>       <dbl>        <dbl>       <dbl> <fct>  \n 1          5.1         3.5          1.4         0.2 setosa \n 2          4.9         3            1.4         0.2 setosa \n 3          4.7         3.2          1.3         0.2 setosa \n 4          4.6         3.1          1.5         0.2 setosa \n 5          5           3.6          1.4         0.2 setosa \n 6          5.4         3.9          1.7         0.4 setosa \n 7          4.6         3.4          1.4         0.3 setosa \n 8          5           3.4          1.5         0.2 setosa \n 9          4.4         2.9          1.4         0.2 setosa \n10          4.9         3.1          1.5         0.1 setosa \n# … with 140 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#inspección de datos\np <- ggplot(iris) +\n  aes(x = Species, y = Sepal.Width, color = Species) +\n  geom_jitter() +\n  theme(legend.position = \"none\")\n\nlibrary(plotly)\nfig <- ggplotly(p)\n\nfig\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-ce796eba51cdec99cccc\" style=\"width:100%;height:464px;\" class=\"plotly html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ce796eba51cdec99cccc\">{\"x\":{\"data\":[{\"x\":[0.955489985272288,0.69596754796803,0.872744095139205,1.37154724691063,1.18982841782272,1.18485031872988,1.07471461687237,0.671208545938134,0.796806747838855,1.09080755598843,0.715368576161563,1.10857377462089,1.16407545655966,1.00408339891583,0.960473902523518,1.24924752898514,0.929630785994232,0.965769836120307,0.873710967600346,1.05325581096113,0.722965094447136,1.19477898329496,0.732604693621397,0.956151522882283,1.39326435122639,0.870359304361045,0.795355080068111,1.17964635770768,1.07724730297923,1.3198099186644,0.846006971411407,0.728493247553706,1.08080704305321,1.07816332317889,1.18180160243064,1.02003907039762,1.29900873694569,0.79017689768225,0.690972563065589,0.653491246700287,1.26049577575177,0.835418589785695,0.675010156445205,0.683341466076672,1.28932571411133,1.06717066187412,0.797120808809996,0.617270628735423,1.03881051000208,0.849415248073637],\"y\":[3.50631731214002,3.03980338184163,3.21122351035476,3.06824044775218,3.63001142516732,3.91672568790615,3.42521944174543,3.42616622693837,2.88369217891246,3.09003512697294,3.68191356532276,3.43563361115754,2.99185226591304,2.97288805555552,3.98301889160648,4.38861818104982,3.90696409191936,3.51318989928812,3.78660068098456,3.78366718813777,3.36926085611805,3.68536903968081,3.57256909949705,3.27290266914293,3.40810191255063,3.02165879512206,3.3640852092579,3.51783674919978,3.4154662810266,3.23335809247568,3.07524983061478,3.37908992584795,4.0917848127149,4.23337861601263,3.08799442054704,3.17795460540801,3.53284207388759,3.58455985810608,2.98055924767628,3.37001699445769,3.53115693381056,2.27903330076486,3.1826905830577,3.52962481902912,3.77750206869096,3.0158647843264,3.83037431018427,3.21043754372746,3.71425311816856,3.29103707348928],\"text\":[\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.6<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.9<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 2.9<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.7<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 4.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 4.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.9<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.8<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.8<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.7<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.6<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.3<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 4.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 4.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.1<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.6<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.4<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 2.3<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.5<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.8<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.0<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.8<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.2<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.7<br />Species: setosa\",\"Species: setosa<br />Sepal.Width: 3.3<br />Species: setosa\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"opacity\":1,\"size\":5.66929133858268,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(248,118,109,1)\"}},\"hoveron\":\"points\",\"name\":\"setosa\",\"legendgroup\":\"setosa\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.98575436025858,1.65704542603344,1.69643614850938,1.88404482025653,1.79750677160919,2.32684564273804,2.0777678783983,2.37648473586887,1.62379084415734,1.87750804964453,2.27994336057454,2.06168957278132,2.1593329584226,2.35229795239866,1.61459012553096,2.25976224914193,2.27587170954794,2.22675132192671,1.85142534039915,2.343130579032,2.18243980668485,2.09703622534871,2.35282220784575,2.37990624327213,1.92539692092687,1.85408688466996,1.85520363114774,2.00358609389514,2.25428008548915,1.64764319453388,1.87784673944116,2.10629031900316,1.72818292677402,2.08411338180304,1.67119427248836,1.70073127727956,1.72040430326015,2.29853434115648,1.86684809494764,1.92762438151985,1.64678645189852,1.7544084765017,1.66083756908774,1.76239741202444,1.99948426485062,2.03867296241224,2.23486524950713,2.29505056161433,2.2780677171424,2.18210489097983],\"y\":[3.22673038149253,3.21740653986111,3.11246656320989,2.31395376263186,2.81461090203375,2.7715633392334,3.26894200617447,2.37512286137789,2.87120203921571,2.67804366024211,2.00165280859917,3.03360419228673,2.21060016524047,2.91426240833476,2.8617695113644,3.12927222000435,2.98976560164243,2.69149581743404,2.20722408877686,2.51943185236305,3.17729272313416,2.79292995044962,2.50693609600887,2.80453233862296,2.88101563656703,2.96651865307242,2.82820373006165,3.02139394303784,2.91122639821842,2.62594658061862,2.4161018198356,2.43595328439027,2.70208153298125,2.67285722168163,3.03371463483199,3.39820732880384,3.09429406447336,2.33641918918118,2.98153216639534,2.46690946148708,2.6315272217989,2.96977794157341,2.62984454257414,2.2778191251494,2.7097911686264,2.98477831603959,2.93264201844111,2.88861168203875,2.48453970937058,2.82303074650466],\"text\":[\"Species: versicolor<br />Sepal.Width: 3.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.1<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.3<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.3<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.4<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.1<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.5<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.2<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.5<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.6<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.4<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.4<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.4<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.1<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.3<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.5<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.6<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.6<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.3<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.7<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 3.0<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.9<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.5<br />Species: versicolor\",\"Species: versicolor<br />Sepal.Width: 2.8<br />Species: versicolor\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"opacity\":1,\"size\":5.66929133858268,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,186,56,1)\"}},\"hoveron\":\"points\",\"name\":\"versicolor\",\"legendgroup\":\"versicolor\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[3.31285714171827,2.96917729191482,3.12584995962679,3.03489196468145,2.91164683084935,3.02871746439487,3.23502848669887,2.8387076633051,3.13417286574841,2.88790512364358,2.96452687084675,2.66100040748715,3.23082562536001,3.26379421446472,2.82367673106492,2.78372948337346,3.36439338531345,3.18961681779474,3.01165460590273,2.62015309631825,2.99721660185605,3.16076059751213,2.82472273241729,3.21496488675475,3.12446528244764,3.33240485824645,3.06299204565585,3.04099519737065,2.99668236542493,2.87690150272101,2.89335476253182,3.32206505872309,3.10044552125037,2.89112205728888,3.08990203253925,3.13904165718704,2.65614640507847,2.98130898699164,2.67316546346992,2.8970636934042,2.68859927561134,3.19041553400457,3.22391232866794,3.08675300162286,2.6807563258335,2.89315888341516,2.88883519656956,3.03150648195297,2.82114773932844,3.30126214101911],\"y\":[3.29702186102048,2.71418977934867,2.97998535593972,2.86967911580577,2.99293436808512,2.99792596561834,2.50288478374481,2.92031901147217,2.46463713280857,3.57038165098056,3.21803815329447,2.70059397779405,3.00064153965563,2.51488465702161,2.8024927120842,3.16376272052526,3.01438315687701,3.76381353907287,2.63757625982165,2.18149897512049,3.23106089988723,2.83001978378743,2.76637466538697,2.67490342603996,3.29247707050294,3.20540515540168,2.76055101186037,3.03242176936939,2.82961036030203,3.0015026877448,2.8062324882485,3.80438729433343,2.76052807467058,2.76543769592419,2.56257939739153,2.97139225639403,3.39768541567028,3.08581962963566,3.02142047701403,3.12112854130566,3.06640320904553,3.10401457170025,2.68075296983123,3.20875245833769,3.32209550116211,2.9787341620028,2.50897728884593,3.03706670355052,3.38377638354897,3.03615347370505],\"text\":[\"Species: virginica<br />Sepal.Width: 3.3<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.7<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.9<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.5<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.9<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.5<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.6<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.7<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.5<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.6<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.7<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.3<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.8<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.6<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.4<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.1<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.1<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.1<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.1<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.7<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.2<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.3<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 2.5<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.4<br />Species: virginica\",\"Species: virginica<br />Sepal.Width: 3.0<br />Species: virginica\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"opacity\":1,\"size\":5.66929133858268,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(97,156,255,1)\"}},\"hoveron\":\"points\",\"name\":\"virginica\",\"legendgroup\":\"virginica\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":26.2283105022831,\"r\":7.30593607305936,\"b\":40.1826484018265,\"l\":43.1050228310502},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.4,3.6],\"tickmode\":\"array\",\"ticktext\":[\"setosa\",\"versicolor\",\"virginica\"],\"tickvals\":[1,2,3],\"categoryorder\":\"array\",\"categoryarray\":[\"setosa\",\"versicolor\",\"virginica\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Species\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[1.88230453997664,4.50796644967236],\"tickmode\":\"array\",\"ticktext\":[\"2.0\",\"2.5\",\"3.0\",\"3.5\",\"4.0\",\"4.5\"],\"tickvals\":[2,2.5,3,3.5,4,4.5],\"categoryorder\":\"array\",\"categoryarray\":[\"2.0\",\"2.5\",\"3.0\",\"3.5\",\"4.0\",\"4.5\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.689497716895},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Sepal.Width\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"1c672f0bc001\":{\"x\":{},\"y\":{},\"colour\":{},\"type\":\"scatter\"}},\"cur_data\":\"1c672f0bc001\",\"visdat\":{\"1c672f0bc001\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## Objetivo del ANVA\n\nComo se mencionó en la introducción, el ANVA se usa para comparar grupos (en la práctica, 3 o más grupos). De manera más general, se utiliza para:\n\n-   estudiar si las mediciones son similares en diferentes modalidades (también llamadas niveles o tratamientos en el contexto de ANVA) de una variable categórica\n-   comparar el impacto de los diferentes niveles de una variable categórica sobre una variable cuantitativa\n-   explicar una variable cuantitativa basada en una variable cualitativa\n\n## Supuestos subyacentes de ANVA\n\nComo ocurre con muchas pruebas estadísticas, hay algunas suposiciones que deben cumplirse para poder interpretar los resultados. Cuando no se cumplen uno o varios supuestos, aunque técnicamente es posible realizar estas pruebas, sería incorrecto interpretar los resultados y confiar en las conclusiones.\n\n### 1. Tipo de variable\n\nLas variables dependientes `Sepal.Length`, `Sepal.Width`, `Petal.Length` y `Petal.Width` es una variable **cuantitativa** y la variable independiente `Species` es **cualitativa** (con 3 niveles correspondientes a las 3 especies). Así que tenemos una combinación de los dos tipos de variables y se cumple este supuesto.\n\n### 2. Independencia\n\nSe asume la independencia de las observaciones ya que los datos se han recopilado de una parte de la población seleccionada al azar y las mediciones dentro y entre las 3 muestras no están relacionadas.\n\nEl supuesto de independencia se verifica con mayor frecuencia con base en el diseño del experimento y en el buen control de las condiciones experimentales, como es el caso aquí. Sin embargo, si realmente desea probarlo de manera más formal, puede probarlo mediante una prueba estadística: la prueba de Durbin-Watson (en R: `durbinWatsonTest(res_lm)` donde `res_lm` es un modelo lineal). La hipótesis nula de esta prueba especifica un coeficiente de autocorrelación = 0, mientras que la hipótesis alternativa especifica un coeficiente de autocorrelación ≠ 0.\n\n### 3. Normalidad\n\nRecuerde que la **normalidad** de los residuos se puede probar visualmente mediante un histograma y un gráfico QQ, y/o formalmente mediante una prueba de normalidad (prueba de Shapiro-Wilk, por ejemplo).\n\nAntes de verificar el supuesto de normalidad, primero debemos calcular el ANVA. Luego guardamos los resultados en `res_aov`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres_aov <- aov(Sepal.Width ~ Species,\n  data = iris\n)\n```\n:::\n\n\nAhora podemos comprobar la normalidad visualmente:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 2)) # combine plots\n\n# histogram\nhist(res_aov$residuals)\n\n# QQ-plot\nqqPlot(res_aov$residuals,\n  id = FALSE # id = FALSE to remove point identification\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nA partir del histograma y el gráfico QQ anteriores, ya podemos ver que el supuesto de normalidad parece cumplirse. De hecho, el histograma forma aproximadamente una curva de campana, lo que indica que los residuos siguen una distribución normal. Además, los puntos en las gráficas QQ siguen aproximadamente la línea recta y la mayoría de ellos están dentro de las bandas de confianza, lo que también indica que los residuos siguen aproximadamente una distribución normal.\n\nAlgunos investigadores se detienen aquí y asumen que se cumple la normalidad, mientras que otros también prueban la suposición a través de una prueba estadística formal. Es su elección probarlo *(i)* solo visualmente, *(ii)* solo a través de una prueba de normalidad, o *(iii)* tanto visualmente como a través de una prueba de normalidad. Sin embargo, tenga en cuenta los dos puntos siguientes:\n\n> 1.  ANVA es bastante robusto a pequeñas desviaciones de la normalidad. Esto significa que no es un problema (desde la perspectiva de la interpretación de los resultados de ANVA) si un pequeño número de puntos se desvía ligeramente de la normalidad,\n> 2.  Las pruebas de normalidad son a veces bastante conservadoras, lo que significa que la hipótesis nula de normalidad puede rechazarse debido a una desviación limitada de la normalidad. Este es especialmente el caso con muestras grandes, ya que la potencia de la prueba aumenta con el tamaño de la muestra.\n\nEn la práctica, se tiende a preferir el (i) enfoque visual solamente, pero nuevamente, esto es una cuestión de elección personal y también depende del contexto del análisis. Tambien, puede utilizar la prueba de Shapiro-Wilk o la prueba de Kolmogorov-Smirnov, entre otras.\n\n### 4. Igualdad de varianzas - homogeneidad\n\nSuponiendo que los residuos siguen una distribución normal, ahora es el momento de comprobar si las varianzas son iguales entre especies o no. El resultado tendrá un impacto en si usamos el ANVA o la prueba de Welch.\n\nEsto se puede verificar nuevamente visualmente, a través de una gráfica de caja o gráfica de puntos, o más formalmente a través de una prueba estadística (la prueba de Levene, entre otras).\n\nVisualmente tenemos:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Boxplot\nboxplot(Sepal.Width ~ Species,\n  data = iris\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dotplot\n\ndotplot(Sepal.Width ~ Species,\n  data = iris\n)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nTanto la gráfica de boxplot como la gráfica de puntos muestran una variación similar para las diferentes especies. En el boxplot, esto se puede ver por el hecho de que las cajas y los bigotes tienen un tamaño comparable para todas las especies. Hay un par de valores atípicos como lo muestran los puntos fuera de los bigotes, pero esto no cambia el hecho de que la dispersión es más o menos la misma entre las diferentes especies.\n\nEn la gráfica de puntos, esto se puede ver por el hecho de que los puntos para las 3 especies tienen más o menos el mismo rango, un signo de la dispersión y, por lo tanto, la varianza es similar.\n\nAl igual que el supuesto de normalidad, si cree que el enfoque visual no es suficiente, puede probar formalmente la igualdad de las varianzas con una prueba de *Levene* o de *Bartlett*. Observe que la prueba de Levene es menos sensible a las desviaciones de la distribución normal que la prueba de Bartlett.\n\nLas hipótesis nula y alternativa para ambas pruebas son:\n\n-   H0: las variaciones son iguales\n-   H1: al menos una varianza es diferente\n\nEn R, la prueba de Levene se puede realizar gracias a la función `leveneTest()` del paquete `{car}`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Levene's test\n\nleveneTest(Sepal.Width ~ Species,\n  data = iris\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLevene's Test for Homogeneity of Variance (center = median)\n       Df F value Pr(>F)\ngroup   2  0.5902 0.5555\n      147               \n```\n:::\n:::\n\n\nSiendo el *p*-valor mayor que el nivel de significancia de 0.05, no rechazamos la hipótesis nula, por lo que no podemos rechazar la hipótesis de que las varianzas son iguales entre especies (*p*-valor = 0.556).\n\nEste resultado también está en línea con el enfoque visual, por lo que la homogeneidad de las variaciones se cumple tanto visual como formalmente.\n\n## Análisis de varianza en R\n\nEl ANVA puede ayudarnos a hacer inferencias sobre la población dada la muestra en cuestión y ayudarnos a responder la pregunta de investigación \"¿Existe diferencia en ancho de sépalo para las 3 especies?\".\n\nEl ANVA en R se puede realizar de varias formas, de las cuales tres se presentan a continuación:\n\na). Con la función `oneway.test()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# primer metodo:\noneway.test(Sepal.Width ~ Species,\n  data = iris,\n  var.equal = TRUE # asumiendo varianzas iguales\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-way analysis of means\n\ndata:  Sepal.Width and Species\nF = 49.16, num df = 2, denom df = 147, p-value < 2.2e-16\n```\n:::\n:::\n\n\nb). Con las funciones de `summary()` y `aov()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 2nd method:\nres_aov <- aov(Sepal.Width ~ Species,\n  data = iris\n)\n\nsummary(res_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum Sq Mean Sq F value Pr(>F)    \nSpecies       2  11.35   5.672   49.16 <2e-16 ***\nResiduals   147  16.96   0.115                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nComo puede ver en los dos resultados anteriores, la estadística de prueba (F = en el primer método y el valor F en el segundo) y el *p*-valor (*p*-valor en el primer método y Pr (\\> F) en el segundo) son exactamente iguales para ambos métodos, lo que significa que en caso de variaciones iguales, los resultados y las conclusiones no cambiarán.\n\nLa ventaja del primer método es que es fácil cambiar del ANVA (utilizado cuando las variaciones son iguales) a la prueba de Welch (utilizado cuando las variaciones son desiguales). Esto se puede hacer reemplazando `nvar.equal = TRUE` por `var.equal = FALSE`, como se presenta a continuación:\n\n\n::: {.cell}\n\n```{.r .cell-code}\noneway.test(Sepal.Width ~ Species,\n  data = iris,\n  var.equal = FALSE # asumiendo variaciones desiguales\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-way analysis of means (not assuming equal variances)\n\ndata:  Sepal.Width and Species\nF = 45.012, num df = 2.000, denom df = 97.402, p-value = 1.433e-14\n```\n:::\n:::\n\n\nSin embargo, la ventaja del segundo método es que:\n\n-   Se imprime la tabla ANVA completa (con grados de libertad, cuadrados medios, etc.), lo que puede ser de interés en algunos casos (teóricos).\n-   los resultados del ANVA (`res_aov`) se pueden guardar para su uso posterior (especialmente útil para pruebas de promedio)\n\n### Interpretaciones de los resultados del ANVA\n\nDado que el p-valor es menor que 0.05, rechazamos la hipótesis nula, por lo que rechazamos la hipótesis de que todas las medias son iguales. Por tanto, podemos concluir que al menos una especie es diferente a las otras en términos del ancho de sépalo (*p*-valor \\<2.2e-16).\n\n### ¿Que sigue?\n\nSi **no se rechaza la hipótesis nula** (*p*-valor ≥ 0,05), significa que no rechazamos la hipótesis de que todos los grupos son iguales. El ANVA más o menos se detiene aquí. Por supuesto, se pueden realizar otros tipos de análisis, pero, dados los datos disponibles, no pudimos probar que al menos un grupo fuera diferente, por lo que generalmente no avanzamos más con el ANVA.\n\nPor el contrario, *si y solo si* se **rechaza la hipótesis nula** (como es nuestro caso ya que el *p*-valor \\< 0.05), probamos que al menos un grupo es diferente. Podemos decidir detenernos aquí si solo estamos interesados en probar si todas las especies son iguales en términos de ancho de sépalo.\n\nPero la mayoría de las veces, cuando demostramos gracias a un ANVA que al menos un grupo es diferente, también nos interesa saber cuál es diferente. Para probar esto, necesitamos usar otros tipos de prueba, denominados pruebas de promedio o pruebas de comparación múltiple por pares. Esta familia de pruebas estadísticas es el tema de las siguientes secciones.\n\n## Pruebas de promedio en R y su interpretación\n\nLas pruebas de promedio son una familia de pruebas estadísticas, por lo que hay varias. Las más utilizadas son las pruebas **Tukey HSD** y **Dunnett**:\n\n-   Tukey HSD se utiliza para comparar **todos los grupos** entre sí (por lo que todas las posibles comparaciones de 2 grupos).\n-   Dunnett se utiliza para hacer comparaciones con un **grupo de referencia**. Por ejemplo, considere 2 grupos de tratamiento y un grupo de control. Si solo desea comparar los 2 grupos de tratamiento con respecto al grupo de control y no desea comparar los 2 grupos de tratamiento entre sí, se prefiere la prueba de Dunnett.\n\nAmbas pruebas se presentan en las siguientes secciones.\n\n### Prueba de Tukey HSD\n\nEn nuestro caso, dado que no existe una especie de \"referencia\" y nos interesa comparar todas las especies, vamos a utilizar la prueba de Tukey HSD.\n\nEn R, la prueba de Tukey HSD se realiza de la siguiente manera. Aquí es donde el *segundo método* para realizar el ANVA resulta útil porque los resultados (`res_aov`) se reutilizan para la prueba de promedios:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Prueba de Tukey HSD:\npost_test <- glht(res_aov,\n  linfct = mcp(Species = \"Tukey\")\n)\nsummary(post_test)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\t Simultaneous Tests for General Linear Hypotheses\n\nMultiple Comparisons of Means: Tukey Contrasts\n\n\nFit: aov(formula = Sepal.Width ~ Species, data = iris)\n\nLinear Hypotheses:\n                            Estimate Std. Error t value Pr(>|t|)    \nversicolor - setosa == 0    -0.65800    0.06794  -9.685  < 1e-04 ***\nvirginica - setosa == 0     -0.45400    0.06794  -6.683  < 1e-04 ***\nvirginica - versicolor == 0  0.20400    0.06794   3.003  0.00871 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n(Adjusted p values reported -- single-step method)\n```\n:::\n:::\n\n\nEn el resultado de la prueba Tukey HSD, nos interesa la tabla que se muestra después de las `Hipótesis lineales`: más precisamente, en la primera y última columna de la tabla. La primera columna muestra las comparaciones que se han realizado; la última columna (`Pr(>|t|)`) muestra los *p*-valores ajustados para cada comparación (con la hipótesis nula siendo los dos grupos iguales y la hipótesis alternativa siendo los dos grupos diferentes).\n\nSon estos *p*-valores ajustados los que se utilizan para probar si dos grupos son significativamente diferentes o no. En nuestro ejemplo, probamos:\n\n1.  versicolor vs setosa (línea `versicolor - setosa == 0`)\n2.  virginica vs setosa (línea `virginica - setosa == 0`)\n3.  virginica vs versicolor (línea `virginica - versicolor == 0`)\n\nLos tres p-valores son menores que 0.05, por lo que rechazamos la hipótesis nula para todas las comparaciones, lo que significa que todas las especies son **significativamente diferentes** en términos de ancho de sépalo.\n\nTenga en cuenta que la prueba Tukey HSD también se puede realizar en R con la función `TukeyHSD()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(res_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Sepal.Width ~ Species, data = iris)\n\n$Species\n                       diff         lwr        upr     p adj\nversicolor-setosa    -0.658 -0.81885528 -0.4971447 0.0000000\nvirginica-setosa     -0.454 -0.61485528 -0.2931447 0.0000000\nvirginica-versicolor  0.204  0.04314472  0.3648553 0.0087802\n```\n:::\n:::\n\n\nCon este código, es la columna `p adj` (también la última columna) la que interesa. Tenga en cuenta que las conclusiones son las mismas que las anteriores: todas las especies son significativamente diferentes en términos de ancho de sépalo.\n\n## Visualización de ANVA y pruebas de promedio\n\nPara realizar de forma más fácil un análisis de varianza, se puede usar la librería `easyanova` para analizar diferentes diseños experimentales.\n\n### Análisis de varianza con `easyanova`\n\nPara proceder con ANVA los datos de `iris` se selecciona y ordena para dar uso con el paquete `easyanova`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfsdata <- iris %>%\n  dplyr::select(Species, Sepal.Width)\ntibble(fsdata)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 150 × 2\n   Species Sepal.Width\n   <fct>         <dbl>\n 1 setosa          3.5\n 2 setosa          3  \n 3 setosa          3.2\n 4 setosa          3.1\n 5 setosa          3.6\n 6 setosa          3.9\n 7 setosa          3.4\n 8 setosa          3.4\n 9 setosa          2.9\n10 setosa          3.1\n# … with 140 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Análisis de varianza para DCA\n\nr1 <- ea1(data = fsdata, # Base de datos\n          design = 1, # Diseño experimental: 1=DCA, 2=DBCA, etc.\n          alpha = 0.05) # Probabilidad estadística\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\nr1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$`Analysis of variance`\n            df type I SS mean square F value    p>F\ntreatments   2   11.3449      5.6725   49.16 <0.001\nResiduals  147   16.9620      0.1154       -      -\n\n$Means\n   treatment  mean standard.error tukey snk duncan t scott_knott\n1     setosa 3.428          0.048     a   a      a a           a\n2  virginica 2.974          0.048     b   b      b b           b\n3 versicolor 2.770          0.048     c   c      c c           c\n\n$`Multiple comparison test`\n                    pair contrast p(tukey) p(snk) p(duncan)   p(t)\n1     setosa - virginica    0.454   0.0000 0.0000    0.0000 0.0000\n2    setosa - versicolor    0.658   0.0000 0.0000    0.0000 0.0000\n3 virginica - versicolor    0.204   0.0087 0.0031    0.0031 0.0031\n\n$`Residual analysis`\n$`Residual analysis`$`residual analysis`\n                               values\np.value Shapiro-Wilk test      0.3230\np.value Bartlett test          0.3515\ncoefficient of variation (%)  11.1100\nfirst value most discrepant   42.0000\nsecond value most discrepant  16.0000\nthird value most discrepant  118.0000\n\n$`Residual analysis`$residuals\n     1      2      3      4      5      6      7      8      9     10     11 \n 0.072 -0.428 -0.228 -0.328  0.172  0.472 -0.028 -0.028 -0.528 -0.328  0.272 \n    12     13     14     15     16     17     18     19     20     21     22 \n-0.028 -0.428 -0.428  0.572  0.972  0.472  0.072  0.372  0.372 -0.028  0.272 \n    23     24     25     26     27     28     29     30     31     32     33 \n 0.172 -0.128 -0.028 -0.428 -0.028  0.072 -0.028 -0.228 -0.328 -0.028  0.672 \n    34     35     36     37     38     39     40     41     42     43     44 \n 0.772 -0.328 -0.228  0.072  0.172 -0.428 -0.028  0.072 -1.128 -0.228  0.072 \n    45     46     47     48     49     50     51     52     53     54     55 \n 0.372 -0.428  0.372 -0.228  0.272 -0.128  0.430  0.430  0.330 -0.470  0.030 \n    56     57     58     59     60     61     62     63     64     65     66 \n 0.030  0.530 -0.370  0.130 -0.070 -0.770  0.230 -0.570  0.130  0.130  0.330 \n    67     68     69     70     71     72     73     74     75     76     77 \n 0.230 -0.070 -0.570 -0.270  0.430  0.030 -0.270  0.030  0.130  0.230  0.030 \n    78     79     80     81     82     83     84     85     86     87     88 \n 0.230  0.130 -0.170 -0.370 -0.370 -0.070 -0.070  0.230  0.630  0.330 -0.470 \n    89     90     91     92     93     94     95     96     97     98     99 \n 0.230 -0.270 -0.170  0.230 -0.170 -0.470 -0.070  0.230  0.130  0.130 -0.270 \n   100    101    102    103    104    105    106    107    108    109    110 \n 0.030  0.326 -0.274  0.026 -0.074  0.026  0.026 -0.474 -0.074 -0.474  0.626 \n   111    112    113    114    115    116    117    118    119    120    121 \n 0.226 -0.274  0.026 -0.474 -0.174  0.226  0.026  0.826 -0.374 -0.774  0.226 \n   122    123    124    125    126    127    128    129    130    131    132 \n-0.174 -0.174 -0.274  0.326  0.226 -0.174  0.026 -0.174  0.026 -0.174  0.826 \n   133    134    135    136    137    138    139    140    141    142    143 \n-0.174 -0.174 -0.374  0.026  0.426  0.126  0.026  0.126  0.126  0.126 -0.274 \n   144    145    146    147    148    149    150 \n 0.226  0.326  0.026 -0.474  0.026  0.426  0.026 \n\n$`Residual analysis`$`standardized residuals`\n          1           2           3           4           5           6 \n 0.21339641 -1.26852308 -0.67575529 -0.97213918  0.50978030  1.39893200 \n          7           8           9          10          11          12 \n-0.08298749 -0.08298749 -1.56490698 -0.97213918  0.80616420 -0.08298749 \n         13          14          15          16          17          18 \n-1.26852308 -1.26852308  1.69531589  2.88085148  1.39893200  0.21339641 \n         19          20          21          22          23          24 \n 1.10254810  1.10254810 -0.08298749  0.80616420  0.50978030 -0.37937139 \n         25          26          27          28          29          30 \n-0.08298749 -1.26852308 -0.08298749  0.21339641 -0.08298749 -0.67575529 \n         31          32          33          34          35          36 \n-0.97213918 -0.08298749  1.99169979  2.28808369 -0.97213918 -0.67575529 \n         37          38          39          40          41          42 \n 0.21339641  0.50978030 -1.26852308 -0.08298749  0.21339641 -3.34321036 \n         43          44          45          46          47          48 \n-0.67575529  0.21339641  1.10254810 -1.26852308  1.10254810 -0.67575529 \n         49          50          51          52          53          54 \n 0.80616420 -0.37937139  1.27445076  1.27445076  0.97806686 -1.39300432 \n         55          56          57          58          59          60 \n 0.08891517  0.08891517  1.57083466 -1.09662042  0.38529907 -0.20746873 \n         61          62          63          64          65          66 \n-2.28215601  0.68168296 -1.68938822  0.38529907  0.38529907  0.97806686 \n         67          68          69          70          71          72 \n 0.68168296 -0.20746873 -1.68938822 -0.80023652  1.27445076  0.08891517 \n         73          74          75          76          77          78 \n-0.80023652  0.08891517  0.38529907  0.68168296  0.08891517  0.68168296 \n         79          80          81          82          83          84 \n 0.38529907 -0.50385263 -1.09662042 -1.09662042 -0.20746873 -0.20746873 \n         85          86          87          88          89          90 \n 0.68168296  1.86721855  0.97806686 -1.39300432  0.68168296 -0.80023652 \n         91          92          93          94          95          96 \n-0.50385263  0.68168296 -0.50385263 -1.39300432 -0.20746873  0.68168296 \n         97          98          99         100         101         102 \n 0.38529907  0.38529907 -0.80023652  0.08891517  0.96621151 -0.81209188 \n        103         104         105         106         107         108 \n 0.07705981 -0.21932408  0.07705981  0.07705981 -1.40485967 -0.21932408 \n        109         110         111         112         113         114 \n-1.40485967  1.85536320  0.66982761 -0.81209188  0.07705981 -1.40485967 \n        115         116         117         118         119         120 \n-0.51570798  0.66982761  0.07705981  2.44813099 -1.10847578 -2.29401137 \n        121         122         123         124         125         126 \n 0.66982761 -0.51570798 -0.51570798 -0.81209188  0.96621151  0.66982761 \n        127         128         129         130         131         132 \n-0.51570798  0.07705981 -0.51570798  0.07705981 -0.51570798  2.44813099 \n        133         134         135         136         137         138 \n-0.51570798 -0.51570798 -1.10847578  0.07705981  1.26259540  0.37344371 \n        139         140         141         142         143         144 \n 0.07705981  0.37344371  0.37344371  0.37344371 -0.81209188  0.66982761 \n        145         146         147         148         149         150 \n 0.96621151  0.07705981 -1.40485967  0.07705981  1.26259540  0.07705981 \n```\n:::\n:::\n\n\nEn la salida se puede observar el resultado de `análisis de varianza`, `prueba de promedios` y `comparación múltiple de medias`. Estas salidas son muy fáciles de obtener y poder interpretar las mismas. Asimismo, se puede verificar la `normalidad` y `coeficiente de variación` de los datos.\n\n### Visualización de la prueba de promedios\n\nSi está interesado en incluir resultados de ANVA y pruebas de promedio directamente en los boxplot, aquí hay un fragmento de código que puede ser de su interés:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#paquete para p-valor en la visualización de prueba de promedios\n\ndat <- iris\n# Editar desde aquí\nx <- which(names(dat) == \"Species\") #variable de agrupación\ny <- which(names(dat) == \"Sepal.Width\") \n#variables para la prueba de promedios\n          #| names(dat) == \"Sepal.Length\"\n          #| names(dat) == \"Petal.Length\"\n          #| names(dat) == \"Petal.Width\")\nmethod1 <- \"anova\" # Una de \"anova\" o \"kruskal.test\"\nmethod2 <- \"t.test\" # Una de \"wilcox.test\" o \"t.test\"\nmy_comparisons <- list(c(\"setosa\", \"versicolor\"), \n                       c(\"setosa\", \"virginica\"), \n                       c(\"versicolor\", \"virginica\")) \n# comparaciones para pruebas de promedio\n# Editar hasta aquí\n\n# Edit at your own risk\nfor (i in y) {\n  for (j in x) {\n    p <- ggboxplot(dat,\n      x = colnames(dat[j]), y = colnames(dat[i]),\n      color = colnames(dat[j]),\n      legend = \"none\",\n      palette = \"npg\",\n      add = \"jitter\"\n    )\n    print(\n      p + stat_compare_means(aes(\n        label = paste0(..method.., \", p-value = \", ..p.format..)),\n        method = method1, label.y = max(dat[, i], na.rm = TRUE)\n      )\n      + stat_compare_means(comparisons = my_comparisons, \n                           method = method2, label = \"p.format\") \n      # remove if p-value of ANOVA or Kruskal-Wallis test >= alpha\n    )\n  }\n}\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nOtra opción de gráfica para observar la significancia entre las medias de cada par de especies.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# pairwise comparisons\n\npwc <- fsdata %>%\n  pairwise_t_test(\n    Sepal.Width ~ Species, pool.sd = FALSE,\n    p.adjust.method = \"none\"\n    )\n\n# Visualization: box plots with p-values\npwc <- pwc %>% add_xy_position(x = \"Species\")\nggboxplot(fsdata, x = \"Species\", y = \"Sepal.Width\",\n          color = \"Species\", \n          legend = \"none\", \n          add = \"jitter\") +\n  stat_pvalue_manual(pwc, hide.ns = TRUE) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n## Conclusión\n\nLa figura de prueba de promedios es muy buena opción para incluir en la sección de resultados de los reportes de investigación. La figura incluye el resultado de p-valor del análisis de varianza, además, p-valor para la comparación de medias entre especies o tratamientos de la investigación.\n\n## Referencias\n\n1.  R bloggers 2020. [ANOVA in R](https://www.r-bloggers.com/2020/10/anova-in-r/)\n2.  Soetewey A. 2020. [How to do a t-test or ANOVA for more than one variable at once in R](https://towardsdatascience.com/how-to-do-a-t-test-or-anova-for-many-variables-at-once-in-r-and-communicate-the-results-in-a-6defaa712e5)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.0/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.5.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}